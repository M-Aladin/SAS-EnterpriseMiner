*------------------------------------------------------------*
User:                Mohamed
Date:                May 09, 2018
Time:                14:55:59
Site:                12400032
Platform:            X64_10HOME
Maintenance Release: 9.04.01M4P110916
EM Version:          14.2
* 
*------------------------------------------------------------*
* Training Log
Date:                May 09, 2018
Time:                14:55:50
*------------------------------------------------------------*
11405  proc freq data=EMWS1.Clus2_VariableSet noprint;
11406  table ROLE*LEVEL/out=WORK.Clus2META;
11407  run;
 
NOTE: There were 26 observations read from the data set EMWS1.CLUS2_VARIABLESET.
NOTE: The data set WORK.CLUS2META has 6 observations and 4 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
11408  proc print data=WORK.Clus2META label noobs;
11409  var ROLE LEVEL COUNT;
11410  label ROLE = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel, NOQUOTE))" LEVEL = "%sysfunc(sasmsg(sashelp.dmine, meta_level_vlabel, NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel, NOQUOTE))";
11411  title9 ' ';
11412  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_varSummary_title  , NOQUOTE))";
11413  run;
 
NOTE: There were 6 observations read from the data set WORK.CLUS2META.
NOTE: The PROCEDURE PRINT printed page 1.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
11414  title10;
 
11415  data WORK.M3PXIS0O;
11416  set WORK.M3PXIS0O;
11417  if role eq 'REJECTED' then role = 'INPUT';
11418  run;
 
NOTE: There were 18 observations read from the data set WORK.M3PXIS0O.
NOTE: The data set WORK.M3PXIS0O has 18 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
11427  *------------------------------------------------------------*;
11428  * Clus2: Training;
11429  *------------------------------------------------------------*;
11430  *------------------------------------------------------------* ;
11431  * Clus2: DMDBClass Macro ;
11432  *------------------------------------------------------------* ;
11433  %macro DMDBClass;
11434      CampaignViewedEmail(ASC) FacebookLike(ASC) LoyaltyClass(ASC)
11435     MobileApplications(ASC) PreviousCampaign(ASC) REP_AdvertisementZone(ASC)
11436     REP_ClusterGroup(ASC) REP_Gender(ASC) REP_Region(ASC)
11437  %mend DMDBClass;
11438  *------------------------------------------------------------* ;
11439  * Clus2: DMDBVar Macro ;
11440  *------------------------------------------------------------* ;
11441  %macro DMDBVar;
11442      AffluenceGrade CleanserProducts DayCareProducts LotionProducts
11443     NightRepairProducts REP_Age REP_LoyaltyTime TimeSinceLastPurchase TotalSpend
11444  %mend DMDBVar;
11445  *------------------------------------------------------------*;
11446  * Clus2: Create DMDB;
11447  *------------------------------------------------------------*;
11448  proc dmdb batch data=EMWS1.Filter_TRAIN
11449  dmdbcat=WORK.Clus2_DMDB
11450  maxlevel = 513
11451  out=WORK.Clus2_DMDB
11452  ;
11453  class %DMDBClass;
11454  var %DMDBVar;
11455  run;
 
NOTE: Records processed = 4224   Memory used = 511K.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: View EMWS1.FILTER_TRAIN.VIEW used (Total process time):
      real time           0.25 seconds
      cpu time            0.22 seconds
 
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: The data set WORK.CLUS2_DMDB has 4224 observations and 18 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.28 seconds
      cpu time            0.25 seconds
 
 
11456  quit;
11457  *--- end code ---*;
 
11458  *------------------------------------------------------------* ;
11459  * Clus2: Interval Inputs Macro ;
11460  *------------------------------------------------------------* ;
11461  %macro DMVQINTERVAL;
11462      AffluenceGrade CleanserProducts DayCareProducts LotionProducts
11463     NightRepairProducts REP_Age REP_LoyaltyTime TimeSinceLastPurchase TotalSpend
11464  %mend DMVQINTERVAL;
11465  *------------------------------------------------------------* ;
11466  * Clus2: Nominal Inputs Macro ;
11467  *------------------------------------------------------------* ;
11468  %macro DMVQNOMINAL;
11469      CampaignViewedEmail FacebookLike LoyaltyClass MobileApplications
11470     PreviousCampaign REP_AdvertisementZone REP_ClusterGroup REP_Gender REP_Region
11471  %mend DMVQNOMINAL;
11472  *------------------------------------------------------------*;
11473  * Clus2: Run DMVQ procedure;
11474  *------------------------------------------------------------*;
11475  title;
11476  options nodate;
11477  proc dmvq data=WORK.Clus2_DMDB dmdbcat=WORK.Clus2_DMDB std=RANGE nominal=GLM ordinal=RANK
11478  ;
NOTE: The training set WORK.CLUS2_DMDB.DATA has 18 variable(s).
NOTE: The DMVQ statement has finished with return code=0 and status=begin.
11479  input %DMVQINTERVAL / level=interval;
NOTE: 9 input variable(s) defined for ID=I1.
NOTE: The INPUT statement has finished with return code=0 and status=variables.
11480  input %DMVQNOMINAL / level=nominal;
NOTE: 9 input variable(s) defined for ID=I2.
NOTE: The INPUT statement has finished with return code=0 and status=variables.
11481  VQ maxc = 3 clusname=_SEGMENT_ CLUSLABEL="Segment Id" DISTLABEL="Distance";
NOTE: A maximum of 3 clusters have been requested.
NOTE: The VQ statement has finished with return code=0 and status=architecture.
11482  MAKE outvar=EMWS1.Clus2_OUTVAR;
WARNING: Variable FacebookLike is omitted from the analysis because it has only one category.
 
NOTE: 18 input variable(s).
NOTE: Number of cases=4224
NOTE: Sum of frequencies=4224
NOTE: Sum of weights=4224
NOTE: VARDEF=DF
NOTE: Maximum number of categories=14
NOTE: The total number of variables is 18 with dimensionality 46.
NOTE: 17 variables will be used for clustering.
NOTE: Open output data set EMWS1.CLUS2_OUTVAR.DATA with 48 variables.
NOTE: The data set EMWS1.CLUS2_OUTVAR has 4 observations and 48 variables.
NOTE: The MAKE statement has finished with return code=0 and status=made.
11483  INITIAL radius=0
11484  initial=OUTLIER
11485  ;
NOTE: 3 seeds were selected from data set WORK.CLUS2_DMDB.DATA using the OUTLIER algorithm.
NOTE: The INITIAL statement has finished with return code=0 and status=initialized.
11486  TRAIN tech=FORGY
11487  ;
NOTE: F-Convergence criterion is satisfied.
NOTE: The TRAIN statement has finished with return code=0 and status=trained.
11488  SAVE outstat=EMWS1.Clus2_OUTSTAT outmean=EMWS1.Clus2_OUTMEAN;
NOTE: The data set EMWS1.CLUS2_OUTSTAT has 34 observations and 49 variables.
NOTE: The data set EMWS1.CLUS2_OUTMEAN has 3 observations and 55 variables.
NOTE: The SAVE statement has finished with return code=0 and status=statistics.
11489  code file="D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS1\Clus2\DMVQSCORECODE.sas"
11490  group=Clus2
11491  ;
NOTE: External file D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS1\Clus2\DMVQSCORECODE.sas opened.
NOTE: The CODE statement has finished with return code=0 and status=statistics.
11492  run;
 
11493  quit;
 
NOTE: There were 4224 observations read from the data set WORK.CLUS2_DMDB.
NOTE: PROCEDURE DMVQ used (Total process time):
      real time           0.14 seconds
      cpu time            0.12 seconds
 
 
11494  libname _spdslib;
WARNING: Libref _SPDSLIB is not assigned.
 
11495  *------------------------------------------------------------*;
11496  * Clus2: Cluster Label;
11497  *------------------------------------------------------------*;
11498  data EMWS1.Clus2_LABEL;
11499  length _SEGMENT_ 8 Label $80;
11500  format _SEGMENT_ 4.;
11501  label _SEGMENT_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentName_vlabel,  NOQUOTE))";
11502  label Label = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentLabel_vlabel,  NOQUOTE))";
11503  _SEGMENT_= 1;
11504  Label='Cluster1';
11505  output;
11506  _SEGMENT_= 2;
11507  Label='Cluster2';
11508  output;
11509  _SEGMENT_= 3;
11510  Label='Cluster3';
11511  output;
11512  run;
 
NOTE: The data set EMWS1.CLUS2_LABEL has 3 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
*------------------------------------------------------------*
* Score Log
Date:                May 09, 2018
Time:                14:55:51
*------------------------------------------------------------*
11614  proc transpose data=EMWS1.Clus2_OUTVAR out=WORK.Clus2_OUTVAR(rename=(COl2=NAME) where=(COL1='IMPUTED'));
11615  var AffluenceGrade--REP_RegionU;
11616  where _TYPE_ in('TYPE' 'VARIABLE');
11617  run;
 
NOTE: There were 2 observations read from the data set EMWS1.CLUS2_OUTVAR.
      WHERE _TYPE_ in ('TYPE', 'VARIABLE');
NOTE: The data set WORK.CLUS2_OUTVAR has 0 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
11618  proc sort data=WORK.Clus2_OUTVAR;
11619  by NAME;
11620  run;
 
NOTE: Input data set is empty.
NOTE: The data set WORK.CLUS2_OUTVAR has 0 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
11621  proc sort data=EMWS1.Clus2_VariableSet(KEEP=NAME ROLE LEVEL) out=WORK.Clus2_SORTEDVARS;
11622  by NAME;
11623  run;
 
NOTE: There were 26 observations read from the data set EMWS1.CLUS2_VARIABLESET.
NOTE: The data set WORK.CLUS2_SORTEDVARS has 26 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
11624  data WORK.Clus2_OUTVAR;
11625  merge WORK.Clus2_OUTVAR(in=INVAR) WORK.Clus2_SORTEDVARS;
11626  by NAME;
11627  if INVAR then output;
11628  run;
 
WARNING: Multiple lengths were specified for the BY variable NAME by input data sets. This might cause unexpected results.
NOTE: There were 0 observations read from the data set WORK.CLUS2_OUTVAR.
NOTE: There were 26 observations read from the data set WORK.CLUS2_SORTEDVARS.
NOTE: The data set WORK.CLUS2_OUTVAR has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this session.
11629  filename emflow "D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS1\Clus2\EMFLOWSCORE.sas";
11630  *------------------------------------------------------------*;
11631  * Clus2: Scoring DATA data;
11632  *------------------------------------------------------------*;
11633  data EMWS1.Clus2_TRAIN
11634  / view=EMWS1.Clus2_TRAIN
11635  ;
11636  set EMWS1.Filter_TRAIN
11637  ;
11638  %inc emflow;
12400  run;
 
NOTE: DATA STEP view saved on file EMWS1.CLUS2_TRAIN.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS1.FILTER_TRAIN.VIEW used (Total process time):
      real time           0.18 seconds
      cpu time            0.18 seconds
 
NOTE: DATA statement used (Total process time):
      real time           0.20 seconds
      cpu time            0.20 seconds
 
 
12401  quit;
12402  filename emflow;
NOTE: Fileref EMFLOW has been deassigned.
 
12403  *------------------------------------------------------------*;
12404  * Clus2: Computing metadata for TRAIN data;
12405  *------------------------------------------------------------*;
 
NOTE: View EMWS1.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.20 seconds
      cpu time            0.18 seconds
 
NOTE: View EMWS1.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.20 seconds
      cpu time            0.18 seconds
 
*------------------------------------------------------------*
* Report Log
Date:                May 09, 2018
Time:                14:55:53
*------------------------------------------------------------*
12815  data WORK.M01CKJ2_;
12816  set WORK.M01CKJ2_;
12817  if role eq 'REJECTED' then role = 'INPUT';
12818  run;
 
NOTE: There were 18 observations read from the data set WORK.M01CKJ2_.
NOTE: The data set WORK.M01CKJ2_ has 18 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12819  data WORK.M01CKJ2_;
12820  set WORK.M01CKJ2_ end=_eof_ nobs=_nobs_;
12821  output;
12822  if _eof_ then do;
12823  name = '_SEGMENT_';
12824  ROLE = 'TARGET';
12825  LEVEL = 'NOMINAL';
12826  LABEL = 'Segment Variable';
12827  TYPE = 'N';
12828  FORMAT = '';
12829  INFORMAT = '';
12830  USE='Y';
12831  output;
12832  end;
12833  run;
 
NOTE: There were 18 observations read from the data set WORK.M01CKJ2_.
NOTE: The data set WORK.M01CKJ2_ has 19 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12834  *------------------------------------------------------------*;
12835  * Clus2: Create decision matrix;
12836  *------------------------------------------------------------*;
12837  *------------------------------------------------------------* ;
12838  * Clus2: Tree Variables Macro ;
12839  *------------------------------------------------------------* ;
12840  %macro EM_TREEVARS;
12841      AffluenceGrade CampaignViewedEmail CleanserProducts DayCareProducts
12842     FacebookLike LotionProducts LoyaltyClass MobileApplications NightRepairProducts
12843     PreviousCampaign REP_AdvertisementZone REP_Age REP_ClusterGroup REP_Gender
12844     REP_LoyaltyTime REP_Region TimeSinceLastPurchase TotalSpend
12845  %mend EM_TREEVARS;
12846  *------------------------------------------------------------* ;
12847  * Clus2: Tree Targets Macro ;
12848  *------------------------------------------------------------* ;
12849  %macro EM_TREETARGETS;
12850      _SEGMENT_
12851  %mend EM_TREETARGETS;
12852  data EMWS1.EM_Clus2 / view=EMWS1.EM_Clus2;
12853  set EMWS1.Clus2_TRAIN(keep=%EM_TREEVARS %EM_TREETARGETS);
12854  run;
 
NOTE: DATA STEP view saved on file EMWS1.EM_CLUS2.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS1.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.21 seconds
      cpu time            0.18 seconds
 
NOTE: DATA statement used (Total process time):
      real time           0.23 seconds
      cpu time            0.20 seconds
 
 
12855  *------------------------------------------------------------* ;
12856  * Clus2: Interval Inputs Macro ;
12857  *------------------------------------------------------------* ;
12858  %macro INTINPUTS;
12859      AffluenceGrade CleanserProducts DayCareProducts LotionProducts
12860     NightRepairProducts REP_Age REP_LoyaltyTime TimeSinceLastPurchase TotalSpend
12861  %mend INTINPUTS;
12862  *------------------------------------------------------------* ;
12863  * Clus2: Binary and Nominal Inputs Macro ;
12864  *------------------------------------------------------------* ;
12865  %macro NOMINPUTS;
12866      CampaignViewedEmail FacebookLike LoyaltyClass MobileApplications
12867     PreviousCampaign REP_AdvertisementZone REP_ClusterGroup REP_Gender REP_Region
12868  %mend NOMINPUTS;
12869  *------------------------------------------------------------* ;
12870  * Clus2: Ordinal Inputs Macro ;
12871  *------------------------------------------------------------* ;
12872  %macro ORDINPUTS;
12873
12874  %mend ORDINPUTS;
12875  *------------------------------------------------------------*;
12876  * Clus2: Run ARBOR procedure;
12877  *------------------------------------------------------------*;
 
12878  proc arbor data=EMWS1.EM_Clus2
12879  MAXSURRS=5
12880  ;
12881  ;
12882  input %INTINPUTS
12883  / level = interval;
12884  input %NOMINPUTS
12885  / level=nominal;
12886  target _SEGMENT_ / level=NOMINAL
12887  Criterion=PROBCHISQ
12888  ;
12889  ;
12890  Performance DISK
12891  ;
12892  MAKEMACRO NLEAVES=nleaves;
NOTE: 1385333 kilobytes of physical memory.
NOTE: Will use 4224 out of 4224 training cases.
NOTE: Using memory pool with 181230592 bytes.
NOTE: Will not search for split on variable FacebookLike.
NOTE: Acceptable cases have the same value.
NOTE: Option MINCATSIZE=5 may apply.
NOTE: Passed training data 18 times.
NOTE: Training used 2009504 bytes of work memory.
NOTE: The subtree sequence contains 44 subtrees. The largest has 87 nodes and 44 leaves.
NOTE: Using subtree with 87 nodes and 44 leaves.
NOTE: Created macro variable NLEAVES equal to 44.
12893  save
12894  MODEL=EMWS1.Clus2_PLOTDS
12895  SEQUENCE=EMWS1.Clus2_OUTSEQ
12896  IMPORTANCE=EMWS1.Clus2_OUTIMPORT
12897  NODESTAT=EMWS1.Clus2_OUTNODES
12898  SUMMARY=WORK.OUTSUMMARY_TREE_0P9CCJN
12899  STATSBYNODE=WORK.OUTSTATS_TREE_0P9CCJN
12900  Pathlistnonmissing = WORK.OUTPATH_TREE_0P9CCJN
12901  Rules = WORK.OUTRULES_TREE_0P9CCJN
12902  ;
NOTE: The data set EMWS1.CLUS2_OUTIMPORT has 18 observations and 5 variables.
NOTE: The data set EMWS1.CLUS2_PLOTDS has 4297 observations and 4 variables.
NOTE: The data set EMWS1.CLUS2_OUTNODES has 87 observations and 22 variables.
NOTE: The data set WORK.OUTPATH_TREE_0P9CCJN has 434 observations and 7 variables.
NOTE: The data set WORK.OUTRULES_TREE_0P9CCJN has 2058 observations and 6 variables.
NOTE: The data set EMWS1.CLUS2_OUTSEQ has 44 observations and 11 variables.
NOTE: The data set WORK.OUTSTATS_TREE_0P9CCJN has 435 observations and 5 variables.
NOTE: The data set WORK.OUTSUMMARY_TREE_0P9CCJN has 16 observations and 6 variables.
12903  run;
 
12904  quit;
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: View EMWS1.EM_CLUS2.VIEW used (Total process time):
      real time           1.31 seconds
      cpu time            1.15 seconds
 
NOTE: There were 4224 observations read from the data set EMWS1.CLUS2_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.EM_CLUS2.
NOTE: The data set WORK._NAMEDAT has 3 observations and 5 variables.
NOTE: PROCEDURE ARBOR used (Total process time):
      real time           1.32 seconds
      cpu time            1.17 seconds
 
 
12905  data EMWS1.Clus2_OUTIMPORT;
12906  set EMWS1.Clus2_OUTIMPORT;
12907  label NAME = "%sysfunc(sasmsg(sashelp.dmine, meta_name_vlabel, noquote))" LABEL = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel, noquote))" NRULES = "%sysfunc(sasmsg(sashelp.dmine, rpt_nrules_vlabel, noquote))" IMPORTANCE =
12908     "%sysfunc(sasmsg(sashelp.dmine, rpt_importance_vlabel, noquote))" NSURROGATES = "%sysfunc(sasmsg(sashelp.dmine, rpt_nsurrogates_vlabel, noquote))"
12909  ;
12910  run;
 
NOTE: There were 18 observations read from the data set EMWS1.CLUS2_OUTIMPORT.
NOTE: The data set EMWS1.CLUS2_OUTIMPORT has 18 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
12911  filename x "D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS1\Clus2\ENGLISHRULES.txt" encoding='utf-8' NOBOM;
 
12912  data temp;
12913  length varname $30;
12914  retain varname;
12915  set WORK.OUTPATH_TREE_0P9CCJN;
12916  if ^missing(variable) then varname=variable;
12917  else if ^missing(var_name) then varname=var_name;
12918  output;
12919  run;
 
NOTE: There were 434 observations read from the data set WORK.OUTPATH_TREE_0P9CCJN.
NOTE: The data set WORK.TEMP has 434 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12920  proc sort data=temp;
12921  by node;
12922  run;
 
NOTE: There were 434 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 434 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12923  proc sort data=EMWS1.Clus2_OUTNODES out=outnodes;
12924  by node;
12925  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_OUTNODES.
NOTE: The data set WORK.OUTNODES has 87 observations and 22 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12926  data temp;
12927  merge temp(in=_a) outnodes(keep= node
12928  NPRIORS
12929  P__SEGMENT_3
12930  P__SEGMENT_2
12931  P__SEGMENT_1
12932  );
12933  by node;
12934  if _a;
12935  run;
 
NOTE: There were 434 observations read from the data set WORK.TEMP.
NOTE: There were 87 observations read from the data set WORK.OUTNODES.
NOTE: The data set WORK.TEMP has 434 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12936  proc sort data=temp;
12937  by node descending varname descending numeric_value;
12938  run;
 
NOTE: There were 434 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 434 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12939  data _null_;
12940  file x;
12941  set temp;
12942  by node descending varname;
12943  retain origvar oldnode string;
12944  length origvar $32 oldnode 8 string $200;
12945  if _n_ = 1 then do;
12946  origvar = varname;
12947  oldnode = node;
12948  end;
12949  if first.node then do;
12950  put "&EM_CODEBAR";
12951  put " Node = " node;
12952  put "&EM_CODEBAR";
12953  end;
12954  if first.varname then do;
12955  if RELATION ^in ("=", "ISMISSING", "ISNOTMISSING") then do;
12956  if MISSING(CHARACTER_VALUE) then do;
12957  if NUMERIC_VALUE ne . then do;
12958  if ^first.node then do;
12959  string= "AND "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12960  end;
12961  else do;
12962  string= "if "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12963  end;
12964  end;
12965  end;
12966  else do;
12967  if ^first.node then do;
12968  string= "AND "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12969  end;
12970  else do;
12971  string= "if "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12972  end;
12973  end;
12974  end;
12975  else if RELATION in ("=") then do;
12976  if ^first.node then do;
12977  string = "AND "||strip(varname) ||" IS ONE OF: "||character_value;
12978  end;
12979  else do;
12980  string = "if "|| strip(varname) ||" IS ONE OF: "||character_value;
12981  end;
12982  end;
12983  else if RELATION in ("ISMISSING") then do;
12984  if ^first.node then do;
12985  string = " AND "|| strip(varname) || " equals Missing";
12986  end;
12987  else do;
12988  string = "if "|| strip(varname) ||" equals Missing";
12989  end;
12990  end;
12991  else if RELATION in ("ISNOTMISSING") then do;
12992  if ^first.node then do;
12993  string = " AND "|| strip(varname) || " equals All Values";
12994  end;
12995  else do;
12996  string = "if "|| strip(varname) ||" equals All Values";
12997  end;
12998  end;
12999  if ^missing(varname) then origvar = varname;
13000  oldnode=node;
13001  end;
13002  else do;
13003  if RELATION ^in ("=", "ISMISSING", "ISNOTMISSING") then do;
13004  if MISSING(CHARACTER_VALUE) then do;
13005  if NUMERIC_VALUE ne . then do;
13006  if ^MISSING(string) then string= strip(string)||" AND "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
13007  else string= " if "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
13008  end;
13009  end;
13010  else do;
13011  if ^MISSING(string) then string= strip(string)||" AND "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
13012  else string= " if "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
13013  end;
13014  end;
13015  else if RELATION in ("=") then do;
13016  string = strip(string)||", "||strip(character_value);
13017  end;
13018  else if RELATION in ("ISMISSING") then do;
13019  end;
13020  if ^missing(varname) then origvar = varname;
13021  oldnode=node;
13022  end;
13023  if last.varname then do;
13024  if RELATION in ("ISMISSING") then do;
13025  if ^first.varname then do;
13026  string = strip(string) || " or MISSING";
13027  end;
13028  end;
13029  put string;
13030  if ^missing(varname) then origvar = varname;
13031  oldnode=node;
13032  end;
13033  if last.node then do;
13034  put "then ";
13035  put " Tree Node Identifier   = " node;
13036  put " Number of Observations = " NPRIORS;
13037  put " Predicted: _SEGMENT_=3  = " P__SEGMENT_3;
13038  put " Predicted: _SEGMENT_=2  = " P__SEGMENT_2;
13039  put " Predicted: _SEGMENT_=1  = " P__SEGMENT_1;
13040  put " ";
13041  if ^missing(varname) then origvar = varname;
13042  oldnode=node;
13043  end;
13044  run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      12959:67    12962:66    13006:108   13007:72
NOTE: The file X is:
      Filename=D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS1\Clus2\ENGLISHRULES.txt,
      RECFM=V,LRECL=131068,File Size (bytes)=0,
      Last Modified=09May2018:14:55:55,
      Create Time=09May2018:14:55:55
 
NOTE: 686 records were written to the file X.
      The minimum record length was 1.
      The maximum record length was 86.
NOTE: There were 434 observations read from the data set WORK.TEMP.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13045  filename x;
NOTE: Fileref X has been deassigned.
 
13046  /* belowtext */
13047  data templabel;
13048  set WORK.OUTRULES_TREE_0P9CCJN;
13049  if ((ROLE="PRIMARY") AND (STAT ="LABEL"));
13050  rename character_value = belowtext;
13051  keep NODE character_value;
13052  run;
 
NOTE: There were 2058 observations read from the data set WORK.OUTRULES_TREE_0P9CCJN.
NOTE: The data set WORK.TEMPLABEL has 10 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13053  data tempvar;
13054  set WORK.OUTRULES_TREE_0P9CCJN;
13055  if ((ROLE="PRIMARY") AND (STAT="VARIABLE"));
13056  keep NODE character_value;
13057  run;
 
NOTE: There were 2058 observations read from the data set WORK.OUTRULES_TREE_0P9CCJN.
NOTE: The data set WORK.TEMPVAR has 43 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13058  proc sort data=templabel;
13059  by node;
13060  run;
 
NOTE: There were 10 observations read from the data set WORK.TEMPLABEL.
NOTE: The data set WORK.TEMPLABEL has 10 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13061  proc sort data=tempvar;
13062  by node;
13063  run;
 
NOTE: There were 43 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 43 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13064  data tempbelow;
13065  merge templabel tempvar;
13066  by node;
13067  if missing(belowtext) then belowtext= character_value;
13068  keep node belowtext;
13069  run;
 
NOTE: There were 10 observations read from the data set WORK.TEMPLABEL.
NOTE: There were 43 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPBELOW has 43 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13070  proc sort data=tempbelow;
13071  by node;
13072  run;
 
NOTE: There were 43 observations read from the data set WORK.TEMPBELOW.
NOTE: The data set WORK.TEMPBELOW has 43 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13073  /* abovetext */
13074  data tempoutrules;
13075  set WORK.OUTRULES_TREE_0P9CCJN;
13076  if ((ROLE='PRIMARY') AND(STAT in ("INTERVAL", "ORDINAL", "NOMINAL")));
13077  run;
 
NOTE: There were 2058 observations read from the data set WORK.OUTRULES_TREE_0P9CCJN.
NOTE: The data set WORK.TEMPOUTRULES has 103 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13078  proc sort data=tempoutrules;
13079  by node numeric_value;
13080  run;
 
NOTE: There were 103 observations read from the data set WORK.TEMPOUTRULES.
NOTE: The data set WORK.TEMPOUTRULES has 103 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13081  data tempabove;
13082  set tempoutrules(rename=(node=parent));
13083  by parent numeric_value;
13084  retain abovetext tempstring flag branch origval origchar;
13085  *length abovetext tempstring origchar $45;
13086  length abovetext $256;
13087  length tempstring origchar $64;
13088  if STAT in ("INTERVAL", "ORDINAL") then do;
13089  if first.parent then do;
13090  if missing(character_value) then do;
13091  numeric_value = round(numeric_value, 0.0001);
13092  abovetext = "< "||strip(NUMERIC_VALUE);
13093  branch = 1;
13094  origval = numeric_value;
13095  output;
13096  end;
13097  else do;
13098  abovetext = "< "||strip(CHARACTER_VALUE);
13099  branch = 1;
13100  origchar = character_value;
13101  output;
13102  end;
13103  if first.parent AND last.parent then do;
13104  if missing(character_value) then do;
13105  numeric_value = round(numeric_value, 0.0001);
13106  branch = branch + 1;
13107  abovetext = ">= "||strip(NUMERIC_VALUE);
13108  output;
13109  end;
13110  else do;
13111  branch = branch + 1;
13112  abovetext = ">= "||strip(CHARACTER_VALUE);
13113  output;
13114  end;
13115  end;
13116  end;
13117  else if last.parent then do;
13118  if ( missing(character_value) AND (origval ne numeric_value)) or ( ^missing(character_value) AND (origchar ne character_value)) then do;
13119  if missing(character_value) then do;
13120  numeric_value = round(numeric_value, 0.0001);
13121  abovetext= "[ "||strip(origval)||", "|| strip(numeric_value)||" )";
13122  end;
13123  else do;
13124  abovetext= ">= "||strip(origchar)||" AND < "|| strip(character_value);
13125  end;
13126  branch = branch + 1;
13127  output;
13128  if missing(character_value) then do;
13129  numeric_value = round(numeric_value, 0.0001);
13130  abovetext = ">= "||strip(NUMERIC_VALUE);
13131  end;
13132  else do;
13133  abovetext = ">= "||strip(CHARACTER_VALUE);
13134  end;
13135  branch = branch + 1;
13136  output;
13137  end;
13138  else do;
13139  if missing(character_value) then do;
13140  numeric_value = round(numeric_value, 0.0001);
13141  abovetext = ">= "||strip(NUMERIC_VALUE);
13142  end;
13143  else do;
13144  abovetext = ">= "||strip(CHARACTER_VALUE);
13145  end;
13146  branch = branch + 1;
13147  output;
13148  end;
13149  end;
13150  else do;
13151  if ( missing(character_value) AND (origval ne numeric_value)) or ( ^missing(character_value) AND (origchar ne character_value)) then do;
13152  if missing(character_value) then do;
13153  numeric_value = round(numeric_value,0.0001);
13154  abovetext= "[ "||strip(origval)||", "|| strip(numeric_value)||" )";
13155  origval = numeric_value;
13156  end;
13157  else do;
13158  abovetext= ">= "||strip(origchar)||" AND < "|| strip(character_value);
13159  origchar = character_value;
13160  end;
13161  branch = branch + 1;
13162  output;
13163  end;
13164  else do;
13165  if missing(character_value) then do;
13166  numeric_value = round(numeric_value, 0.0001);
13167  abovetext = ">= "||strip(NUMERIC_VALUE);
13168  origval = numeric_value;
13169  end;
13170  else do;
13171  abovetext = ">= "||strip(CHARACTER_VALUE);
13172  origval = character_value;
13173  end;
13174  branch = branch + 1;
13175  output;
13176  end;
13177  end;
13178  end;
13179  else do;
13180  if first.numeric_value then do;
13181  flag = 0;
13182  abovetext = CHARACTER_VALUE;
13183  branch = numeric_value;
13184  if first.numeric_value AND last.numeric_value then do;
13185  output;
13186  end;
13187  end;
13188  else if last.numeric_value then do;
13189  if flag=0 then do;
13190  tempstring = strip(abovetext)||", "||CHARACTER_VALUE;
13191  length = length(strip(tempstring));
13192  if length < 32 then do;
13193  abovetext = strip(tempstring);
13194  end;
13195  else do;
13196  abovetext = strip(abovetext)||", ...";
13197  flag = 1;
13198  end;
13199  end;
13200  branch = numeric_value;
13201  output;
13202  end;
13203  else do;
13204  if flag=0 then do;
13205  tempstring = strip(abovetext)||", "||CHARACTER_VALUE;
13206  length = length(strip(tempstring));
13207  if length < 32 then do;
13208  abovetext = strip(tempstring);
13209  end;
13210  else do;
13211  abovetext = strip(abovetext)||", ...";
13212  flag=1;
13213  end;
13214  end;
13215  branch = numeric_value;
13216  end;
13217  end;
13218  keep parent branch abovetext;
13219  run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      13092:25   13107:26   13121:24   13121:47   13130:26   13141:26   13154:24   13154:47   13167:26
NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      13172:11
NOTE: There were 103 observations read from the data set WORK.TEMPOUTRULES.
NOTE: The data set WORK.TEMPABOVE has 86 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13220  /* MIssing value to abovetext */
13221  data tempmissing;
13222  set WORK.OUTRULES_TREE_0P9CCJN;
13223  if ((ROLE="PRIMARY") AND (STAT in ("MISSING")));
13224  rename node=parent numeric_value=branch character_value=misschar;
13225  run;
 
NOTE: There were 2058 observations read from the data set WORK.OUTRULES_TREE_0P9CCJN.
NOTE: The data set WORK.TEMPMISSING has 43 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13226  proc sort data=work.tempabove;
13227  by parent branch;
13228  run;
 
NOTE: There were 86 observations read from the data set WORK.TEMPABOVE.
NOTE: The data set WORK.TEMPABOVE has 86 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13229  proc sort data=EMWS1.Clus2_OUTNODES out=tempoutnodes;
13230  by parent branch;
13231  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_OUTNODES.
NOTE: The data set WORK.TEMPOUTNODES has 87 observations and 22 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13232  proc sort data=tempmissing;
13233  by parent branch;
13234  run;
 
NOTE: There were 43 observations read from the data set WORK.TEMPMISSING.
NOTE: The data set WORK.TEMPMISSING has 43 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
13235  data WORK.Clus2_outnodes;
13236  merge work.tempabove tempoutNodes(drop=abovetext ) tempmissing(in=_a);
13237  by parent branch;
13238  length traintotal validtotal 8;
13239  retain traintotal validtotal;
13240  if _a then do;
13241  if ^MISSING(abovetext) then do;
13242  abovetext= strip(abovetext)||" %sysfunc(sasmsg(sashelp.dmine, tree_ormiss_vlabel, noquote))";
13243  end;
13244  else do;
13245  abovetext = " %sysfunc(sasmsg(sashelp.dmine, tree_missonly_vlabel, noquote))";
13246  end;
13247  end;
13248  if MISSING(abovetext) then abovetext="%sysfunc(sasmsg(sashelp.dmine, tree_nonmiss_vlabel, noquote))";
13249  if node=1 then do;
13250  traintotal = N;
13251  validtotal=VN;
13252  end;
13253  label traintotal = "%sysfunc(sasmsg(sashelp.dmine,  rpt_traintotal_vlabel, noquote))";
13254  drop role rank stat misschar belowtext;
13255  run;
 
NOTE: Variable VN is uninitialized.
NOTE: There were 86 observations read from the data set WORK.TEMPABOVE.
NOTE: There were 87 observations read from the data set WORK.TEMPOUTNODES.
NOTE: There were 43 observations read from the data set WORK.TEMPMISSING.
NOTE: The data set WORK.CLUS2_OUTNODES has 87 observations and 24 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13256  proc sort data=WORK.Clus2_outnodes;
13257  by node;
13258  run;
 
NOTE: There were 87 observations read from the data set WORK.CLUS2_OUTNODES.
NOTE: The data set WORK.CLUS2_OUTNODES has 87 observations and 24 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13259  proc sort data=tempbelow;
13260  by node;
13261  run;
 
NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13262  data WORK.Clus2_outnodes;
13263  merge WORK.Clus2_outnodes tempbelow;
13264  by node;
13265  run;
 
NOTE: There were 87 observations read from the data set WORK.CLUS2_OUTNODES.
NOTE: There were 43 observations read from the data set WORK.TEMPBELOW.
NOTE: The data set WORK.CLUS2_OUTNODES has 87 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: View EMWS1.EM_CLUS2.VIEW used (Total process time):
      real time           0.50 seconds
      cpu time            0.50 seconds
 
NOTE: There were 4224 observations read from the data set EMWS1.CLUS2_TRAIN.
13266  data tempoutstats;
13267  set WORK.OUTSTATS_TREE_0P9CCJN;
13268  length tarlevel $8;
13269  tarlevel ="NOMINAL";
13270  run;
 
NOTE: There were 435 observations read from the data set WORK.OUTSTATS_TREE_0P9CCJN.
NOTE: The data set WORK.TEMPOUTSTATS has 435 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13271  data EMWS1.Clus2_TREE_PLOT;
13272  length NODETEXT TEXTALL $800 N NODECOLOR 8;
13273  set WORK.Clus2_outnodes;
13274  label parent = "%sysfunc(sasmsg(sashelp.dmine, rpt_parentID_vlabel, noquote))" depth = "%sysfunc(sasmsg(sashelp.dmine, rpt_depth_vlabel, noquote))" belowtext= "%sysfunc(sasmsg(sashelp.dmine, rpt_belowtext_vlabel, noquote))" abovetext =
13275     "%sysfunc(sasmsg(sashelp.dmine, rpt_abovetext_vlabel, noquote))" linkwidth = "%sysfunc(sasmsg(sashelp.dmine, rpt_linkwidth_vlabel, noquote))" nodetext = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodetext_vlabel, noquote))" textall =
13276     "%sysfunc(sasmsg(sashelp.dmine, rpt_textall_vlabel, noquote))" N = "%sysfunc(sasmsg(sashelp.dmine, rpt_trainn_vlabel, noquote))" nodecolor = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodecolor_vlabel, noquote))" node =
13277     "%sysfunc(sasmsg(sashelp.dmine, rpt_node_vlabel, noquote))";
13278  keep NODE PARENT DEPTH BELOWTEXT ABOVETEXT LINKWIDTH NODETEXT TEXTALL N NODECOLOR;
13279  run;
 
NOTE: Variable TEXTALL is uninitialized.
NOTE: Variable NODECOLOR is uninitialized.
NOTE: There were 87 observations read from the data set WORK.CLUS2_OUTNODES.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
13280  proc sort data=EMWS1.Clus2_TREE_PLOT;
13281  by node;
13282  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_TREE_PLOT.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13283  proc sort data=tempoutstats;
13284  by node;
13285  run;
 
NOTE: There were 435 observations read from the data set WORK.TEMPOUTSTATS.
NOTE: The data set WORK.TEMPOUTSTATS has 435 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13286  data EMWS1.Clus2_TREE_PLOT;
13287  merge EMWS1.Clus2_TREE_PLOT tempoutstats;
13288  length text $800 _RASE_ P__SEGMENT_3 8;
13289  retain P__SEGMENT_3 eventlevel;
13290  by node;
13291  if statname='N' then N=statvalue;
13292  if statname='NPRIORS' then N=statvalue;
13293  if statname='PREDICTION' then eventlevel=category;
13294  _RASE_ = .;
13295  if tarlevel ^= 'INTERVAL' then do;
13296  if STATNAME = 'PROBABILITY' then do;
13297  if CATEGORY=EVENTLEVEL then do;
13298  nodetext = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
13299  text = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
13300  P__SEGMENT_3 = round(STATVALUE, .01);
13301  end;
13302  else do;
13303  text = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
13304  end;
13305  textall = strip(textall)||'0A'x||strip( text);
13306  end;
13307  if last.node then do;
13308  nodetext = trim(nodetext)||'0A'x||" %sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
13309  textall = trim(textall)||'0A'x||" %sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
13310  output EMWS1.Clus2_TREE_PLOT;
13311  end;
13312  end;
13313  else do;
13314  if statname='RASE' then _RASE_=statvalue;
13315  label _RASE_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_trase_vlabel, noquote))";
13316  if STATNAME = 'PREDICTION' then do;
13317  nodetext= "%sysfunc(sasmsg(sashelp.dmine, rpt_average_vlabel, noquote))"|| put(STATVALUE, 13.4)||'0A'x|| "%sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
13318  textall = nodetext;
13319  P__SEGMENT_3 = STATVALUE;
13320  ;
13321  ;
13322  end;
13323  if last.node then do;
13324  output EMWS1.Clus2_TREE_PLOT;
13325  end;
13326  ;
13327  end;
13328  label P__SEGMENT_3 = "%sysfunc(sasmsg(sashelp.dmine, rpt_predictedvar_vlabel, noquote))";
13329  keep NODE PARENT DEPTH BELOWTEXT ABOVETEXT LINKWIDTH NODETEXT TEXTALL N NODECOLOR _RASE_ P__SEGMENT_3;
13330  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_TREE_PLOT.
NOTE: There were 435 observations read from the data set WORK.TEMPOUTSTATS.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
 
 
13331  data tempcolor;
13332  set WORK.OUTSTATS_TREE_0P9CCJN;
13333  retain eventlevel;
13334  if STATNAME='PREDICTION' then eventlevel=CATEGORY;
13335  run;
 
NOTE: There were 435 observations read from the data set WORK.OUTSTATS_TREE_0P9CCJN.
NOTE: The data set WORK.TEMPCOLOR has 435 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13336  data tempcolor;
13337  set tempcolor;
13338  if 'NOMINAL' ne 'INTERVAL' then do;
13339  if CATEGORY=EVENTLEVEL AND STATNAME="PROBABILITY";
13340  end;
13341  else do;
13342  if STATNAME="PREDICTION";
13343  end;
13344  run;
 
NOTE: There were 435 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 87 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13345  data tempcolor;
13346  set tempcolor;
13347  length nodecolor 8;
13348  if 'NOMINAL' ne 'INTERVAL' then do;
13349  nodecolor = round(100*(STATVALUE), .01);
13350  end;
13351  else do;
13352  nodecolor=round(statvalue, .01);
13353  end;
13354  keep node nodecolor;
13355  run;
 
NOTE: There were 87 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 87 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13356  proc sort data=EMWS1.Clus2_TREE_PLOT;
13357  by node;
13358  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_TREE_PLOT.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13359  proc sort data=tempcolor;
13360  by node;
13361  run;
 
NOTE: There were 87 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 87 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13362  data EMWS1.Clus2_TREE_PLOT;
13363  merge EMWS1.Clus2_TREE_PLOT tempcolor;
13364  by node;
13365  length traintotal 8;
13366  retain traintotal;
13367  label traintotal = "%sysfunc(sasmsg(sashelp.dmine,  rpt_traintotal_vlabel, noquote))";
13368  if node=1 then do;
13369  traintotal = N;
13370  end;
13371  if NODE eq . then delete;
13372  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_TREE_PLOT.
NOTE: There were 87 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13373  data EMWS1.Clus2_TREE_PLOT;
13374  set EMWS1.Clus2_TREE_PLOT;
13375  textall = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodeId_vlabel, noquote, )):"|| put(Node, 13.)||'0A'x||trim(textall);
13376  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_TREE_PLOT.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13377  data tempout;
13378  set WORK.Clus2_outnodes;
13379  run;
 
NOTE: There were 87 observations read from the data set WORK.CLUS2_OUTNODES.
NOTE: The data set WORK.TEMPOUT has 87 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13380  proc sort data=tempout;
13381  by descending P__SEGMENT_3;
13382  run;
 
NOTE: There were 87 observations read from the data set WORK.TEMPOUT.
NOTE: The data set WORK.TEMPOUT has 87 observations and 25 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13383  data tree_temp;
13384  set tempout;
13385  if LEAF ne .;
13386  label index="%sysfunc(sasmsg(sashelp.dmine, rpt_leafindex_vlabel  , NOQUOTE))";
13387  label percevent_train = "%sysfunc(sasmsg(sashelp.dmine, rpt_perc_train_vlabel  , NOQUOTE))";
13388  label perc_train = "%sysfunc(sasmsg(sashelp.dmine, rpt_percevent_train_vlabel  , NOQUOTE))";
13389  label tprob="%sysfunc(sasmsg(sashelp.dmine, rpt_prob_vlabel  , NOQUOTE, %nrbquote()))";
13390  tprob = round(P__SEGMENT_3, .01);
13391  percevent_train = round ( tprob*100, .01);
13392  *perc_train =round( ( N / traintotal)*100, .001);
13393  perc_train =round( ( N / traintotal), .01);
13394  if missing(perc_train) then perc_train = round( linkwidth*100, .001);
13395  index = _n_;
13396  keep NODE index tprob perc_train percevent_train
13397  ;
13398  run;
 
NOTE: There were 87 observations read from the data set WORK.TEMPOUT.
NOTE: The data set WORK.TREE_TEMP has 44 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13399  proc sort data=tree_temp;
13400  by NODE;
13401  run;
 
NOTE: There were 44 observations read from the data set WORK.TREE_TEMP.
NOTE: The data set WORK.TREE_TEMP has 44 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13402  proc sort data=EMWS1.Clus2_TREE_PLOT;
13403  by NODE;
13404  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_TREE_PLOT.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 13 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13405  data EMWS1.Clus2_TREE_PLOT;
13406  merge EMWS1.Clus2_TREE_PLOT tree_temp;
13407  by NODE;
13408  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_TREE_PLOT.
NOTE: There were 44 observations read from the data set WORK.TREE_TEMP.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 17 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13409  proc sort data=EMWS1.Clus2_TREE_PLOT;
13410  by node index;
13411  run;
 
NOTE: There were 87 observations read from the data set EMWS1.CLUS2_TREE_PLOT.
NOTE: The data set EMWS1.CLUS2_TREE_PLOT has 87 observations and 17 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13412  title9 ' ';
13413  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_VariableImportance_title, NOQUOTE))";
13414  proc print data=EMWS1.Clus2_OUTIMPORT(where=(IMPORTANCE>0)) noobs label;
13415  run;
 
NOTE: There were 17 observations read from the data set EMWS1.CLUS2_OUTIMPORT.
      WHERE IMPORTANCE>0;
NOTE: The PROCEDURE PRINT printed page 2.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13416  title10;
 
13417  data WORK.M2ZI8TNS;
13418  set WORK.M2ZI8TNS;
13419  if role eq 'REJECTED' then role = 'INPUT';
13420  run;
 
NOTE: There were 26 observations read from the data set WORK.M2ZI8TNS.
NOTE: The data set WORK.M2ZI8TNS has 26 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13421  proc sort data=EMWS1.Clus2_OUTIMPORT out=WORK.Clus2_GRAPHVARS(keep=NAME);
13422  where IMPORTANCE>0;
13423  by NAME;
13424  run;
 
NOTE: There were 17 observations read from the data set EMWS1.CLUS2_OUTIMPORT.
      WHERE IMPORTANCE>0;
NOTE: The data set WORK.CLUS2_GRAPHVARS has 17 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13425  proc sort data = WORK.M2ZI8TNS;
13426  by NAME;
13427  run;
 
NOTE: There were 26 observations read from the data set WORK.M2ZI8TNS.
NOTE: The data set WORK.M2ZI8TNS has 26 observations and 21 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
13428  data WORK.M2ZI8TNS;
13429  merge WORK.M2ZI8TNS WORK.Clus2_GRAPHVARS(in=_b_);
13430  by NAME;
13431  if _b_ or ROLE = "FREQ" or REPORT="Y" then output;
13432  run;
 
NOTE: There were 26 observations read from the data set WORK.M2ZI8TNS.
NOTE: There were 17 observations read from the data set WORK.CLUS2_GRAPHVARS.
NOTE: The data set WORK.M2ZI8TNS has 17 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13433  data WORK.M2ZI8TNS;
13434  set WORK.M2ZI8TNS end=_eof_ nobs=_nobs_;
13435  output;
13436  if _eof_ then do;
13437  name = '_SEGMENT_';
13438  ROLE = 'BY';
13439  LEVEL = 'NOMINAL';
13440  LABEL = 'Segment Variable';
13441  TYPE = 'N';
13442  FORMAT = '';
13443  INFORMAT = '';
13444  output;
13445  end;
13446  run;
 
NOTE: There were 17 observations read from the data set WORK.M2ZI8TNS.
NOTE: The data set WORK.M2ZI8TNS has 18 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13447  *------------------------------------------------------------* ;
13448  * Clus2: STDIZE Variables Macro ;
13449  *------------------------------------------------------------* ;
13450  %macro stdizevar;
13451      AffluenceGrade CleanserProducts DayCareProducts LotionProducts
13452     NightRepairProducts REP_Age REP_LoyaltyTime TimeSinceLastPurchase TotalSpend
13453  %mend stdizevar;
13454  *------------------------------------------------------------*;
13455  * Clus2: Computing Summary Statistics;
13456  *------------------------------------------------------------*;
13457  proc stdize
13458  data = EMWS1.Clus2_TRAIN
13459  out=_null_
13460  outstat=WORK.Clus2_STAT
13461  add=0 fuzz=1E-14 initial=MAD
13462  vardef=df
13463  method=STD
13464  mult=1
13465  pctlmtd=ORD_STAT pctldef=2
13466  pctlpts=(
13467  0
13468  100
13469  )
13470  ;
13471  var %stdizevar;
13472  run;
 
NOTE: INITIAL= will be ignored.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: View EMWS1.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.43 seconds
      cpu time            0.43 seconds
 
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.CLUS2_TRAIN.
NOTE: The data set WORK.CLUS2_STAT has 10 observations and 10 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.45 seconds
      cpu time            0.45 seconds
 
 
13473  quit;
 
13474  data WORK.Clus2_MINMAX;
13475  set WORK.Clus2_STAT;
13476  where _TYPE_ in('P0','P100');
13477  if _TYPE_='P0' then _TYPE_='MIN';
13478  else if _TYPE_='P100' then _TYPE_='MAX';
13479  run;
 
NOTE: There were 2 observations read from the data set WORK.CLUS2_STAT.
      WHERE _TYPE_ in ('P0', 'P100');
NOTE: The data set WORK.CLUS2_MINMAX has 2 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13480  proc transpose data=WORK.Clus2_MINMAX out=WORK.Clus2_MINMAX(drop=_LABEL_ rename=(_NAME_=_VARIABLE_));
13481  id _TYPE_;
13482  run;
 
NOTE: There were 2 observations read from the data set WORK.CLUS2_MINMAX.
NOTE: The data set WORK.CLUS2_MINMAX has 9 observations and 3 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13483  data WORK.Clus2_UGRID;
13484  set WORK.Clus2_MINMAX;
13485  B1 = MIN + (1-1)*(MAX-MIN)/8;
13486  B2 = MIN + (2-1)*(MAX-MIN)/8;
13487  B3 = MIN + (3-1)*(MAX-MIN)/8;
13488  B4 = MIN + (4-1)*(MAX-MIN)/8;
13489  B5 = MIN + (5-1)*(MAX-MIN)/8;
13490  B6 = MIN + (6-1)*(MAX-MIN)/8;
13491  B7 = MIN + (7-1)*(MAX-MIN)/8;
13492  B8 = MIN + (8-1)*(MAX-MIN)/8;
13493  B9 = MIN + (9-1)*(MAX-MIN)/8;
13494  drop MIN MAX;
13495  run;
 
NOTE: There were 9 observations read from the data set WORK.CLUS2_MINMAX.
NOTE: The data set WORK.CLUS2_UGRID has 9 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
13496  *------------------------------------------------------------*;
13497  * Clus2: Creating formats for binning interval variables;
13498  *------------------------------------------------------------*;
13499  proc format;
13500  value F1_
13501  1-4.5 = "1:4.5"
13502  4.5-8 = "4.5:8"
13503  8-11.5 = "8:11.5"
13504  11.5-15 = "11.5:15"
13505  15-18.5 = "15:18.5"
13506  18.5-22 = "18.5:22"
13507  22-25.5 = "22:25.5"
13508  25.5-29 = "25.5:29"
13509  ;
NOTE: Format F1_ has been output.
13510  value F2_
13511  0-0.5 = "0:0.5"
13512  0.5-1 = "0.5:1"
13513  1-1.5 = "1:1.5"
13514  1.5-2 = "1.5:2"
13515  2-2.5 = "2:2.5"
13516  2.5-3 = "2.5:3"
13517  3-3.5 = "3:3.5"
13518  3.5-4 = "3.5:4"
13519  ;
NOTE: Format F2_ has been output.
13520  value F3_
13521  0-0.375 = "0:0.375"
13522  0.375-0.75 = "0.375:0.75"
13523  0.75-1.125 = "0.75:1.125"
13524  1.125-1.5 = "1.125:1.5"
13525  1.5-1.875 = "1.5:1.875"
13526  1.875-2.25 = "1.875:2.25"
13527  2.25-2.625 = "2.25:2.625"
13528  2.625-3 = "2.625:3"
13529  ;
NOTE: Format F3_ has been output.
13530  value F4_
13531  0-0.625 = "0:0.625"
13532  0.625-1.25 = "0.625:1.25"
13533  1.25-1.875 = "1.25:1.875"
13534  1.875-2.5 = "1.875:2.5"
13535  2.5-3.125 = "2.5:3.125"
13536  3.125-3.75 = "3.125:3.75"
13537  3.75-4.375 = "3.75:4.375"
13538  4.375-5 = "4.375:5"
13539  ;
NOTE: Format F4_ has been output.
13540  value F5_
13541  0-0.25 = "0:0.25"
13542  0.25-0.5 = "0.25:0.5"
13543  0.5-0.75 = "0.5:0.75"
13544  0.75-1 = "0.75:1"
13545  1-1.25 = "1:1.25"
13546  1.25-1.5 = "1.25:1.5"
13547  1.5-1.75 = "1.5:1.75"
13548  1.75-2 = "1.75:2"
13549  ;
NOTE: Format F5_ has been output.
13550  value F6_
13551  18-25.625 = "18:25.625"
13552  25.625-33.25 = "25.625:33.25"
13553  33.25-40.875 = "33.25:40.875"
13554  40.875-48.5 = "40.875:48.5"
13555  48.5-56.125 = "48.5:56.125"
13556  56.125-63.75 = "56.125:63.75"
13557  63.75-71.375 = "63.75:71.375"
13558  71.375-79 = "71.375:79"
13559  ;
NOTE: Format F6_ has been output.
13560  value F7_
13561  0-4.5 = "0:4.5"
13562  4.5-9 = "4.5:9"
13563  9-13.5 = "9:13.5"
13564  13.5-18 = "13.5:18"
13565  18-22.5 = "18:22.5"
13566  22.5-27 = "22.5:27"
13567  27-31.5 = "27:31.5"
13568  31.5-36 = "31.5:36"
13569  ;
NOTE: Format F7_ has been output.
13570  value F8_
13571  1-5.125 = "1:5.125"
13572  5.125-9.25 = "5.125:9.25"
13573  9.25-13.375 = "9.25:13.375"
13574  13.375-17.5 = "13.375:17.5"
13575  17.5-21.625 = "17.5:21.625"
13576  21.625-25.75 = "21.625:25.75"
13577  25.75-29.875 = "25.75:29.875"
13578  29.875-34 = "29.875:34"
13579  ;
NOTE: Format F8_ has been output.
13580  value F9_
13581  10-2508.75 = "10:2508.8"
13582  2508.75-5007.5 = "2508.8:5007.5"
13583  5007.5-7506.25 = "5007.5:7506.3"
13584  7506.25-10005 = "7506.3:10005"
13585  10005-12503.75 = "10005:12504"
13586  12503.75-15002.5 = "12504:15003"
13587  15002.5-17501.25 = "15003:17501"
13588  17501.25-20000 = "17501:20000"
13589  ;
NOTE: Format F9_ has been output.
13590  run;
 
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13591  ods listing close;
13592  ods output crosstabfreqs=WORK.TEMPFREQ;
13593  proc freq data = EMWS1.Clus2_TRAIN order=formatted addnames;
13594  table AffluenceGrade * _SEGMENT_ / missing;
13595  table CampaignViewedEmail * _SEGMENT_ / missing;
13596  table CleanserProducts * _SEGMENT_ / missing;
13597  table DayCareProducts * _SEGMENT_ / missing;
13598  table LotionProducts * _SEGMENT_ / missing;
13599  table LoyaltyClass * _SEGMENT_ / missing;
13600  table MobileApplications * _SEGMENT_ / missing;
13601  table NightRepairProducts * _SEGMENT_ / missing;
13602  table PreviousCampaign * _SEGMENT_ / missing;
13603  table REP_AdvertisementZone * _SEGMENT_ / missing;
13604  table REP_Age * _SEGMENT_ / missing;
13605  table REP_ClusterGroup * _SEGMENT_ / missing;
13606  table REP_Gender * _SEGMENT_ / missing;
13607  table REP_LoyaltyTime * _SEGMENT_ / missing;
13608  table REP_Region * _SEGMENT_ / missing;
13609  table TimeSinceLastPurchase * _SEGMENT_ / missing;
13610  table TotalSpend * _SEGMENT_ / missing;
13611  format AFFLUENCEGRADE F1_.;
13612  format CLEANSERPRODUCTS F2_.;
13613  format DAYCAREPRODUCTS F3_.;
13614  format LOTIONPRODUCTS F4_.;
13615  format NIGHTREPAIRPRODUCTS F5_.;
13616  format REP_AGE F6_.;
13617  format REP_LOYALTYTIME F7_.;
13618  format TIMESINCELASTPURCHASE F8_.;
13619  format TOTALSPEND F9_.;
13620  run;
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: View EMWS1.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.56 seconds
      cpu time            0.53 seconds
 
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: The data set WORK.TEMPFREQ has 448 observations and 28 variables.
NOTE: There were 4224 observations read from the data set EMWS1.CLUS2_TRAIN.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.64 seconds
      cpu time            0.60 seconds
 
 
13621  quit;
13622  ods listing;
13623  data EMWS1.Clus2_PROFILE(keep=_VARIABLE_ _SEGMENT_ TYPE COUNT PERCENT _X_ _XLABEL_);
13624  label _VARIABLE_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel, NOQUOTE))" _SEGMENT_ = "Segment Variable" Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_type_vlabel,         NOQUOTE))" _X_ =
13625     "%sysfunc(sasmsg(sashelp.dmine, rpt_numValue_vlabel, NOQUOTE))" _XLABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_fmtValue_vlabel ,    NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel,        NOQUOTE))" PERCENT =
13626     "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel,      NOQUOTE))";
13627  dsid = open("WORK.TEMPFREQ");
13628  varnum = varnum(dsid, 'ROWVARIABLE');
13629  freqnum = varnum(dsid, 'FREQUENCY');
13630  pvarnum = varnum(dsid, 'PERCENT');
13631  typenum = varnum(dsid, '_TYPE_');
13632  bynum = varnum(dsid, "_SEGMENT_");
13633  length varformat _VARIABLE_ $32 _XLABEL_ $32 TYPE $1;
13634  do while(^fetch(dsid));
13635  count = getvarn(dsid, freqnum);
13636  percent = getvarn(dsid, pvarnum);
13637  _VARIABLE_ = strip(getvarc(dsid, varnum));
13638  varblnum = varnum(dsid, _VARIABLE_);
13639  _SEGMENT_ = getvarn(dsid, bynum);
13640  type = vartype(dsid, varblnum);
13641  varformat = varfmt(dsid, varblnum);
13642  if varformat eq '' then varformat = 'best12.';
13643  _X_=.;
13644  if type = 'N' then do;
13645  _X_ = getvarn(dsid, varblnum);
13646  _XLABEL_ = left(putn(_X_, varformat));
13647  end;
13648  else _XLABEL_ = getvarc(dsid, varblnum);
13649  if getvarc(dsid, typenum) = '11' then output;
13650  end;
13651  dsid = close(dsid);
13652  run;
 
NOTE: The data set EMWS1.CLUS2_PROFILE has 285 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
 
 
13653  proc sort data=EMWS1.Clus2_PROFILE NOTHREADS;
13654  by _VARIABLE_ _SEGMENT_;
13655  run;
 
NOTE: There were 285 observations read from the data set EMWS1.CLUS2_PROFILE.
NOTE: The data set EMWS1.CLUS2_PROFILE has 285 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13656  proc means data=EMWS1.Clus2_PROFILE noprint missing NWAY;
13657  class _VARIABLE_ _SEGMENT_;
13658  var COUNT;
13659  output out=WORK.Clus2_STATCOUNT(keep=_SEGMENT_ _VARIABLE_ SUM) SUM=SUM;
13660  run;
 
NOTE: There were 285 observations read from the data set EMWS1.CLUS2_PROFILE.
NOTE: The data set WORK.CLUS2_STATCOUNT has 51 observations and 3 variables.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
13661  proc sort data=WORK.Clus2_STATCOUNT NOTHREADS;
13662  by _VARIABLE_ _SEGMENT_;
13663  run;
 
NOTE: There were 51 observations read from the data set WORK.CLUS2_STATCOUNT.
NOTE: The data set WORK.CLUS2_STATCOUNT has 51 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13664  data EMWS1.Clus2_PROFILE(drop=SUM);
13665  label BYPERCENT= "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel, NOQUOTE, _SEGMENT_))";
13666  merge EMWS1.Clus2_PROFILE WORK.Clus2_STATCOUNT;
13667  by _VARIABLE_ _SEGMENT_;
13668  if SUM ne . then BYPERCENT = 100*COUNT/SUM;
13669  run;
 
NOTE: There were 285 observations read from the data set EMWS1.CLUS2_PROFILE.
NOTE: There were 51 observations read from the data set WORK.CLUS2_STATCOUNT.
NOTE: The data set EMWS1.CLUS2_PROFILE has 285 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13670  proc sort data=EMWS1.Clus2_PROFILE NOTHREADS;
13671  by _VARIABLE_;
13672  run;
 
NOTE: There were 285 observations read from the data set EMWS1.CLUS2_PROFILE.
NOTE: The data set EMWS1.CLUS2_PROFILE has 285 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13673  proc sort data=WORK.M2ZI8TNS;
13674  by Name;
13675  run;
 
NOTE: There were 18 observations read from the data set WORK.M2ZI8TNS.
NOTE: The data set WORK.M2ZI8TNS has 18 observations and 21 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13676  data EMWS1.Clus2_PROFILE;
13677  merge EMWS1.Clus2_PROFILE(in=_a) WORK.M2ZI8TNS(keep=Name Label Role rename=(Name=_Variable_ Label=_Label_));
13678  by _Variable_;
13679  label Role = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel ,  NOQUOTE))";
13680  label Label = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel , NOQUOTE))";
13681  if _a then output;
13682  run;
 
NOTE: Variable Label is uninitialized.
WARNING: Multiple lengths were specified for the BY variable _VARIABLE_ by input data sets. This might cause unexpected results.
NOTE: There were 285 observations read from the data set EMWS1.CLUS2_PROFILE.
NOTE: There were 18 observations read from the data set WORK.M2ZI8TNS.
NOTE: The data set EMWS1.CLUS2_PROFILE has 285 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13683  proc sort data=EMWS1.Clus2_PROFILE;
13684  by _SEGMENT_ _VARIABLE_ _X_;
13685  run;
 
NOTE: There were 285 observations read from the data set EMWS1.CLUS2_PROFILE.
NOTE: The data set EMWS1.CLUS2_PROFILE has 285 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13686  data EMWS1.Clus2_PROFILE(rename=(_VARIABLE_=Variable _X_=NumericValue _XLABEL_=FmtValue));
13687  set EMWS1.Clus2_PROFILE;
13688  retain orderedValue 0;
13689  label OrderedValue = "%sysfunc(sasmsg(sashelp.dmine, rpt_OrderedValue_vlabel, NOQUOTE))";
13690  by _SEGMENT_ _VARIABLE_;
13691  if first._variable_ then orderedValue=1;
13692  else orderedValue+1;
13693  run;
 
NOTE: There were 285 observations read from the data set EMWS1.CLUS2_PROFILE.
NOTE: The data set EMWS1.CLUS2_PROFILE has 285 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13694  proc transpose data=EMWS1.Clus2_OUTVAR out=WORK.Clus2_OUTVAR(where=(COL1 ^in('IMPUTED','OMITTED')));
13695  var AffluenceGrade--REP_RegionU;
13696  where _TYPE_ in('TYPE' 'VARIABLE');
13697  run;
 
NOTE: There were 2 observations read from the data set EMWS1.CLUS2_OUTVAR.
      WHERE _TYPE_ in ('TYPE', 'VARIABLE');
NOTE: The data set WORK.CLUS2_OUTVAR has 46 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13698  *------------------------------------------------------------* ;
13699  * Clus2: DMVQ Variables;
13700  *------------------------------------------------------------* ;
13701  %macro dmvqvars;
13702      AffluenceGrade CleanserProducts DayCareProducts LotionProducts
13703     NightRepairProducts REP_Age REP_LoyaltyTime TimeSinceLastPurchase TotalSpend
13704     CampaignViewedEmail0 CampaignViewedEmail1 LoyaltyClassGold LoyaltyClassPlatinum
13705     MobileApplications0 MobileApplications1 PreviousCampaign0 PreviousCampaign1
13706     REP_AdvertisementZBorder REP_AdvertisementZCentral_Z1
13707     REP_AdvertisementZE_Central REP_AdvertisementZN_Central
13708     REP_AdvertisementZN_East REP_AdvertisementZN_West REP_AdvertisementZNE_Z1
13709     REP_AdvertisementZNE_Z2 REP_AdvertisementZNE_Z3 REP_AdvertisementZS_Central
13710     REP_AdvertisementZS_East REP_AdvertisementZS_West REP_AdvertisementZU
13711     REP_AdvertisementZW_Central REP_ClusterGroupA REP_ClusterGroupB
13712     REP_ClusterGroupC REP_ClusterGroupD REP_ClusterGroupE REP_ClusterGroupF
13713     REP_ClusterGroupU REP_GenderF REP_GenderM REP_RegionCentral REP_RegionNorth
13714     REP_RegionNorthEast REP_RegionSouth_East REP_RegionSouth_West REP_RegionU
13715  %mend ;
13716
13717
 
13718  data WORK.Clus2_temp;
13719  set EMWS1.Clus2_OUTMEAN;
13720  _idvar_=left(put(_SEGMENT_,4.));
13721  run;
 
NOTE: There were 3 observations read from the data set EMWS1.CLUS2_OUTMEAN.
NOTE: The data set WORK.CLUS2_TEMP has 3 observations and 56 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13722  proc distance data=WORK.Clus2_temp out=EMWS1.Clus2_DISTANCE method=l(2) shape=square;
13723  id _idvar_;
13724  var interval(%dmvqvars);
13725  run;
 
NOTE: The data set EMWS1.CLUS2_DISTANCE has 3 observations and 4 variables.
NOTE: PROCEDURE DISTANCE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13726  proc datasets lib=EMWS1 nolist;
13727  modify Clus2_DISTANCE;
13728  rename _idvar_=_SEGMENT_;
NOTE: Renaming variable _idvar_ to _SEGMENT_.
13729  run;
 
NOTE: MODIFY was successful for EMWS1.CLUS2_DISTANCE.DATA.
13730  quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
 
 
13731  *------------------------------------------------------------*;
13732  * Clus2: Creating data set for Input Mean report;
13733  *------------------------------------------------------------*;
13734  data temp(drop=_type_ over_all);
13735  set EMWS1.Clus2_OUTSTAT;
13736  where _type_ in('DMDB_MEAN', 'CLUS_MEAN');
13737  run;
 
NOTE: There were 4 observations read from the data set EMWS1.CLUS2_OUTSTAT.
      WHERE _type_ in ('CLUS_MEAN', 'DMDB_MEAN');
NOTE: The data set WORK.TEMP has 4 observations and 47 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.00 seconds
 
 
13738  proc sort data=temp;
13739  by _SEGMENT_;
13740  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 4 observations and 47 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13741  proc stdize data=temp out=stdtemp pctlpts=0 100 outstat=stat;
13742  var AffluenceGrade--REP_RegionU;
13743  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.STDTEMP has 4 observations and 47 variables.
NOTE: The data set WORK.STAT has 10 observations and 47 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13744  proc transpose data=stat out=tstat(rename=(COL1=MEAN COL2=STD COL3=MIN COL4=MAX));
13745  where _type_ in ('LOCATION', 'SCALE','P0', 'P100');
13746  run;
 
NOTE: There were 4 observations read from the data set WORK.STAT.
      WHERE _type_ in ('LOCATION', 'P0', 'P100', 'SCALE');
NOTE: The data set WORK.TSTAT has 46 observations and 6 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13747  data tstat( rename=(_NAME_=NAME) keep=_NAME_ cv stdmin stdmax);
13748  set tstat;
13749  if std ^in (0, .) then do;
13750  stdmin = abs((min-mean)/std);
13751  stdmax = abs((max-mean)/std);
13752  end;
13753  if mean ^in(0, .) then cv = std/mean;
13754  run;
 
NOTE: There were 46 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTAT has 46 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13755  proc sort data=tstat;
13756  by NAME;
13757  run;
 
NOTE: There were 46 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTAT has 46 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13758  proc transpose data=stdtemp out=tstdtemp(rename=(_NAME_=NAME _LABEL_=LABEL COL1=MEAN));
13759  by _SEGMENT_;
13760  run;
 
NOTE: There were 4 observations read from the data set WORK.STDTEMP.
NOTE: The data set WORK.TSTDTEMP has 184 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13761  proc sort data=tstdtemp;
13762  by NAME;
13763  run;
 
NOTE: There were 184 observations read from the data set WORK.TSTDTEMP.
NOTE: The data set WORK.TSTDTEMP has 184 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13764  data tstdtemp;
13765  merge tstdtemp tstat;
13766  by NAME;
13767  STDMEAN = (MEAN + stdmin)/(stdmin + stdmax);
13768  drop stdmin stdmax mean;
13769  run;
 
NOTE: There were 184 observations read from the data set WORK.TSTDTEMP.
NOTE: There were 46 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTDTEMP has 184 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13770  proc transpose data=EMWS1.Clus2_OUTVAR out=tempVar(drop=_LABEL_ rename=( _NAME_=NAME VARIABLE=INPUT));
13771  var AffluenceGrade--REP_RegionU;
13772  id _type_;
13773  where _type_ = 'VARIABLE';
13774  run;
 
NOTE: There were 1 observations read from the data set EMWS1.CLUS2_OUTVAR.
      WHERE _type_='VARIABLE';
NOTE: The data set WORK.TEMPVAR has 47 observations and 2 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13775  proc sort data=tempVar;
13776  by NAME;
13777  run;
 
NOTE: There were 47 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 47 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13778  data EMWS1.Clus2_INPUTMEAN(rename=(NAME=VARIABLE));
13779  Length _SEGMENT_CHAR_ $7;
13780  label _SEGMENT_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentName_vlabel,  NOQUOTE))" _SEGMENT_CHAR_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentId_vlabel,    NOQUOTE))" NAME = "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel,     NOQUOTE))"
13780! INPUT =
13781     "%sysfunc(sasmsg(sashelp.dmine, rpt_input_vlabel,        NOQUOTE))" LABEL = "%sysfunc(sasmsg(sashelp.dmine, rpt_label_vlabel,        NOQUOTE))" CV = "%sysfunc(sasmsg(sashelp.dmine, rpt_cv_vlabel,           NOQUOTE))" STDMEAN =
13782     "%sysfunc(sasmsg(sashelp.dmine, rpt_normmean_vlabel,     NOQUOTE))";
13783  merge tempvar tstdtemp;
13784  by NAME;
13785  if LABEL='' then LABEL=NAME;
13786  _SEGMENT_CHAR_ = strip(put(_SEGMENT_, best.));
13787  if _SEGMENT_ = . then _SEGMENT_CHAR_='Overall';
13788  run;
 
NOTE: There were 47 observations read from the data set WORK.TEMPVAR.
NOTE: There were 184 observations read from the data set WORK.TSTDTEMP.
NOTE: The data set EMWS1.CLUS2_INPUTMEAN has 185 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
13789  proc sort data=EMWS1.Clus2_INPUTMEAN;
13790  by descending cv;
13791  run;
 
NOTE: There were 185 observations read from the data set EMWS1.CLUS2_INPUTMEAN.
NOTE: The data set EMWS1.CLUS2_INPUTMEAN has 185 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13792  *------------------------------------------------------------*;
13793  * Clus2: Determining the important variables;
13794  *------------------------------------------------------------*;
 
13795  %let _nobs = 0;
13796  data keepvars(rename=(NAME=INPUT));
13797  set EMWS1.Clus2_OUTIMPORT(where=(IMPORTANCE>0.5)) end=eof;
13798  if eof then call symput('_nobs', strip(put(_N_, best.)));
13799  run;
 
NOTE: There were 14 observations read from the data set EMWS1.CLUS2_OUTIMPORT.
      WHERE IMPORTANCE>0.5;
NOTE: The data set WORK.KEEPVARS has 14 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13800  proc transpose data=EMWS1.Clus2_OUTVAR out=tempVar(drop=_LABEL_ rename=( _NAME_=NAME VARIABLE=INPUT));
13801  var AffluenceGrade--REP_RegionU;
13802  id _type_;
13803  where _type_ = 'VARIABLE';
13804  run;
 
NOTE: There were 1 observations read from the data set EMWS1.CLUS2_OUTVAR.
      WHERE _type_='VARIABLE';
NOTE: The data set WORK.TEMPVAR has 47 observations and 2 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13805  proc sort data=keepvars;
13806  by INPUT;
13807  run;
 
NOTE: There were 14 observations read from the data set WORK.KEEPVARS.
NOTE: The data set WORK.KEEPVARS has 14 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13808  proc sort data=tempvar;
13809  by INPUT;
13810  run;
 
NOTE: There were 47 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 47 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13811  data vars;
13812  merge tempvar keepvars(in=b);
13813  by INPUT;
13814  if b then output;
13815  run;
 
WARNING: Multiple lengths were specified for the BY variable INPUT by input data sets. This might cause unexpected results.
NOTE: There were 47 observations read from the data set WORK.TEMPVAR.
NOTE: There were 14 observations read from the data set WORK.KEEPVARS.
NOTE: The data set WORK.VARS has 43 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13816  proc sort data=vars;
13817  by descending importance;
13818  run;
 
NOTE: There were 43 observations read from the data set WORK.VARS.
NOTE: The data set WORK.VARS has 43 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13819  data _null_;
13820  set vars;
13821  if _N_=1 then call symput('CLUS_PROFVARS', strip(NAME));
13822  else call symput('CLUS_PROFVARS',symget('CLUS_PROFVARS')!!' '!!strip(NAME));
13823  run;
 
NOTE: There were 43 observations read from the data set WORK.VARS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13824  *------------------------------------------------------------*;
13825  * mergeVarMeansandClusLabel;
13826  *------------------------------------------------------------*;
13827  data temp(keep=_SEGMENT_ &CLUS_PROFVARS);
13828  length _SEGMENT_ &CLUS_PROFVARS 8;
13829  set EMWS1.Clus2_OUTSTAT;
13830  where _type_ ='CLUS_MEAN';
13831  run;
 
NOTE: There were 3 observations read from the data set EMWS1.CLUS2_OUTSTAT.
      WHERE _type_='CLUS_MEAN';
NOTE: The data set WORK.TEMP has 3 observations and 44 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13832  proc sort data=temp;
13833  by _SEGMENT_;
13834  run;
 
NOTE: There were 3 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 3 observations and 44 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13835  data EMWS1.Clus2_LABEL;
13836  merge EMWS1.Clus2_LABEL(keep=_SEGMENT_ LABEL) temp;
13837  by _SEGMENT_;
13838  run;
 
NOTE: There were 3 observations read from the data set EMWS1.CLUS2_LABEL.
NOTE: There were 3 observations read from the data set WORK.TEMP.
NOTE: The data set EMWS1.CLUS2_LABEL has 3 observations and 45 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
