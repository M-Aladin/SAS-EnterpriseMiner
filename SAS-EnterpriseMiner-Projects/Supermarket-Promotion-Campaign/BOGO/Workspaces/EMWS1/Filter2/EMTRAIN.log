*------------------------------------------------------------*
* Training Log
Date:                May 09, 2018
Time:                14:47:13
*------------------------------------------------------------*
11405  proc freq data=EMWS1.Filter2_VariableSet noprint;
11406  table ROLE*LEVEL/out=WORK.Filter2META;
11407  run;

NOTE: There were 29 observations read from the data set EMWS1.FILTER2_VARIABLESET.
NOTE: The data set WORK.FILTER2META has 7 observations and 4 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds
      

11408  proc print data=WORK.Filter2META label noobs;
11409  var ROLE LEVEL COUNT;
11410  label ROLE = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel, NOQUOTE))" LEVEL = "%sysfunc(sasmsg(sashelp.dmine, meta_level_vlabel, NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel, NOQUOTE))";
11411  title9 ' ';
11412  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_varSummary_title  , NOQUOTE))";
11413  run;

NOTE: There were 7 observations read from the data set WORK.FILTER2META.
NOTE: The PROCEDURE PRINT printed page 1.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

11414  title10;

11437  filename cdist catalog 'SASHELP.EMUTIL.EM_CLASSDIST.SOURCE';
11438  %inc cdist;
11552  filename cdist;
NOTE: Fileref CDIST has been deassigned.
11553  data work.tempSummaryClass;
11554  set EMWS1.Filter2_CLASSDIST(drop=Count Percent);
11555  where Filter='Y';
11556  run;

NOTE: There were 4 observations read from the data set EMWS1.FILTER2_CLASSDIST.
      WHERE Filter='Y';
NOTE: The data set WORK.TEMPSUMMARYCLASS has 4 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

11557  proc sort data=work.tempSummaryClass;
11558  by variable value;
11559  run;

NOTE: There were 4 observations read from the data set WORK.TEMPSUMMARYCLASS.
NOTE: The data set WORK.TEMPSUMMARYCLASS has 4 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

11560  %class_profile(DATA=EMWS1.Clus_TRAIN, OUTPUT=EMWS1.Filter2_CLASSDIST, METADATA=EMWS1.Filter2_VariableSet, STAT=_STAT);

NOTE: There were 16 observations read from the data set EMWS1.FILTER2_VARIABLESET.
      WHERE (LEVEL not = 'INTERVAL') and (ROLE not = 'FREQ');
NOTE: The data set WORK._NULL has 16 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: The file _MAC is:
      Catalog Name=WORK.MACROS.VARIABLES.SOURCE,
      Catalog Page Size=4096,
      Number of Catalog Pages=4,
      Created=Wed, May  9, 2018 02:47:14 PM,
      Last Modified=Wed, May  9, 2018 02:47:14 PM,
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\macros.sas7bcat,
      Release Created=9.0401M4,
      Host Created=X64_10HOME,
      Owner Name=DESKTOP-MVTLU7L\Mohamed,
      File Size=             5KB,
      File Size (bytes)=5120

NOTE: 6 records were written to the file _MAC.
      The minimum record length was 12.
      The maximum record length was 70.
NOTE: There were 16 observations read from the data set EMWS1.FILTER2_VARIABLESET.
      WHERE (LEVEL not = 'INTERVAL') or (ROLE='FREQ');
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

NOTE: Fileref _MAC has been deassigned.

NOTE: Records processed = 4224   Memory used = 511K.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: View EMWS1.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.37 seconds
      cpu time            0.39 seconds
      
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.CLUS_TRAIN.
NOTE: The data set WORK._TEMPCLASS has 78 observations and 9 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.40 seconds
      cpu time            0.42 seconds
      


NOTE: There were 78 observations read from the data set WORK._TEMPCLASS.
NOTE: The data set WORK._TEMPCLASS has 78 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 78 observations read from the data set WORK._TEMPCLASS.
NOTE: The data set EMWS1.FILTER2_CLASSDIST has 78 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 78 observations read from the data set EMWS1.FILTER2_CLASSDIST.
NOTE: The data set WORK._STAT has 17 observations and 4 variables.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      


NOTE: There were 16 observations read from the data set WORK._STAT.
      WHERE _TYPE_=1;
NOTE: The data set WORK._STAT has 16 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

NOTE: Deleting WORK._TEMPCLASS (memtype=DATA).
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


11567  data EMWS1.Filter2_CLASSDIST;
11568  set EMWS1.Filter2_CLASSDIST;
11569  length Filter $1;
11570  retain Filter 'N';
11571  run;

NOTE: There were 78 observations read from the data set EMWS1.FILTER2_CLASSDIST.
NOTE: The data set EMWS1.FILTER2_CLASSDIST has 78 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11572  proc sort data=EMWS1.Filter2_CLASSDIST;
11573  by variable value;
11574  run;

NOTE: There were 78 observations read from the data set EMWS1.FILTER2_CLASSDIST.
NOTE: The data set EMWS1.FILTER2_CLASSDIST has 78 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

11575  data EMWS1.Filter2_CLASSDIST;
11576  merge EMWS1.Filter2_CLASSDIST(in=_a) work.tempSummaryClass(in=_b);
11577  by variable value;
11578  if _a then output;
11579  run;

NOTE: There were 78 observations read from the data set EMWS1.FILTER2_CLASSDIST.
NOTE: There were 4 observations read from the data set WORK.TEMPSUMMARYCLASS.
NOTE: The data set EMWS1.FILTER2_CLASSDIST has 78 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

11580  data EMWS1.Filter2_CLASSFILTER / view=EMWS1.Filter2_CLASSFILTER;
11581  set EMWS1.Filter2_CLASSDIST;
11582  where Filter eq 'Y';
11583  run;

NOTE: DATA STEP view saved on file EMWS1.FILTER2_CLASSFILTER.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

11584  %let EM_CODEBAR = *------------------------------------------------------------*;
11585  filename cdist catalog 'SASHELP.EMUTIL.EM_VARDIST.SOURCE';
11586  %inc cdist;
11982  filename cdist;
NOTE: Fileref CDIST has been deassigned.
11983  %var_profile(DATA=EMWS1.Clus_TRAIN, OUTPUT=EMWS1.Filter2_VARDIST, METADATA=EMWS1.Filter2_VariableSet, COMPUTESTAT=N, FREQ=, BIN=Y, NUMBARS= 16, minmax=Y);
*------------------------------------------------------------*
* EM: Computing Summary Statistics
*------------------------------------------------------------*

NOTE: There were 13 observations read from the data set EMWS1.FILTER2_VARIABLESET.
      WHERE (LEVEL='INTERVAL') and (ROLE not = 'FREQ');
NOTE: The data set WORK._NULL has 13 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      


NOTE: The file _MAC is:
      Catalog Name=WORK.MACROS.VARIABLES.SOURCE,
      Catalog Page Size=4096,
      Number of Catalog Pages=5,
      Created=Wed, May  9, 2018 02:47:14 PM,
      Last Modified=Wed, May  9, 2018 02:47:14 PM,
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\macros.sas7bcat,
      Release Created=9.0401M4,
      Host Created=X64_10HOME,
      Owner Name=DESKTOP-MVTLU7L\Mohamed,
      File Size=            17KB,
      File Size (bytes)=17408

NOTE: 5 records were written to the file _MAC.
      The minimum record length was 12.
      The maximum record length was 75.
NOTE: There were 13 observations read from the data set EMWS1.FILTER2_VARIABLESET.
      WHERE (LEVEL='INTERVAL') or (ROLE='FREQ');
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

NOTE: Fileref _MAC has been deassigned.

NOTE: The file WORK._BOUNDS (memtype=(DATA VIEW)) was not found, but appears on a DELETE statement.
*------------------------------------------------------------*
* computingmidpoints_note
*------------------------------------------------------------*

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      


NOTE: Records processed = 4224   Memory used = 511K.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: View EMWS1.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.38 seconds
      cpu time            0.39 seconds
      
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.CLUS_TRAIN.
NOTE: The data set WORK._CLASSOUT has 158 observations and 9 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.40 seconds
      cpu time            0.39 seconds
      


NOTE: There were 158 observations read from the data set WORK._CLASSOUT.
NOTE: The data set WORK._COUNT has 5 observations and 3 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 5 observations read from the data set WORK._COUNT.
NOTE: The data set WORK._COUNT has 5 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 158 observations read from the data set WORK._CLASSOUT.
NOTE: The data set WORK._CLASSOUT has 158 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 158 observations read from the data set WORK._CLASSOUT.
NOTE: The data set WORK._DISCRETEMID has 13 observations and 18 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      


NOTE: Deleting WORK._CLASSOUT (memtype=DATA).
NOTE: PROCEDURE DELETE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: There were 13 observations read from the data set WORK._DISCRETEMID.
NOTE: There were 5 observations read from the data set WORK._COUNT.
NOTE: The data set WORK._DISCRETEMID has 5 observations and 19 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: DATA STEP view saved on file WORK._EMVARDIST.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS1.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.18 seconds
      cpu time            0.18 seconds
      
NOTE: DATA statement used (Total process time):
      real time           0.21 seconds
      cpu time            0.21 seconds
      


NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: View WORK._EMVARDIST.VIEW used (Total process time):
      real time           0.51 seconds
      cpu time            0.51 seconds
      
NOTE: There were 4224 observations read from the data set EMWS1.CLUS_TRAIN.
NOTE: There were 4224 observations read from the data set WORK._EMVARDIST.
NOTE: The data set WORK._PCTLSTAT has 15 observations and 14 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.54 seconds
      cpu time            0.54 seconds
      


NOTE: Deleting WORK._EMVARDIST (memtype=VIEW).

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 2 observations read from the data set WORK._PCTLSTAT.
      WHERE _type_ in ('P0', 'P100');
NOTE: The data set WORK._MINMAXDATA has 13 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      


NOTE: There were 13 observations read from the data set WORK._MINMAXDATA.
NOTE: The data set WORK._MINMAXDATA has 26 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 4 observations read from the data set WORK._PCTLSTAT.
      WHERE _type_ in ('P0', 'P100', 'P5', 'P95');
NOTE: The data set WORK._BOUNDS has 13 observations and 6 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      


NOTE: There were 13 observations read from the data set WORK._BOUNDS.
NOTE: The data set WORK._BOUNDS has 13 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 13 observations read from the data set WORK._BOUNDS.
NOTE: The data set WORK._BOUNDS has 13 observations and 69 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


WARNING: Multiple lengths were specified for the BY variable VARIABLE by input data sets. This might cause unexpected results.
NOTE: There were 13 observations read from the data set WORK._BOUNDS.
NOTE: There were 5 observations read from the data set WORK._DISCRETEMID.
NOTE: The data set WORK._BOUNDS has 13 observations and 71 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: The file FREF is:
      Catalog Name=WORK.EM.PROFILEFORMAT.SOURCE,
      Catalog Page Size=4096,
      Number of Catalog Pages=4,
      Created=Wed, May  9, 2018 02:47:16 PM,
      Last Modified=Wed, May  9, 2018 02:47:16 PM,
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\em.sas7bcat,
      Release Created=9.0401M4,
      Host Created=X64_10HOME,
      Owner Name=DESKTOP-MVTLU7L\Mohamed,
      File Size=             5KB,
      File Size (bytes)=5120

NOTE: 218 records were written to the file FREF.
      The minimum record length was 1.
      The maximum record length was 43.
NOTE: There were 13 observations read from the data set WORK._BOUNDS.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

NOTE: Format F1_ has been output.
NOTE: Format F2_ has been output.
NOTE: Format F3_ has been output.
NOTE: Format F4_ has been output.
NOTE: Format F5_ has been output.
NOTE: Format F6_ has been output.
NOTE: Format F7_ has been output.
NOTE: Format F8_ has been output.
NOTE: Format F9_ has been output.
NOTE: Format F10_ has been output.
NOTE: Format F11_ has been output.
NOTE: Format F12_ has been output.
NOTE: Format F13_ has been output.

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

NOTE: Fileref FREF has been deassigned.

NOTE: DATA STEP view saved on file WORK._BINNEDDATA.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS1.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.29 seconds
      cpu time            0.26 seconds
      
NOTE: DATA statement used (Total process time):
      real time           0.32 seconds
      cpu time            0.29 seconds
      


NOTE: Records processed = 4224   Memory used = 511K.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: View WORK._BINNEDDATA.VIEW used (Total process time):
      real time           0.43 seconds
      cpu time            0.43 seconds
      
NOTE: There were 4224 observations read from the data set EMWS1.CLUS_TRAIN.
NOTE: There were 4224 observations read from the data set WORK._BINNEDDATA.
NOTE: The data set WORK._TEMPTAB has 179 observations and 9 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.48 seconds
      cpu time            0.50 seconds
      


NOTE: There were 179 observations read from the data set WORK._TEMPTAB.
NOTE: The data set EMWS1.FILTER2_VARDIST has 179 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: There were 179 observations read from the data set EMWS1.FILTER2_VARDIST.
NOTE: There were 26 observations read from the data set WORK._MINMAXDATA.
NOTE: The data set EMWS1.FILTER2_VARDIST has 205 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      


NOTE: There were 205 observations read from the data set EMWS1.FILTER2_VARDIST.
      WHERE VALUE not = .;
NOTE: The data set EMWS1.FILTER2_VARDIST has 205 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


NOTE: Deleting WORK._TEMPTAB (memtype=DATA).
NOTE: Deleting WORK._BINNEDDATA (memtype=VIEW).
NOTE: Deleting WORK._MINMAXDATA (memtype=DATA).

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      


12217  *------------------------------------------------------------* ;
12218  * Filter2: DMDBClass Macro ;
12219  *------------------------------------------------------------* ;
12220  %macro DMDBClass;
12221      CampaignViewedEmail(ASC) FacebookLike(ASC) LoyaltyClass(ASC)
12222     MobileApplications(ASC) PreviousCampaign(ASC) REP_AdvertisementZone(ASC)
12223     REP_ClusterGroup(ASC) REP_Gender(ASC) REP_Region(ASC) _SEGMENT_LABEL_(ASC)
12224  %mend DMDBClass;
12225  *------------------------------------------------------------* ;
12226  * Filter2: DMDBVar Macro ;
12227  *------------------------------------------------------------* ;
12228  %macro DMDBVar;
12229      AffluenceGrade CleanserProducts DayCareProducts LotionProducts
12230     NightRepairProducts REP_Age REP_LoyaltyTime TimeSinceLastPurchase TotalSpend
12231  %mend DMDBVar;
12232  *------------------------------------------------------------*;
12233  * Filter2: Create DMDB;
12234  *------------------------------------------------------------*;
12235  proc dmdb batch data=EMWS1.Clus_TRAIN
12236  classout=WORK._EMFILTERCLASS
12237  varout=WORK._EMFILTERVAR
12238  maxlevel = 26
12239  ;
12240  class %DMDBClass;
12241  var %DMDBVar;
12242  run;

NOTE: Records processed = 4224   Memory used = 511K.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: View EMWS1.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.36 seconds
      cpu time            0.34 seconds
      
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.CLUS_TRAIN.
NOTE: The data set WORK._EMFILTERCLASS has 42 observations and 9 variables.
NOTE: The data set WORK._EMFILTERVAR has 9 observations and 9 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.39 seconds
      cpu time            0.37 seconds
      

12243  quit;
12244  *--- end code ---*;

12245  data WORK.M348XLM7;
12246  set WORK.M348XLM7;
12247  if ROLE ^in('TARGET', 'INPUT', 'FREQ') and CALCMETHOD ne 'NONE' then ROLE ='INPUT';
12248  if LEVEL ne 'INTERVAL' and KEEPMISSING='N';
12249  run;

NOTE: There were 19 observations read from the data set WORK.M348XLM7.
NOTE: The data set WORK.M348XLM7 has 0 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12250  proc freq data=WORK._EMFILTERCLASS noprint;
12251  table NAME / out=WORK._EMFILTERFREQ(keep=NAME COUNT rename=(COUNT=NUMLEVELS));
12252  run;

NOTE: There were 42 observations read from the data set WORK._EMFILTERCLASS.
NOTE: The data set WORK._EMFILTERFREQ has 10 observations and 2 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
      

12253  data WORK._EMFILTERCLASS;
12254  set WORK._EMFILTERCLASS (rename=(FREQUENCY=COUNT FREQPERCENT=PERCENT));
12255  _OBS_= _N_;
12256  if (CRAW eq '' and NRAW eq .) then _OBS_=0;
12257  run;

NOTE: There were 42 observations read from the data set WORK._EMFILTERCLASS.
NOTE: The data set WORK._EMFILTERCLASS has 42 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12258  proc sort data=WORK._EMFILTERCLASS nodupkey;
12259  by NAME _OBS_;
12260  run;

NOTE: There were 42 observations read from the data set WORK._EMFILTERCLASS.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK._EMFILTERCLASS has 42 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

12261  proc sort data=WORK._EMFILTERFREQ;
12262  by NAME;
12263  run;

NOTE: There were 10 observations read from the data set WORK._EMFILTERFREQ.
NOTE: The data set WORK._EMFILTERFREQ has 10 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12264  data WORK._EMFILTERCLASS;
12265  merge WORK._EMFILTERCLASS WORK._EMFILTERFREQ;
12266  by NAME;
12267  run;

NOTE: There were 42 observations read from the data set WORK._EMFILTERCLASS.
NOTE: There were 10 observations read from the data set WORK._EMFILTERFREQ.
NOTE: The data set WORK._EMFILTERCLASS has 42 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12268  *------------------------------------------------------------* ;
12269  * Filter2: Input Variables Macro ;
12270  *------------------------------------------------------------* ;
12271  %macro EM_FILTERPCT;
12272      AffluenceGrade CleanserProducts DayCareProducts LotionProducts
12273     NightRepairProducts REP_Age REP_LoyaltyTime TimeSinceLastPurchase TotalSpend
12274  %mend EM_FILTERPCT;
12275  data EM_Filter2_PCT / view=EM_Filter2_PCT;
12276  set EMWS1.Clus_TRAIN(keep=%EM_FILTERPCT );
12277  run;

NOTE: DATA STEP view saved on file WORK.EM_FILTER2_PCT.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS1.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.23 seconds
      cpu time            0.21 seconds
      
NOTE: DATA statement used (Total process time):
      real time           0.25 seconds
      cpu time            0.23 seconds
      

12278  *------------------------------------------------------------*;
12279  * Filter2: Method PERCENTS;
12280  *------------------------------------------------------------*;
12281  proc stdize data=EM_Filter2_PCT outstat=WORK.Filter2OUTSTAT out=_null_ pctlpts= 0.5 99.5;
12282  var %EM_FILTERPCT;
12283  run;

NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: View WORK.EM_FILTER2_PCT.VIEW used (Total process time):
      real time           0.48 seconds
      cpu time            0.50 seconds
      
NOTE: There were 4224 observations read from the data set EMWS1.CLUS_TRAIN.
NOTE: There were 4224 observations read from the data set WORK.EM_FILTER2_PCT.
NOTE: The data set WORK.FILTER2OUTSTAT has 10 observations and 10 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.50 seconds
      cpu time            0.51 seconds
      

12284  data work._FilterMinFreq;
12285  set WORK.M3KLBKHU;
12286  where level ne 'INTERVAL';
12287  if KEEPMISSING in('D', '') then
12288  KEEPMISSING = "Y";
12289  *if ROLE='REJECTED' and CALCMETHOD in('', 'DEFAULT') and KEEPMISSING="Y" then delete;
12290  if ROLE ^in('INPUT','TARGET') and CALCMETHOD in('', 'DEFAULT') and KEEPMISSING="Y" then delete;
12291  if CALCMETHOD in('', 'DEFAULT') then CALCMETHOD = "MINPCT";
12292  if minfreq = . then minfreq=1;
12293  if MAXVALUES = . then MAXVALUES = 25;
12294  minClassPct = 0.01;
12295  run;

NOTE: There were 10 observations read from the data set WORK.M3KLBKHU.
      WHERE level not = 'INTERVAL';
NOTE: The data set WORK._FILTERMINFREQ has 10 observations and 27 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12296  proc sort data=work._FilterMinFreq;
12297  by NAME;
12298  run;

NOTE: There were 10 observations read from the data set WORK._FILTERMINFREQ.
NOTE: The data set WORK._FILTERMINFREQ has 10 observations and 27 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12299  proc sort data=WORK._EMFILTERCLASS;
12300  by NAME;
12301  run;

NOTE: There were 42 observations read from the data set WORK._EMFILTERCLASS.
NOTE: The data set WORK._EMFILTERCLASS has 42 observations and 11 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12302  data work._FilterMinFreq;
12303  merge work._FilterMinFreq(drop=LEVEL in=_a) WORK._EMFILTERCLASS (in=_b);
12304  if _a and _b then output;
12305  by NAME;
12306  run;

NOTE: There were 10 observations read from the data set WORK._FILTERMINFREQ.
NOTE: There were 42 observations read from the data set WORK._EMFILTERCLASS.
NOTE: The data set WORK._FILTERMINFREQ has 42 observations and 35 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12307  data work._FilterExclude;
12308  set work._FilterMinFreq;
12309  where ( ((CALCMETHOD = 'MINFREQ' and (COUNT ne . and COUNT <= minfreq)) or (CALCMETHOD = 'MINPCT' and (NMISSPERCENT ne . and 0.01*NMISSPERCENT <=minClassPct))) and (NUMLEVELS <= MAXVALUES)) or (KEEPMISSING eq 'N' and NRAW=. and CRAW='');
12310  run;

NOTE: There were 0 observations read from the data set WORK._FILTERMINFREQ.
      WHERE ((((CALCMETHOD='MINFREQ') and (COUNT not = .) and (COUNT<=minfreq)) or ((CALCMETHOD='MINPCT') and (NMISSPERCENT not = .) and (minClassPct>=(0.01*NMISSPERCENT)))) and (NUMLEVELS<=MAXVALUES)) or ((KEEPMISSING='N') and (NRAW=.) and (CRAW=' '));
NOTE: The data set WORK._FILTEREXCLUDE has 0 observations and 35 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12311  data work._ManualExclude;
12312  set WORK.M3KLBKHU;
12313  if CALCMETHOD in('', 'DEFAULT') then CALCMETHOD = "MINPCT";
12314  if level ne 'INTERVAL' and calcmethod='MANUAL' then output;
12315  run;

NOTE: There were 19 observations read from the data set WORK.M3KLBKHU.
NOTE: The data set WORK._MANUALEXCLUDE has 1 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12316  proc sort data=work._ManualExclude;
12317  by NAME;
12318  run;

NOTE: There were 1 observations read from the data set WORK._MANUALEXCLUDE.
NOTE: The data set WORK._MANUALEXCLUDE has 1 observations and 26 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

12319  proc sort data=EMWS1.Filter2_CLASSFILTER(rename=(VARIABLE=NAME VALUE=LEVEL)) out=_temp;
12320  by NAME;
12321  run;

NOTE: There were 3 observations read from the data set EMWS1.FILTER2_CLASSFILTER.
NOTE: View EMWS1.FILTER2_CLASSFILTER.VIEW used (Total process time):
      real time           0.09 seconds
      cpu time            0.09 seconds
      
NOTE: There were 3 observations read from the data set EMWS1.FILTER2_CLASSDIST.
      WHERE Filter='Y';
NOTE: The data set WORK._TEMP has 3 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.10 seconds
      cpu time            0.11 seconds
      

12322  data work._ManualExclude;
12323  merge work._ManualExclude(drop=LEVEL in=_a) _temp(in=_b);
12324  _OBS_=_N_;
12325  if strip(Level) in('.', '') then _OBS_=0;
12326  if _a and _b then output;
12327  by NAME;
12328  run;

NOTE: There were 1 observations read from the data set WORK._MANUALEXCLUDE.
NOTE: There were 3 observations read from the data set WORK._TEMP.
NOTE: The data set WORK._MANUALEXCLUDE has 3 observations and 30 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12329  data work._FilterExclude;
12330  set work._ManualExclude work._FilterExclude;
12331  if type = 'N' and format='' then level= strip(level);
12332  run;

NOTE: There were 3 observations read from the data set WORK._MANUALEXCLUDE.
NOTE: There were 0 observations read from the data set WORK._FILTEREXCLUDE.
NOTE: The data set WORK._FILTEREXCLUDE has 3 observations and 36 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

12333  proc sort data=work._FilterExclude nodupkey;
12334  by NAME _OBS_;
12335  run;

NOTE: There were 3 observations read from the data set WORK._FILTEREXCLUDE.
NOTE: 0 observations with duplicate key values were deleted.
NOTE: The data set WORK._FILTEREXCLUDE has 3 observations and 36 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
      

12336  %let _FilterClassNum= 0;
12337  data work._FilterExclude;
12338  retain newvarindex 0;
12339  length newvar normvar $32;
12340  drop newvarindex string;
12341  set work._FilterExclude end=eof;
12342  by NAME;
12343  if first.NAME then do;
12344  newvarindex + 1;
12345  if format ne '' then do;
12346  newvar = strip("_FILTERFMT")!!strip(put(newvarindex, best.));
12347  end;
12348  else newvar = name;
12349  if CALCMETHOD ne 'MANUAL' then do;
12350  if format ne '' or type = 'C' then do;
12351  normvar = strip("_FILTERNORM")!!strip(put(newvarindex, best.));
12352  end;
12353  end;
12354  end;
12355  if eof then call symput('_FilterClassNum', strip(put(_N_, best.)));
12356  run;

WARNING: The variable string in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 3 observations read from the data set WORK._FILTEREXCLUDE.
NOTE: The data set WORK._FILTEREXCLUDE has 3 observations and 38 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12357  data EMWS1.Filter2_CLASS;
12358  label NAME = "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel,     NOQUOTE))" ROLE = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel,        NOQUOTE))" VALUE = "%sysfunc(sasmsg(sashelp.dmine, rpt_value_vlabel,        NOQUOTE))" COUNT =
12359     "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel,        NOQUOTE))" PERCENT = "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel,      NOQUOTE))" LABEL = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel,       NOQUOTE))" CALCMETHOD =
12360     "%sysfunc(sasmsg(sashelp.dmine, rpt_filtermethod_vlabel, NOQUOTE))";
12361  length VALUE $80;
12362  set work._FilterExclude;
12363  keep NAME ROLE VALUE COUNT PERCENT LABEL CALCMETHOD;
12364  if COUNT = . then COUNT = 0;
12365  if PERCENT = . then PERCENT = 0;
12366  VALUE = LEVEL;
12367  if _OBS_ = 0 and KEEPMISSING='N' then do;
12368  CALCMETHOD= '';
12369  KEEPMISSING = '';
12370  if VALUE = '' and type eq 'C' then VALUE = '_BLANK_';
12371  if type eq 'N' then do;
12372  VALUE = strip(VALUE);
12373  if VALUE = '' then VALUE = '.';
12374  end;
12375  end;
12376  run;

NOTE: There were 3 observations read from the data set WORK._FILTEREXCLUDE.
NOTE: The data set EMWS1.FILTER2_CLASS has 3 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

12377  %let _FOBS=0;
12378  filename _X "C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\NEWVAR.txt";
12379  data _null_;
12380  length string $200;
12381  set work._FilterExclude end=eof;
12382  file _X;
12383  by NAME;
12384  if first.NAME then do;
12385  if format ne '' then do;
12386  put ' ';
12387  put ' ';
12388  put 'length ' newvar ' $200;';
12389  put 'drop ' newvar ';';
12390  string = strip(newvar)!!'= put('!!strip(NAME)!!','!!strip(format)!!');';
12391  put string;
12392  end;
12393  else newvar = name;
12394  if CALCMETHOD ne 'MANUAL' then do;
12395  if format ne '' or type = 'C' then do;
12396  if (newvar eq name) then do;
12397  put ' ';
12398  end;
12399  put 'length ' normvar " $%dmnorlen;";
12400  put 'drop ' normvar ';';
12401  string = '%dmnormcp('!!strip(newvar)!!','!!strip(normvar)!!');';
12402  put string;
12403  end;
12404  end;
12405  end;
12406  if eof then call symput('_FOBS', '1');
12407  run;

NOTE: The file _X is:
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\NEWVAR.txt,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=09May2018:14:47:19,
      Create Time=09May2018:14:47:19

NOTE: 0 records were written to the file _X.
NOTE: There were 3 observations read from the data set WORK._FILTEREXCLUDE.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

12408  %let _FOBS=0;
12409  filename _X "C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\PUBLISHNEWVAR.txt";
12410  data _null_;
12411  length string $200;
12412  set work._FilterExclude end=eof;
12413  where ROLE ne 'TARGET';
12414  file _X;
12415  by NAME;
12416  if first.NAME then do;
12417  if format ne '' then do;
12418  put ' ';
12419  put ' ';
12420  put 'length ' newvar ' $200;';
12421  put 'drop ' newvar ';';
12422  string = strip(newvar)!!'= put('!!strip(NAME)!!','!!strip(format)!!');';
12423  put string;
12424  end;
12425  else newvar = name;
12426  if CALCMETHOD ne 'MANUAL' then do;
12427  if format ne '' or type = 'C' then do;
12428  if (newvar eq name) then do;
12429  put ' ';
12430  end;
12431  put 'length ' normvar " $%dmnorlen;";
12432  put 'drop ' normvar ';';
12433  string = '%dmnormcp('!!strip(newvar)!!','!!strip(normvar)!!');';
12434  put string;
12435  end;
12436  end;
12437  end;
12438  if eof then call symput('_FOBS', '1');
12439  run;

NOTE: The file _X is:
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\PUBLISHNEWVAR.txt,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=09May2018:14:47:19,
      Create Time=09May2018:14:47:19

NOTE: 0 records were written to the file _X.
NOTE: There were 3 observations read from the data set WORK._FILTEREXCLUDE.
      WHERE ROLE not = 'TARGET';
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12440  %let _FOBS=0;
12441  filename _X "C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\CLASSFILTERCODE.txt";
12442  data _null_;
12443  length line string $200 _filtervar $32;
12444  drop newvarindex string;
12445  retain line '';
12446  set work._FilterExclude end=eof;
12447  file _X;
12448  by NAME;
12449  if first.NAME then do;
12450  _filtervar = NAME;
12451  if newvar ne '' then _filtervar = newvar;
12452  if normvar ne '' then _filtervar = normvar;
12453  if _N_ ne 1 then put ' and ';
12454  if format ne '' or type = 'C' then do;
12455  line = strip(_filtervar)!!" not in ( '"!! tranwrd(trim(level), "'", "''")!!"'";
12456  end;
12457  else do;
12458  if CALCMETHOD = 'MANUAL' then line = '('!!strip(NAME)!!' ne '!!strip(LEVEL)!!')';
12459  else line = '('!!strip(NAME)!!' ne '!!strip(put(NRAW, best.))!!')';
12460  end;
12461  end;
12462  else do;
12463  if format ne '' or type = 'C' then do;
12464  string = ", '"!! tranwrd(trim(level), "'", "''")!!"'";
12465  end;
12466  else do;
12467  if CALCMETHOD = 'MANUAL' then string = 'and ('!!strip(NAME)!!' ne '!!strip(LEVEL)!!')';
12468  else string = 'and ('!!strip(NAME)!!' ne '!!strip(put(NRAW, best.))!!')';
12469  end;
12470  if length(strip(string)) + length(strip(line)) < 80 then do;
12471  line = strip(line)!!' '!!strip(string);
12472  end;
12473  else do;
12474  put line;
12475  line = string;
12476  end;
12477  end;
12478  if last.name then do;
12479  if (format ne '' or type eq 'C') then do;
12480  line = strip(line)!!')';
12481  end;
12482  put line;
12483  end;
12484  if eof then call symput('_FOBS', '1');
12485  run;

NOTE: The file _X is:
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\CLASSFILTERCODE.txt,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=09May2018:14:47:19,
      Create Time=09May2018:14:47:19

NOTE: 1 record was written to the file _X.
      The minimum record length was 62.
      The maximum record length was 62.
NOTE: There were 3 observations read from the data set WORK._FILTEREXCLUDE.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12486  filename _X;
NOTE: Fileref _X has been deassigned.

12487  %let _FOBS=0;
12488  filename _X "C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\CLASSPUBLISHFILTERCODE.txt";
12489  data _null_;
12490  length line string $200 _filtervar $32;
12491  drop newvarindex string;
12492  retain line '';
12493  set work._FilterExclude end=eof;
12494  where ROLE ne 'TARGET';
12495  file _X;
12496  by NAME;
12497  if first.NAME then do;
12498  _filtervar = NAME;
12499  if newvar ne '' then _filtervar = newvar;
12500  if normvar ne '' then _filtervar = normvar;
12501  if _N_ ne 1 then put ' and ';
12502  if format ne '' or type = 'C' then do;
12503  line = strip(_filtervar)!!" not in ( '"!! tranwrd(trim(level), "'", "''")!!"'";
12504  end;
12505  else do;
12506  if CALCMETHOD = 'MANUAL' then line = '('!!strip(NAME)!!' ne '!!strip(LEVEL)!!')';
12507  else line = '('!!strip(NAME)!!' ne '!!strip(put(NRAW, best.))!!')';
12508  end;
12509  end;
12510  else do;
12511  if format ne '' or type = 'C' then do;
12512  string = ", '"!! tranwrd(trim(level), "'", "''")!!"'";
12513  end;
12514  else do;
12515  if CALCMETHOD = 'MANUAL' then string = 'and ('!!strip(NAME)!!' ne '!!strip(LEVEL)!!')';
12516  else string = 'and ('!!strip(NAME)!!' ne '!!strip(put(NRAW, best.))!!')';
12517  end;
12518  if length(strip(string)) + length(strip(line)) < 80 then do;
12519  line = strip(line)!!' '!!strip(string);
12520  end;
12521  else do;
12522  put line;
12523  line = string;
12524  end;
12525  end;
12526  if last.name then do;
12527  if (format ne '' or type eq 'C') then do;
12528  line = strip(line)!!')';
12529  end;
12530  put line;
12531  end;
12532  if eof then call symput('_FOBS', '1');
12533  run;

NOTE: The file _X is:
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\CLASSPUBLISHFILTERCODE.txt,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=09May2018:14:47:19,
      Create Time=09May2018:14:47:19

NOTE: 1 record was written to the file _X.
      The minimum record length was 62.
      The maximum record length was 62.
NOTE: There were 3 observations read from the data set WORK._FILTEREXCLUDE.
      WHERE ROLE not = 'TARGET';
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12534  filename _X;
NOTE: Fileref _X has been deassigned.

12535  %let _FilterIntervalNum= 0;
12536  proc sort data=EMWS1.Filter2_INTERVAL;
12537  by NAME;
12538  run;

NOTE: There were 9 observations read from the data set EMWS1.FILTER2_INTERVAL.
NOTE: The data set EMWS1.FILTER2_INTERVAL has 9 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12539  filename _X "C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\INTERVALFILTERCODE.txt";
12540  data _null_;
12541  length string $200;
12542  set EMWS1.Filter2_INTERVAL end=eof;
12543  file _X;
12544  where (INTERVALMIN ne . or INTERVALMAX ne . or KEEPMISSING eq 'N')
12545  ;
12546  by NAME;
12547  if _N_ = 1 then do;
12548  string = ' (';
12549  end;
12550  else do;
12551  string = ' and (';
12552  end;
12553  if INTERVALMIN ne . or INTERVALMAX ne . then do;
12554  if KEEPMISSING = 'N' then string = trim(string)!!' '!!strip(NAME)!!' ne . and ';
12555  else string = trim(string)!!' '!!strip(NAME)!!' eq . or ';
12556  if INTERVALMIN ne . and INTERVALMAX ne . then do;
12557  string = trim(string)!!' ('!!strip(put(INTERVALMIN, best12.))!!'<='!!strip(NAME)!!') and ('!!strip(NAME)!!'<='!!strip(put(INTERVALMAX, best12.))!!')';
12558  end;
12559  else if INTERVALMIN eq . and INTERVALMAX ne . then do;
12560  string = trim(string)!!' ('!!strip(NAME)!!'<='!!strip(put(INTERVALMAX, best12.))!!')';
12561  end;
12562  else if INTERVALMIN ne . and INTERVALMAX eq . then do;
12563  string = trim(string)!!' ('!!strip(put(INTERVALMIN, best12.)) || '<=' || NAME||')';
12564  end;
12565  end;
12566  else do;
12567  string = trim(string)!!' '!!strip(name)!!' ne .';
12568  end;
12569  string = trim(string)!!')';
12570  put string;
12571  if eof then call symput('_FilterIntervalNum', strip(put(_N_, best.)));
12572  run;

NOTE: The file _X is:
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\INTERVALFILTERCODE.txt,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=09May2018:14:47:19,
      Create Time=09May2018:14:47:19

NOTE: 9 records were written to the file _X.
      The minimum record length was 54.
      The maximum record length was 95.
NOTE: There were 9 observations read from the data set EMWS1.FILTER2_INTERVAL.
      WHERE (INTERVALMIN not = .) or (INTERVALMAX not = .) or (KEEPMISSING='N');
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12573  %let _FilterIntervalNum= 0;
12574  proc sort data=EMWS1.Filter2_INTERVAL;
12575  by NAME;
12576  run;

NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

12577  filename _X "C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\INTERVALPUBLISHFILTERCODE.txt";
12578  data _null_;
12579  length string $200;
12580  set EMWS1.Filter2_INTERVAL end=eof;
12581  file _X;
12582  where (INTERVALMIN ne . or INTERVALMAX ne . or KEEPMISSING eq 'N')
12583  and ROLE ne 'TARGET';
12584  ;
12585  by NAME;
12586  if _N_ = 1 then do;
12587  string = ' (';
12588  end;
12589  else do;
12590  string = ' and (';
12591  end;
12592  if INTERVALMIN ne . or INTERVALMAX ne . then do;
12593  if KEEPMISSING = 'N' then string = trim(string)!!' '!!strip(NAME)!!' ne . and ';
12594  else string = trim(string)!!' '!!strip(NAME)!!' eq . or ';
12595  if INTERVALMIN ne . and INTERVALMAX ne . then do;
12596  string = trim(string)!!' ('!!strip(put(INTERVALMIN, best12.))!!'<='!!strip(NAME)!!') and ('!!strip(NAME)!!'<='!!strip(put(INTERVALMAX, best12.))!!')';
12597  end;
12598  else if INTERVALMIN eq . and INTERVALMAX ne . then do;
12599  string = trim(string)!!' ('!!strip(NAME)!!'<='!!strip(put(INTERVALMAX, best12.))!!')';
12600  end;
12601  else if INTERVALMIN ne . and INTERVALMAX eq . then do;
12602  string = trim(string)!!' ('!!strip(put(INTERVALMIN, best12.)) || '<=' || NAME||')';
12603  end;
12604  end;
12605  else do;
12606  string = trim(string)!!' '!!strip(name)!!' ne .';
12607  end;
12608  string = trim(string)!!')';
12609  put string;
12610  if eof then call symput('_FilterIntervalNum', strip(put(_N_, best.)));
12611  run;

NOTE: The file _X is:
      Filename=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD9472_DESKTOP-MVTLU7L_\INTERVALPUBLISHFILTERCODE.txt,
      RECFM=V,LRECL=32767,File Size (bytes)=0,
      Last Modified=09May2018:14:47:19,
      Create Time=09May2018:14:47:19

NOTE: 9 records were written to the file _X.
      The minimum record length was 54.
      The maximum record length was 95.
NOTE: There were 9 observations read from the data set EMWS1.FILTER2_INTERVAL.
      WHERE ((INTERVALMIN not = .) or (INTERVALMAX not = .) or (KEEPMISSING='N')) and (ROLE not = 'TARGET');
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this session.
12612  data EMWS1.Filter2_TRAIN / view=EMWS1.Filter2_TRAIN;
12613  set EMWS1.Clus_TRAIN;
12614  if
12615  _SEGMENT_LABEL_ not in ( 'Cluster1' , 'Cluster3' , 'Cluster4')
12616  and
12617  ( AffluenceGrade eq . or (2<=AffluenceGrade) and (AffluenceGrade<=23))
12618  and ( CleanserProducts eq . or (0<=CleanserProducts) and (CleanserProducts<=4))
12619  and ( DayCareProducts eq . or (0<=DayCareProducts) and (DayCareProducts<=3))
12620  and ( LotionProducts eq . or (0<=LotionProducts) and (LotionProducts<=5))
12621  and ( NightRepairProducts eq . or (0<=NightRepairProducts) and (NightRepairProducts<=2))
12622  and ( REP_Age eq . or (22<=REP_Age) and (REP_Age<=79))
12623  and ( REP_LoyaltyTime eq . or (1<=REP_LoyaltyTime) and (REP_LoyaltyTime<=31))
12624  and ( TimeSinceLastPurchase eq . or (1<=TimeSinceLastPurchase) and (TimeSinceLastPurchase<=26))
12625  and ( TotalSpend eq . or (35<=TotalSpend) and (TotalSpend<=19598))
12626  ;
12627  run;

NOTE: DATA STEP view saved on file EMWS1.FILTER2_TRAIN.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS1.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.20 seconds
      cpu time            0.20 seconds
      
NOTE: DATA statement used (Total process time):
      real time           0.21 seconds
      cpu time            0.21 seconds
      

12628  data WORK.Filter2FILTERVAR;
12629  set
12630  EMWS1.Filter2_INTERVAL(where=(INTERVALMIN ne . or INTERVALMAX ne . or KEEPMISSING='N'))
12631  EMWS1.Filter2_CLASS(where=(CALCMETHOD ne 'NONE'))
12632  ;
12633  keep NAME;
12634  run;

NOTE: There were 9 observations read from the data set EMWS1.FILTER2_INTERVAL.
      WHERE (INTERVALMIN not = .) or (INTERVALMAX not = .) or (KEEPMISSING='N');
NOTE: There were 3 observations read from the data set EMWS1.FILTER2_CLASS.
      WHERE CALCMETHOD not = 'NONE';
NOTE: The data set WORK.FILTER2FILTERVAR has 12 observations and 1 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12635  proc sort data= WORK.Filter2FILTERVAR nodupkey;
12636  by NAME;
12637  run;

NOTE: There were 12 observations read from the data set WORK.FILTER2FILTERVAR.
NOTE: 2 observations with duplicate key values were deleted.
NOTE: The data set WORK.FILTER2FILTERVAR has 10 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12638  proc sort data=WORK.M072RK2E;
12639  by NAME;
12640  run;

NOTE: There were 29 observations read from the data set WORK.M072RK2E.
NOTE: The data set WORK.M072RK2E has 29 observations and 26 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12641  data WORK.Filter2DMDBC;
12642  merge WORK.M072RK2E WORK.Filter2FILTERVAR(in=_b);
12643  by NAME;
12644  if (REPORT = 'Y' or ROLE in('FREQ','TARGET') or _b) then output;
12645  run;

NOTE: There were 29 observations read from the data set WORK.M072RK2E.
NOTE: There were 10 observations read from the data set WORK.FILTER2FILTERVAR.
NOTE: The data set WORK.FILTER2DMDBC has 11 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

12646  *------------------------------------------------------------* ;
12647  * Filter2: DMDBClass Macro ;
12648  *------------------------------------------------------------* ;
12649  %macro DMDBClass;
12650      TargetBuy(DESC) _SEGMENT_LABEL_(ASC)
12651  %mend DMDBClass;
12652  *------------------------------------------------------------* ;
12653  * Filter2: DMDBVar Macro ;
12654  *------------------------------------------------------------* ;
12655  %macro DMDBVar;
12656      AffluenceGrade CleanserProducts DayCareProducts LotionProducts
12657     NightRepairProducts REP_Age REP_LoyaltyTime TimeSinceLastPurchase TotalSpend
12658  %mend DMDBVar;
12659  *------------------------------------------------------------*;
12660  * Filter2: Create DMDB;
12661  *------------------------------------------------------------*;
12662  proc dmdb batch data=EMWS1.Clus_TRAIN
12663  dmdbcat=WORK.Filter2_DMDB
12664  varout=WORK.FILTER_VARSTATS
12665  maxlevel = 513
12666  ;
12667  class %DMDBClass;
12668  var %DMDBVar;
12669  target
12670  TargetBuy
12671  ;
12672  run;

NOTE: Records processed = 4224   Memory used = 511K.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS1.IDS2_DATA.
NOTE: There were 23000 observations read from the data set EMWS1.REPL_TRAIN.
NOTE: View EMWS1.CLUS_TRAIN.VIEW used (Total process time):
      real time           0.36 seconds
      cpu time            0.32 seconds
      
NOTE: There were 4224 observations read from the data set EMWS1.FILTER_TRAIN.
NOTE: There were 4224 observations read from the data set EMWS1.CLUS_TRAIN.
NOTE: The data set WORK.FILTER_VARSTATS has 9 observations and 9 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.37 seconds
      cpu time            0.34 seconds
      

12673  quit;
12674  *--- end code ---*;

12675  data WORK.FILTER_VARSTATS;
12676  length DATAROLE $10 TYPE $8 NAME $32;
12677  label DATAROLE = "%sysfunc(sasmsg(sashelp.dmine, rpt_datarole_vlabel, NOQUOTE))";
12678  label N = "%sysfunc(sasmsg(sashelp.dmine, rpt_nonMiss_vlabel, NOQUOTE))";
12679  label NMISS = "%sysfunc(sasmsg(sashelp.dmine, rpt_missing_vlabel, NOQUOTE))";
12680  label MIN = "%sysfunc(sasmsg(sashelp.dmine, rpt_minimum_vlabel, NOQUOTE))";
12681  label MAX = "%sysfunc(sasmsg(sashelp.dmine, rpt_maximum_vlabel, NOQUOTE))";
12682  label MEAN = "%sysfunc(sasmsg(sashelp.dmine, rpt_mean_vlabel,    NOQUOTE))";
12683  label STD = "%sysfunc(sasmsg(sashelp.dmine, rpt_std_vlabel,     NOQUOTE))";
12684  label SKEWNESS = "%sysfunc(sasmsg(sashelp.dmine, rpt_skewness_vlabel, NOQUOTE))";
12685  label KURTOSIS = "%sysfunc(sasmsg(sashelp.dmine, rpt_kurtosis_vlabel, NOQUOTE))";
12686  label NUMCAT = "%sysfunc(sasmsg(sashelp.dmine, rpt_numcat_vlabel,   NOQUOTE))";
12687  retain DATAROLE "TRAIN" type "ORIGINAL";
12688  set WORK.FILTER_VARSTATS;
12689  run;

NOTE: Variable NUMCAT is uninitialized.
NOTE: There were 9 observations read from the data set WORK.FILTER_VARSTATS.
NOTE: The data set WORK.FILTER_VARSTATS has 9 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
      

12690  proc append base=EMWS1.Filter2_STATS data=WORK.FILTER_VARSTATS;
12691  run;

NOTE: Appending WORK.FILTER_VARSTATS to EMWS1.FILTER2_STATS.
NOTE: BASE data set does not exist. DATA file is being copied to BASE file.
NOTE: There were 9 observations read from the data set WORK.FILTER_VARSTATS.
NOTE: The data set EMWS1.FILTER2_STATS has 9 observations and 11 variables.
NOTE: PROCEDURE APPEND used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
      

