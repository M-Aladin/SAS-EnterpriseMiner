*****************************************;
*** Begin Scoring Code from PROC DMVQ ***;
*****************************************;


*** Begin Class Look-up, Standardization, Replacement ;
drop _dm_bad; _dm_bad = 0;

*** Standardize AffluenceGrade ;
drop T_AffluenceGrade ;
if missing( AffluenceGrade ) then T_AffluenceGrade = .;
else T_AffluenceGrade = (AffluenceGrade
         - 9.03835227272727) * 0.27836915260968;

*** Standardize CleanserProducts ;
drop T_CleanserProducts ;
if missing( CleanserProducts ) then T_CleanserProducts = .;
else T_CleanserProducts = (CleanserProducts
         - 1.94436553030303) * 0.73206471377194;

*** Standardize DayCareProducts ;
drop T_DayCareProducts ;
if missing( DayCareProducts ) then T_DayCareProducts = .;
else T_DayCareProducts = (DayCareProducts
         - 1.50757575757575) * 0.91106074785492;

*** Standardize LotionProducts ;
drop T_LotionProducts ;
if missing( LotionProducts ) then T_LotionProducts = .;
else T_LotionProducts = (LotionProducts
         - 2.19720643939393) * 0.63211951769076;

*** Standardize NightRepairProducts ;
drop T_NightRepairProducts ;
if missing( NightRepairProducts ) then T_NightRepairProducts = .;
else T_NightRepairProducts = (NightRepairProducts
         - 0.98910984848484) * 1.22167521817256;

*** Standardize REP_Age ;
drop T_REP_Age ;
if missing( REP_Age ) then T_REP_Age = .;
else T_REP_Age = (REP_Age - 54.3913352272727) * 0.07234951721046;

*** Standardize REP_LoyaltyTime ;
drop T_REP_LoyaltyTime ;
if missing( REP_LoyaltyTime ) then T_REP_LoyaltyTime = .;
else T_REP_LoyaltyTime = (REP_LoyaltyTime
         - 6.47821969696969) * 0.19467643306381;

*** Standardize TimeSinceLastPurchase ;
drop T_TimeSinceLastPurchase ;
if missing( TimeSinceLastPurchase ) then T_TimeSinceLastPurchase = .;
else T_TimeSinceLastPurchase = (TimeSinceLastPurchase
         - 3.75236742424242) * 0.24727221489258;

*** Standardize TotalSpend ;
drop T_TotalSpend ;
if missing( TotalSpend ) then T_TotalSpend = .;
else T_TotalSpend = (TotalSpend - 4581.20265151515) * 0.00023121339648;

*** Generate dummy variables for CampaignViewedEmail ;
drop CampaignViewedEmail0 CampaignViewedEmail1 ;
if missing( CampaignViewedEmail ) then do;
   CampaignViewedEmail0 = .;
   CampaignViewedEmail1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( CampaignViewedEmail , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      CampaignViewedEmail0 = 0.68008515554777;
      CampaignViewedEmail1 = -0.68008515554777;
   end;
   else if _dm12 = '1'  then do;
      CampaignViewedEmail0 = -0.7350279957004;
      CampaignViewedEmail1 = 0.7350279957004;
   end;
   else do;
      CampaignViewedEmail0 = .;
      CampaignViewedEmail1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for LoyaltyClass ;
drop LoyaltyClassGold LoyaltyClassPlatinum ;
if missing( LoyaltyClass ) then do;
   LoyaltyClassGold = .;
   LoyaltyClassPlatinum = .;
end;
else do;
   length _dm8 $ 8; drop _dm8 ;
   _dm8 = put( LoyaltyClass , $CHAR8. );
   %DMNORMIP( _dm8 )
   if _dm8 = 'GOLD'  then do;
      LoyaltyClassGold = 0.54076433269938;
      LoyaltyClassPlatinum = -0.54076433269938;
   end;
   else if _dm8 = 'PLATINUM'  then do;
      LoyaltyClassGold = -0.92439829803968;
      LoyaltyClassPlatinum = 0.92439829803968;
   end;
   else do;
      LoyaltyClassGold = .;
      LoyaltyClassPlatinum = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for MobileApplications ;
drop MobileApplications0 MobileApplications1 ;
if missing( MobileApplications ) then do;
   MobileApplications0 = .;
   MobileApplications1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( MobileApplications , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      MobileApplications0 = 0.66318605646449;
      MobileApplications1 = -0.66318605646449;
   end;
   else if _dm12 = '1'  then do;
      MobileApplications0 = -0.75375774854614;
      MobileApplications1 = 0.75375774854614;
   end;
   else do;
      MobileApplications0 = .;
      MobileApplications1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for PreviousCampaign ;
drop PreviousCampaign0 PreviousCampaign1 ;
if missing( PreviousCampaign ) then do;
   PreviousCampaign0 = .;
   PreviousCampaign1 = .;
end;
else do;
   length _dm12 $ 12; drop _dm12 ;
   _dm12 = put( PreviousCampaign , BEST12. );
   %DMNORMIP( _dm12 )
   if _dm12 = '0'  then do;
      PreviousCampaign0 = 0.68851832626536;
      PreviousCampaign1 = -0.68851832626536;
   end;
   else if _dm12 = '1'  then do;
      PreviousCampaign0 = -0.7260251611592;
      PreviousCampaign1 = 0.7260251611592;
   end;
   else do;
      PreviousCampaign0 = .;
      PreviousCampaign1 = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for REP_AdvertisementZone ;
drop REP_AdvertisementZBorder REP_AdvertisementZCentral_Z1
        REP_AdvertisementZE_Central REP_AdvertisementZN_Central
        REP_AdvertisementZN_East REP_AdvertisementZN_West
        REP_AdvertisementZNE_Z1 REP_AdvertisementZNE_Z2
        REP_AdvertisementZNE_Z3 REP_AdvertisementZS_Central
        REP_AdvertisementZS_East REP_AdvertisementZS_West REP_AdvertisementZU
        REP_AdvertisementZW_Central ;
if missing( REP_AdvertisementZone ) then do;
   REP_AdvertisementZBorder = .;
   REP_AdvertisementZCentral_Z1 = .;
   REP_AdvertisementZE_Central = .;
   REP_AdvertisementZN_Central = .;
   REP_AdvertisementZN_East = .;
   REP_AdvertisementZN_West = .;
   REP_AdvertisementZNE_Z1 = .;
   REP_AdvertisementZNE_Z2 = .;
   REP_AdvertisementZNE_Z3 = .;
   REP_AdvertisementZS_Central = .;
   REP_AdvertisementZS_East = .;
   REP_AdvertisementZS_West = .;
   REP_AdvertisementZU = .;
   REP_AdvertisementZW_Central = .;
end;
else do;
   length _dm10 $ 10; drop _dm10 ;
   _dm10 = put( REP_AdvertisementZone , $CHAR10. );
   %DMNORMIP( _dm10 )
   if _dm10 = 'E CENTRAL'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = 0.42570006742652;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'S CENTRAL'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = 0.65867500033727;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'S EAST'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = 0.77874094275281;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'N WEST'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = 0.84505420687321;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'W CENTRAL'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = 0.92405258324735;
   end;
   else if _dm10 = 'CENTRAL Z1'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = 0.98242645067612;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'NE Z3'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = 1.06999541216893;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'NE Z1'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = 1.3089909533382;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'N EAST'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = 1.32125470072332;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'S WEST'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = 1.49963929298823;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'U'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = 1.61920601983285;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'NE Z2'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = 2.20761255883793;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'N CENTRAL'  then do;
      REP_AdvertisementZBorder = -0.0274171788743;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = 2.2848562949602;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else if _dm10 = 'BORDER'  then do;
      REP_AdvertisementZBorder = 2.60463199305853;
      REP_AdvertisementZCentral_Z1 = -0.07268906614461;
      REP_AdvertisementZE_Central = -0.16775111567896;
      REP_AdvertisementZN_Central = -0.03125433376835;
      REP_AdvertisementZN_East = -0.05404836873338;
      REP_AdvertisementZN_West = -0.08450542068732;
      REP_AdvertisementZNE_Z1 = -0.05455474010213;
      REP_AdvertisementZNE_Z2 = -0.03234791402572;
      REP_AdvertisementZNE_Z3 = -0.06674015649343;
      REP_AdvertisementZS_Central = -0.10841714232185;
      REP_AdvertisementZS_East = -0.09170143411616;
      REP_AdvertisementZS_West = -0.04761922522923;
      REP_AdvertisementZU = -0.04410288769972;
      REP_AdvertisementZW_Central = -0.07728094975337;
   end;
   else do;
      REP_AdvertisementZBorder = .;
      REP_AdvertisementZCentral_Z1 = .;
      REP_AdvertisementZE_Central = .;
      REP_AdvertisementZN_Central = .;
      REP_AdvertisementZN_East = .;
      REP_AdvertisementZN_West = .;
      REP_AdvertisementZNE_Z1 = .;
      REP_AdvertisementZNE_Z2 = .;
      REP_AdvertisementZNE_Z3 = .;
      REP_AdvertisementZS_Central = .;
      REP_AdvertisementZS_East = .;
      REP_AdvertisementZS_West = .;
      REP_AdvertisementZU = .;
      REP_AdvertisementZW_Central = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for REP_ClusterGroup ;
drop REP_ClusterGroupA REP_ClusterGroupB REP_ClusterGroupC REP_ClusterGroupD
        REP_ClusterGroupE REP_ClusterGroupF REP_ClusterGroupU ;
if missing( REP_ClusterGroup ) then do;
   REP_ClusterGroupA = .;
   REP_ClusterGroupB = .;
   REP_ClusterGroupC = .;
   REP_ClusterGroupD = .;
   REP_ClusterGroupE = .;
   REP_ClusterGroupF = .;
   REP_ClusterGroupU = .;
end;
else do;
   length _dm1 $ 1; drop _dm1 ;
   _dm1 = put( REP_ClusterGroup , $CHAR1. );
   %DMNORMIP( _dm1 )
   _dm_find = 0; drop _dm_find;
   if _dm1 <= 'D'  then do;
      if _dm1 <= 'B'  then do;
         if _dm1 = 'A'  then do;
            REP_ClusterGroupA = 1.21790136057129;
            REP_ClusterGroupB = -0.19247647796288;
            REP_ClusterGroupC = -0.19414697836541;
            REP_ClusterGroupD = -0.17956915040603;
            REP_ClusterGroupE = -0.13926185180672;
            REP_ClusterGroupF = -0.16539650694354;
            REP_ClusterGroupU = -0.06971254464606;
            _dm_find = 1;
         end;
         else do;
            if _dm1 = 'B'  then do;
               REP_ClusterGroupA = -0.11727002459692;
               REP_ClusterGroupB = 0.74203000814657;
               REP_ClusterGroupC = -0.19414697836541;
               REP_ClusterGroupD = -0.17956915040603;
               REP_ClusterGroupE = -0.13926185180672;
               REP_ClusterGroupF = -0.16539650694354;
               REP_ClusterGroupU = -0.06971254464606;
               _dm_find = 1;
            end;
         end;
      end;
      else do;
         if _dm1 = 'C'  then do;
            REP_ClusterGroupA = -0.11727002459692;
            REP_ClusterGroupB = -0.19247647796288;
            REP_ClusterGroupC = 0.73564535339821;
            REP_ClusterGroupD = -0.17956915040603;
            REP_ClusterGroupE = -0.13926185180672;
            REP_ClusterGroupF = -0.16539650694354;
            REP_ClusterGroupU = -0.06971254464606;
            _dm_find = 1;
         end;
         else do;
            if _dm1 = 'D'  then do;
               REP_ClusterGroupA = -0.11727002459692;
               REP_ClusterGroupB = -0.19247647796288;
               REP_ClusterGroupC = -0.19414697836541;
               REP_ClusterGroupD = 0.79536669961336;
               REP_ClusterGroupE = -0.13926185180672;
               REP_ClusterGroupF = -0.16539650694354;
               REP_ClusterGroupU = -0.06971254464606;
               _dm_find = 1;
            end;
         end;
      end;
   end;
   else do;
      if _dm1 <= 'F'  then do;
         if _dm1 = 'E'  then do;
            REP_ClusterGroupA = -0.11727002459692;
            REP_ClusterGroupB = -0.19247647796288;
            REP_ClusterGroupC = -0.19414697836541;
            REP_ClusterGroupD = -0.17956915040603;
            REP_ClusterGroupE = 1.02557391459249;
            REP_ClusterGroupF = -0.16539650694354;
            REP_ClusterGroupU = -0.06971254464606;
            _dm_find = 1;
         end;
         else do;
            if _dm1 = 'F'  then do;
               REP_ClusterGroupA = -0.11727002459692;
               REP_ClusterGroupB = -0.19247647796288;
               REP_ClusterGroupC = -0.19414697836541;
               REP_ClusterGroupD = -0.17956915040603;
               REP_ClusterGroupE = -0.13926185180672;
               REP_ClusterGroupF = 0.86352079103807;
               REP_ClusterGroupU = -0.06971254464606;
               _dm_find = 1;
            end;
         end;
      end;
      else do;
         if _dm1 = 'U'  then do;
            REP_ClusterGroupA = -0.11727002459692;
            REP_ClusterGroupB = -0.19247647796288;
            REP_ClusterGroupC = -0.19414697836541;
            REP_ClusterGroupD = -0.17956915040603;
            REP_ClusterGroupE = -0.13926185180672;
            REP_ClusterGroupF = -0.16539650694354;
            REP_ClusterGroupU = 2.04874636603715;
            _dm_find = 1;
         end;
      end;
   end;
   if not _dm_find then do;
      REP_ClusterGroupA = .;
      REP_ClusterGroupB = .;
      REP_ClusterGroupC = .;
      REP_ClusterGroupD = .;
      REP_ClusterGroupE = .;
      REP_ClusterGroupF = .;
      REP_ClusterGroupU = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for REP_Gender ;
drop REP_GenderF REP_GenderM ;
if missing( REP_Gender ) then do;
   REP_GenderF = .;
   REP_GenderM = .;
end;
else do;
   length _dm1 $ 1; drop _dm1 ;
   _dm1 = put( REP_Gender , $CHAR1. );
   %DMNORMIP( _dm1 )
   if _dm1 = 'F'  then do;
      REP_GenderF = 0.4748373236048;
      REP_GenderM = -0.4748373236048;
   end;
   else if _dm1 = 'M'  then do;
      REP_GenderF = -1.05274291623274;
      REP_GenderM = 1.05274291623274;
   end;
   else do;
      REP_GenderF = .;
      REP_GenderM = .;
      _DM_BAD = 1;
   end;
end;

*** Generate dummy variables for REP_Region ;
drop REP_RegionCentral REP_RegionNorth REP_RegionNorthEast
        REP_RegionSouth_East REP_RegionSouth_West REP_RegionU ;
if missing( REP_Region ) then do;
   REP_RegionCentral = .;
   REP_RegionNorth = .;
   REP_RegionNorthEast = .;
   REP_RegionSouth_East = .;
   REP_RegionSouth_West = .;
   REP_RegionU = .;
end;
else do;
   length _dm10 $ 10; drop _dm10 ;
   _dm10 = put( REP_Region , $CHAR10. );
   %DMNORMIP( _dm10 )
   _dm_find = 0; drop _dm_find;
   if _dm10 <= 'NORTHEAST'  then do;
      if _dm10 <= 'NORTH'  then do;
         if _dm10 = 'CENTRAL'  then do;
            REP_RegionCentral = 0.62220272521442;
            REP_RegionNorth = -0.19700657787813;
            REP_RegionNorthEast = -0.10751020608518;
            REP_RegionSouth_East = -0.32503652318377;
            REP_RegionSouth_West = -0.07273956804936;
            REP_RegionU = -0.06736827375004;
            _dm_find = 1;
         end;
         else do;
            if _dm10 = 'NORTH'  then do;
               REP_RegionCentral = -0.26780212114714;
               REP_RegionNorth = 0.84579515765727;
               REP_RegionNorthEast = -0.10751020608518;
               REP_RegionSouth_East = -0.32503652318377;
               REP_RegionSouth_West = -0.07273956804936;
               REP_RegionU = -0.06736827375004;
               _dm_find = 1;
            end;
         end;
      end;
      else do;
         if _dm10 = 'NORTHEAST'  then do;
            REP_RegionCentral = -0.26780212114714;
            REP_RegionNorth = -0.19700657787813;
            REP_RegionNorthEast = 1.54987340889228;
            REP_RegionSouth_East = -0.32503652318377;
            REP_RegionSouth_West = -0.07273956804936;
            REP_RegionU = -0.06736827375004;
            _dm_find = 1;
         end;
      end;
   end;
   else do;
      if _dm10 <= 'SOUTH WEST'  then do;
         if _dm10 = 'SOUTH EAST'  then do;
            REP_RegionCentral = -0.26780212114714;
            REP_RegionNorth = -0.19700657787813;
            REP_RegionNorthEast = -0.10751020608518;
            REP_RegionSouth_East = 0.51264149629655;
            REP_RegionSouth_West = -0.07273956804936;
            REP_RegionU = -0.06736827375004;
            _dm_find = 1;
         end;
         else do;
            if _dm10 = 'SOUTH WEST'  then do;
               REP_RegionCentral = -0.26780212114714;
               REP_RegionNorth = -0.19700657787813;
               REP_RegionNorthEast = -0.10751020608518;
               REP_RegionSouth_East = -0.32503652318377;
               REP_RegionSouth_West = 2.29073685841621;
               REP_RegionU = -0.06736827375004;
               _dm_find = 1;
            end;
         end;
      end;
      else do;
         if _dm10 = 'U'  then do;
            REP_RegionCentral = -0.26780212114714;
            REP_RegionNorth = -0.19700657787813;
            REP_RegionNorthEast = -0.10751020608518;
            REP_RegionSouth_East = -0.32503652318377;
            REP_RegionSouth_West = -0.07273956804936;
            REP_RegionU = 2.4733780505374;
            _dm_find = 1;
         end;
      end;
   end;
   if not _dm_find then do;
      REP_RegionCentral = .;
      REP_RegionNorth = .;
      REP_RegionNorthEast = .;
      REP_RegionSouth_East = .;
      REP_RegionSouth_West = .;
      REP_RegionU = .;
      _DM_BAD = 1;
   end;
end;

*** End Class Look-up, Standardization, Replacement ;


*** Omitted Cases;
if _dm_bad then do;
   _SEGMENT_ = .; Distance = .;
   goto CLUS3vlex ;
end; *** omitted;

*** Compute Distances and Cluster Membership;
label _SEGMENT_ = 'Segment Id' ;
label Distance = 'Distance' ;
array CLUS3vads [4] _temporary_;
drop _vqclus _vqmvar _vqnvar;
_vqmvar = 0;
do _vqclus = 1 to 4; CLUS3vads [_vqclus] = 0; end;
if not missing( T_AffluenceGrade ) then do;
   CLUS3vads [1] + ( T_AffluenceGrade - -0.20012176296356 )**2;
   CLUS3vads [2] + ( T_AffluenceGrade - -0.09412679896114 )**2;
   CLUS3vads [3] + ( T_AffluenceGrade - -0.37287337742821 )**2;
   CLUS3vads [4] + ( T_AffluenceGrade - 0.64841108694542 )**2;
end;
else _vqmvar + 1;
if not missing( T_CleanserProducts ) then do;
   CLUS3vads [1] + ( T_CleanserProducts - 0.06106316307267 )**2;
   CLUS3vads [2] + ( T_CleanserProducts - 0.05809549119601 )**2;
   CLUS3vads [3] + ( T_CleanserProducts - 0.00144890597644 )**2;
   CLUS3vads [4] + ( T_CleanserProducts - -0.08540034661477 )**2;
end;
else _vqmvar + 1;
if not missing( T_DayCareProducts ) then do;
   CLUS3vads [1] + ( T_DayCareProducts - -0.01111984919519 )**2;
   CLUS3vads [2] + ( T_DayCareProducts - 0.00521493609347 )**2;
   CLUS3vads [3] + ( T_DayCareProducts - -0.11719470841942 )**2;
   CLUS3vads [4] + ( T_DayCareProducts - 0.15087497475443 )**2;
end;
else _vqmvar + 1;
if not missing( T_LotionProducts ) then do;
   CLUS3vads [1] + ( T_LotionProducts - 0.10653382128169 )**2;
   CLUS3vads [2] + ( T_LotionProducts - 0.02712335454034 )**2;
   CLUS3vads [3] + ( T_LotionProducts - 0.06569854243094 )**2;
   CLUS3vads [4] + ( T_LotionProducts - -0.14093820455328 )**2;
end;
else _vqmvar + 1;
if not missing( T_NightRepairProducts ) then do;
   CLUS3vads [1] + ( T_NightRepairProducts - -0.082846136165 )**2;
   CLUS3vads [2] + ( T_NightRepairProducts - -0.00777428020899 )**2;
   CLUS3vads [3] + ( T_NightRepairProducts - -0.13172361457296 )**2;
   CLUS3vads [4] + ( T_NightRepairProducts - 0.19991891519594 )**2;
end;
else _vqmvar + 1;
if not missing( T_REP_Age ) then do;
   CLUS3vads [1] + ( T_REP_Age - 0.91089100310111 )**2;
   CLUS3vads [2] + ( T_REP_Age - 0.32074359853873 )**2;
   CLUS3vads [3] + ( T_REP_Age - 0.20916430672025 )**2;
   CLUS3vads [4] + ( T_REP_Age - -0.84793142411823 )**2;
end;
else _vqmvar + 1;
if not missing( T_REP_LoyaltyTime ) then do;
   CLUS3vads [1] + ( T_REP_LoyaltyTime - 3.17043598834002 )**2;
   CLUS3vads [2] + ( T_REP_LoyaltyTime - -0.22829395985182 )**2;
   CLUS3vads [3] + ( T_REP_LoyaltyTime - -0.03643172524965 )**2;
   CLUS3vads [4] + ( T_REP_LoyaltyTime - -0.277919691812 )**2;
end;
else _vqmvar + 1;
if not missing( T_TimeSinceLastPurchase ) then do;
   CLUS3vads [1] + ( T_TimeSinceLastPurchase - 3.49556897343964 )**2;
   CLUS3vads [2] + ( T_TimeSinceLastPurchase - -0.21448208592077 )**2;
   CLUS3vads [3] + ( T_TimeSinceLastPurchase - -0.10925415665879 )**2;
   CLUS3vads [4] + ( T_TimeSinceLastPurchase - -0.26092395130453 )**2;
end;
else _vqmvar + 1;
if not missing( T_TotalSpend ) then do;
   CLUS3vads [1] + ( T_TotalSpend - 0.29763932180093 )**2;
   CLUS3vads [2] + ( T_TotalSpend - 1.0738241797964 )**2;
   CLUS3vads [3] + ( T_TotalSpend - -0.56818810432599 )**2;
   CLUS3vads [4] + ( T_TotalSpend - -0.63127092722535 )**2;
end;
else _vqmvar + 1;
if not missing( CampaignViewedEmail0 ) then do;
   CLUS3vads [1] + ( CampaignViewedEmail0 - 0.01183727856946 )**2;
   CLUS3vads [2] + ( CampaignViewedEmail0 - -0.02085874179945 )**2;
   CLUS3vads [3] + ( CampaignViewedEmail0 - 0.05462602297061 )**2;
   CLUS3vads [4] + ( CampaignViewedEmail0 - -0.04883636108095 )**2;
end;
else _vqmvar + 0.5;
if not missing( CampaignViewedEmail1 ) then do;
   CLUS3vads [1] + ( CampaignViewedEmail1 - -0.01183727856946 )**2;
   CLUS3vads [2] + ( CampaignViewedEmail1 - 0.02085874179945 )**2;
   CLUS3vads [3] + ( CampaignViewedEmail1 - -0.05462602297061 )**2;
   CLUS3vads [4] + ( CampaignViewedEmail1 - 0.04883636108095 )**2;
end;
else _vqmvar + 0.5;
if not missing( LoyaltyClassGold ) then do;
   CLUS3vads [1] + ( LoyaltyClassGold - -0.16468434136016 )**2;
   CLUS3vads [2] + ( LoyaltyClassGold - -0.9243982980397 )**2;
   CLUS3vads [3] + ( LoyaltyClassGold - 0.54076433269938 )**2;
   CLUS3vads [4] + ( LoyaltyClassGold - 0.45748688299485 )**2;
end;
else _vqmvar + 0.5;
if not missing( LoyaltyClassPlatinum ) then do;
   CLUS3vads [1] + ( LoyaltyClassPlatinum - 0.16468434136016 )**2;
   CLUS3vads [2] + ( LoyaltyClassPlatinum - 0.9243982980397 )**2;
   CLUS3vads [3] + ( LoyaltyClassPlatinum - -0.54076433269938 )**2;
   CLUS3vads [4] + ( LoyaltyClassPlatinum - -0.45748688299485 )**2;
end;
else _vqmvar + 0.5;
if not missing( MobileApplications0 ) then do;
   CLUS3vads [1] + ( MobileApplications0 - 0.19743137981748 )**2;
   CLUS3vads [2] + ( MobileApplications0 - 0.10802115802394 )**2;
   CLUS3vads [3] + ( MobileApplications0 - 0.13860323931769 )**2;
   CLUS3vads [4] + ( MobileApplications0 - -0.35484905743746 )**2;
end;
else _vqmvar + 0.49999999999999;
if not missing( MobileApplications1 ) then do;
   CLUS3vads [1] + ( MobileApplications1 - -0.19743137981748 )**2;
   CLUS3vads [2] + ( MobileApplications1 - -0.10802115802394 )**2;
   CLUS3vads [3] + ( MobileApplications1 - -0.13860323931769 )**2;
   CLUS3vads [4] + ( MobileApplications1 - 0.35484905743746 )**2;
end;
else _vqmvar + 0.49999999999999;
if not missing( PreviousCampaign0 ) then do;
   CLUS3vads [1] + ( PreviousCampaign0 - 0.0074418323202 )**2;
   CLUS3vads [2] + ( PreviousCampaign0 - 0.02853362221177 )**2;
   CLUS3vads [3] + ( PreviousCampaign0 - 0.07279818988807 )**2;
   CLUS3vads [4] + ( PreviousCampaign0 - -0.13307265133291 )**2;
end;
else _vqmvar + 0.5;
if not missing( PreviousCampaign1 ) then do;
   CLUS3vads [1] + ( PreviousCampaign1 - -0.0074418323202 )**2;
   CLUS3vads [2] + ( PreviousCampaign1 - -0.02853362221177 )**2;
   CLUS3vads [3] + ( PreviousCampaign1 - -0.07279818988807 )**2;
   CLUS3vads [4] + ( PreviousCampaign1 - 0.13307265133291 )**2;
end;
else _vqmvar + 0.5;
if not missing( REP_AdvertisementZBorder ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZBorder - 0.00913905962476 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZBorder - 0.00475020856125 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZBorder - -0.00270310214253 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZBorder - -0.00404196420349 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZCentral_Z1 ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZCentral_Z1 - -0.02384112555105 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZCentral_Z1 - 0.00012983365035 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZCentral_Z1 - -0.00546171933175 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZCentral_Z1 - 0.01164521139878 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZE_Central ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZE_Central - -0.01114594235946 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZE_Central - 0.00375670287488 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZE_Central - -0.00894023569299 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZE_Central - 0.00933556062959 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZN_Central ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZN_Central - 0.00091386940843 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZN_Central - 0.00204704119539 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZN_Central - -0.00640002789333 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZN_Central - 0.00577052530545 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZN_East ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZN_East - 0.01599021350746 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZN_East - -0.00065773914987 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZN_East - 0.00498543169936 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZN_East - -0.00885634957716 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZN_West ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZN_West - -0.00273860159634 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZN_West - -0.00965949812313 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZN_West - 0.00153027924785 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZN_West - 0.01043184145251 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZNE_Z1 ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZNE_Z1 - 0.06538677922826 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZNE_Z1 - 0.00132024517902 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZNE_Z1 - -0.00059820360784 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZNE_Z1 - -0.01338195717409 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZNE_Z2 ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZNE_Z2 - 0.04024339759485 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZNE_Z2 - -0.00497240860611 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZNE_Z2 - 0.00370778775074 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZNE_Z2 - -0.00648691389497 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZNE_Z3 ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZNE_Z3 - -0.00358818045663 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZNE_Z3 - -0.0013635601649 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZNE_Z3 - 0.00645006120716 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZNE_Z3 - -0.00616810132492 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZS_Central ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZS_Central - 0.00522613807209 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZS_Central - -0.00198379686303 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZS_Central - -0.00037599546845 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZS_Central - 0.00194602562733 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZS_East ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZS_East - -0.00707509192057 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZS_East - -0.00096516909388 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZS_East - 0.0028737939541 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZS_East - -0.00125582302054 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZS_West ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZS_West - -0.01180305582604 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZS_West - 0.00132353163746 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZS_West - 0.01879562733007 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZS_West - -0.02425919431475 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZU ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZU - -0.0210013750951 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZU - 0.01448958999193 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZU - -0.00952034166786 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZU - -0.00126455882011 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_AdvertisementZW_Central ) then do;
   CLUS3vads [1] + ( REP_AdvertisementZW_Central - -0.01237970224406 )**2;
   CLUS3vads [2] + ( REP_AdvertisementZW_Central - -0.00169502526373 )**2;
   CLUS3vads [3] + ( REP_AdvertisementZW_Central - 0.00263768903072 )**2;
   CLUS3vads [4] + ( REP_AdvertisementZW_Central - 0.00097602263034 )**2;
end;
else _vqmvar + 0.07142857142857;
if not missing( REP_ClusterGroupA ) then do;
   CLUS3vads [1] + ( REP_ClusterGroupA - 0.06198909655991 )**2;
   CLUS3vads [2] + ( REP_ClusterGroupA - 0.02095044949669 )**2;
   CLUS3vads [3] + ( REP_ClusterGroupA - -0.00622961429453 )**2;
   CLUS3vads [4] + ( REP_ClusterGroupA - -0.02952341491446 )**2;
end;
else _vqmvar + 0.14285714285714;
if not missing( REP_ClusterGroupB ) then do;
   CLUS3vads [1] + ( REP_ClusterGroupB - -0.00211404560725 )**2;
   CLUS3vads [2] + ( REP_ClusterGroupB - 0.02922527646998 )**2;
   CLUS3vads [3] + ( REP_ClusterGroupB - 0.00119388032539 )**2;
   CLUS3vads [4] + ( REP_ClusterGroupB - -0.03727868675287 )**2;
end;
else _vqmvar + 0.14285714285714;
if not missing( REP_ClusterGroupC ) then do;
   CLUS3vads [1] + ( REP_ClusterGroupC - 0.02538732218988 )**2;
   CLUS3vads [2] + ( REP_ClusterGroupC - 0.0110624003919 )**2;
   CLUS3vads [3] + ( REP_ClusterGroupC - -0.01267845486225 )**2;
   CLUS3vads [4] + ( REP_ClusterGroupC - -0.00174767703244 )**2;
end;
else _vqmvar + 0.14285714285714;
if not missing( REP_ClusterGroupD ) then do;
   CLUS3vads [1] + ( REP_ClusterGroupD - -0.02610702586594 )**2;
   CLUS3vads [2] + ( REP_ClusterGroupD - -0.02116835809519 )**2;
   CLUS3vads [3] + ( REP_ClusterGroupD - 0.01397948246166 )**2;
   CLUS3vads [4] + ( REP_ClusterGroupD - 0.01264733156937 )**2;
end;
else _vqmvar + 0.14285714285714;
if not missing( REP_ClusterGroupE ) then do;
   CLUS3vads [1] + ( REP_ClusterGroupE - 0.01173537717095 )**2;
   CLUS3vads [2] + ( REP_ClusterGroupE - -0.00695124714024 )**2;
   CLUS3vads [3] + ( REP_ClusterGroupE - 0.00526840760565 )**2;
   CLUS3vads [4] + ( REP_ClusterGroupE - -0.00064018866507 )**2;
end;
else _vqmvar + 0.14285714285714;
if not missing( REP_ClusterGroupF ) then do;
   CLUS3vads [1] + ( REP_ClusterGroupF - -0.05107236272336 )**2;
   CLUS3vads [2] + ( REP_ClusterGroupF - -0.02633363705098 )**2;
   CLUS3vads [3] + ( REP_ClusterGroupF - 0.00298432518758 )**2;
   CLUS3vads [4] + ( REP_ClusterGroupF - 0.03837663466383 )**2;
end;
else _vqmvar + 0.14285714285714;
if not missing( REP_ClusterGroupU ) then do;
   CLUS3vads [1] + ( REP_ClusterGroupU - -0.01086646379375 )**2;
   CLUS3vads [2] + ( REP_ClusterGroupU - -0.01183947591424 )**2;
   CLUS3vads [3] + ( REP_ClusterGroupU - -0.01003764575357 )**2;
   CLUS3vads [4] + ( REP_ClusterGroupU - 0.03000177352996 )**2;
end;
else _vqmvar + 0.14285714285714;
if not missing( REP_GenderF ) then do;
   CLUS3vads [1] + ( REP_GenderF - -0.05557248189434 )**2;
   CLUS3vads [2] + ( REP_GenderF - -0.04021309514703 )**2;
   CLUS3vads [3] + ( REP_GenderF - -0.22799302148477 )**2;
   CLUS3vads [4] + ( REP_GenderF - 0.36223593825265 )**2;
end;
else _vqmvar + 0.5;
if not missing( REP_GenderM ) then do;
   CLUS3vads [1] + ( REP_GenderM - 0.05557248189434 )**2;
   CLUS3vads [2] + ( REP_GenderM - 0.04021309514703 )**2;
   CLUS3vads [3] + ( REP_GenderM - 0.22799302148477 )**2;
   CLUS3vads [4] + ( REP_GenderM - -0.36223593825265 )**2;
end;
else _vqmvar + 0.5;
if not missing( REP_RegionCentral ) then do;
   CLUS3vads [1] + ( REP_RegionCentral - -0.0246989455206 )**2;
   CLUS3vads [2] + ( REP_RegionCentral - -0.0029121093616 )**2;
   CLUS3vads [3] + ( REP_RegionCentral - -0.00515816916922 )**2;
   CLUS3vads [4] + ( REP_RegionCentral - 0.0151656719234 )**2;
end;
else _vqmvar + 0.16666666666666;
if not missing( REP_RegionNorth ) then do;
   CLUS3vads [1] + ( REP_RegionNorth - 0.00576042625374 )**2;
   CLUS3vads [2] + ( REP_RegionNorth - -0.01258585398043 )**2;
   CLUS3vads [3] + ( REP_RegionNorth - 0.01141388972048 )**2;
   CLUS3vads [4] + ( REP_RegionNorth - -0.00067090475779 )**2;
end;
else _vqmvar + 0.16666666666666;
if not missing( REP_RegionNorthEast ) then do;
   CLUS3vads [1] + ( REP_RegionNorthEast - 0.11500889037012 )**2;
   CLUS3vads [2] + ( REP_RegionNorthEast - 0.00091675938062 )**2;
   CLUS3vads [3] + ( REP_RegionNorthEast - 0.00031421420509 )**2;
   CLUS3vads [4] + ( REP_RegionNorthEast - -0.02361068028259 )**2;
end;
else _vqmvar + 0.16666666666666;
if not missing( REP_RegionSouth_East ) then do;
   CLUS3vads [1] + ( REP_RegionSouth_East - -0.02254168281587 )**2;
   CLUS3vads [2] + ( REP_RegionSouth_East - 0.00437388418915 )**2;
   CLUS3vads [3] + ( REP_RegionSouth_East - -0.0098538478461 )**2;
   CLUS3vads [4] + ( REP_RegionSouth_East - 0.01196893225547 )**2;
end;
else _vqmvar + 0.16666666666666;
if not missing( REP_RegionSouth_West ) then do;
   CLUS3vads [1] + ( REP_RegionSouth_West - -0.01802946558488 )**2;
   CLUS3vads [2] + ( REP_RegionSouth_West - 0.00202172797111 )**2;
   CLUS3vads [3] + ( REP_RegionSouth_West - 0.0287107949914 )**2;
   CLUS3vads [4] + ( REP_RegionSouth_West - -0.03705653141533 )**2;
end;
else _vqmvar + 0.16666666666666;
if not missing( REP_RegionU ) then do;
   CLUS3vads [1] + ( REP_RegionU - -0.03208013035716 )**2;
   CLUS3vads [2] + ( REP_RegionU - 0.02213321430896 )**2;
   CLUS3vads [3] + ( REP_RegionU - -0.0145425621116 )**2;
   CLUS3vads [4] + ( REP_RegionU - -0.00193164550463 )**2;
end;
else _vqmvar + 0.16666666666666;
_vqnvar = 17 - _vqmvar;
if _vqnvar <= 8.8903107098303E-11 then do;
   _SEGMENT_ = .; Distance = .;
end;
else do;
   _SEGMENT_ = 1; Distance = CLUS3vads [1];
   _vqfzdst = Distance * 0.99999999999988; drop _vqfzdst;
   do _vqclus = 2 to 4;
      if CLUS3vads [_vqclus] < _vqfzdst then do;
         _SEGMENT_ = _vqclus; Distance = CLUS3vads [_vqclus];
         _vqfzdst = Distance * 0.99999999999988;
      end;
   end;
   Distance = sqrt(Distance * (17 / _vqnvar));
end;
CLUS3vlex :;

***************************************;
*** End Scoring Code from PROC DMVQ ***;
***************************************;
*------------------------------------------------------------*;
* Clus3: Creating Segment Label;
*------------------------------------------------------------*;
length _SEGMENT_LABEL_ $80;
label _SEGMENT_LABEL_='Segment Description';
if _SEGMENT_ = 1 then _SEGMENT_LABEL_="Cluster1";
else
if _SEGMENT_ = 2 then _SEGMENT_LABEL_="Cluster2";
else
if _SEGMENT_ = 3 then _SEGMENT_LABEL_="Cluster3";
else
if _SEGMENT_ = 4 then _SEGMENT_LABEL_="Cluster4";
