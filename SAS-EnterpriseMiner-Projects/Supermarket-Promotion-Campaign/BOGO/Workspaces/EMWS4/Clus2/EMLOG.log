*------------------------------------------------------------*
User:                Mohamed
Date:                May 09, 2018
Time:                15:10:00
Site:                12400032
Platform:            X64_10HOME
Maintenance Release: 9.04.01M4P110916
EM Version:          14.2
* 
*------------------------------------------------------------*
* Training Log
Date:                May 09, 2018
Time:                15:09:49
*------------------------------------------------------------*
11406  proc freq data=EMWS4.Clus2_VariableSet noprint;
11407  table ROLE*LEVEL/out=WORK.Clus2META;
11408  run;
 
NOTE: There were 26 observations read from the data set EMWS4.CLUS2_VARIABLESET.
NOTE: The data set WORK.CLUS2META has 6 observations and 4 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
 
 
11409  proc print data=WORK.Clus2META label noobs;
11410  var ROLE LEVEL COUNT;
11411  label ROLE = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel, NOQUOTE))" LEVEL = "%sysfunc(sasmsg(sashelp.dmine, meta_level_vlabel, NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel, NOQUOTE))";
11412  title9 ' ';
11413  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_varSummary_title  , NOQUOTE))";
11414  run;
 
NOTE: There were 6 observations read from the data set WORK.CLUS2META.
NOTE: The PROCEDURE PRINT printed page 1.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
11415  title10;
 
11416  data WORK.M1ESDZFL;
11417  set WORK.M1ESDZFL;
11418  if role eq 'REJECTED' then role = 'INPUT';
11419  run;
 
NOTE: There were 4 observations read from the data set WORK.M1ESDZFL.
NOTE: The data set WORK.M1ESDZFL has 4 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
11428  *------------------------------------------------------------*;
11429  * Clus2: Training;
11430  *------------------------------------------------------------*;
11431  *------------------------------------------------------------* ;
11432  * Clus2: DMDBClass Macro ;
11433  *------------------------------------------------------------* ;
11434  %macro DMDBClass;
11435      CampaignViewedEmail(ASC) FacebookLike(ASC) MobileApplications(ASC)
11436     PreviousCampaign(ASC)
11437  %mend DMDBClass;
11438  *------------------------------------------------------------* ;
11439  * Clus2: DMDBVar Macro ;
11440  *------------------------------------------------------------* ;
11441  %macro DMDBVar;
11442
11443  %mend DMDBVar;
11444  *------------------------------------------------------------*;
11445  * Clus2: Create DMDB;
11446  *------------------------------------------------------------*;
11447  proc dmdb batch data=EMWS4.Filter_TRAIN
11448  dmdbcat=WORK.Clus2_DMDB
11449  maxlevel = 513
11450  out=WORK.Clus2_DMDB
11451  ;
11452  class %DMDBClass;
11453  run;
 
NOTE: Records processed = 20035   Memory used = 511K.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: View EMWS4.FILTER_TRAIN.VIEW used (Total process time):
      real time           0.29 seconds
      cpu time            0.29 seconds
 
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: The data set WORK.CLUS2_DMDB has 20035 observations and 4 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.32 seconds
      cpu time            0.32 seconds
 
 
11454  quit;
11455  *--- end code ---*;
 
11456  *------------------------------------------------------------* ;
11457  * Clus2: Nominal Inputs Macro ;
11458  *------------------------------------------------------------* ;
11459  %macro DMVQNOMINAL;
11460      CampaignViewedEmail FacebookLike MobileApplications PreviousCampaign
11461  %mend DMVQNOMINAL;
11462  *------------------------------------------------------------*;
11463  * Clus2: Run DMVQ procedure;
11464  *------------------------------------------------------------*;
11465  title;
11466  options nodate;
11467  proc dmvq data=WORK.Clus2_DMDB dmdbcat=WORK.Clus2_DMDB std=STD nominal=GLM ordinal=RANK
11468  ;
NOTE: The training set WORK.CLUS2_DMDB.DATA has 4 variable(s).
NOTE: The DMVQ statement has finished with return code=0 and status=begin.
11469  input %DMVQNOMINAL / level=nominal;
NOTE: 4 input variable(s) defined for ID=I1.
NOTE: The INPUT statement has finished with return code=0 and status=variables.
11470  VQ maxc = 4 clusname=_SEGMENT_ CLUSLABEL="Segment Id" DISTLABEL="Distance";
NOTE: A maximum of 4 clusters have been requested.
NOTE: The VQ statement has finished with return code=0 and status=architecture.
11471  MAKE outvar=EMWS4.Clus2_OUTVAR;
 
NOTE: 4 input variable(s).
NOTE: Number of cases=20035
NOTE: Sum of frequencies=20035
NOTE: Sum of weights=20035
NOTE: VARDEF=DF
NOTE: Maximum number of categories=2
NOTE: The total number of variables is 4 with dimensionality 8.
NOTE: 4 variables will be used for clustering.
NOTE: Open output data set EMWS4.CLUS2_OUTVAR.DATA with 9 variables.
NOTE: The data set EMWS4.CLUS2_OUTVAR has 4 observations and 9 variables.
NOTE: The MAKE statement has finished with return code=0 and status=made.
11472  INITIAL radius=0
11473  ;
NOTE: 4 seeds were selected from data set WORK.CLUS2_DMDB.DATA using the SEPARATE algorithm.
NOTE: The INITIAL statement has finished with return code=0 and status=initialized.
11474  TRAIN tech=FORGY
11475  ;
NOTE: X-Convergence criterion is satisfied.
NOTE: The TRAIN statement has finished with return code=0 and status=trained.
11476  SAVE outstat=EMWS4.Clus2_OUTSTAT outmean=EMWS4.Clus2_OUTMEAN;
NOTE: The data set EMWS4.CLUS2_OUTSTAT has 40 observations and 11 variables.
NOTE: The data set EMWS4.CLUS2_OUTMEAN has 4 observations and 17 variables.
NOTE: The SAVE statement has finished with return code=0 and status=statistics.
11477  code file="D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus2\DMVQSCORECODE.sas"
11478  group=Clus2
11479  ;
NOTE: External file D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus2\DMVQSCORECODE.sas opened.
NOTE: The CODE statement has finished with return code=0 and status=statistics.
11480  run;
 
11481  quit;
 
NOTE: There were 20035 observations read from the data set WORK.CLUS2_DMDB.
NOTE: PROCEDURE DMVQ used (Total process time):
      real time           0.10 seconds
      cpu time            0.09 seconds
 
 
11482  libname _spdslib;
WARNING: Libref _SPDSLIB is not assigned.
 
11483  *------------------------------------------------------------*;
11484  * Clus2: Cluster Label;
11485  *------------------------------------------------------------*;
11486  data EMWS4.Clus2_LABEL;
11487  length _SEGMENT_ 8 Label $80;
11488  format _SEGMENT_ 4.;
11489  label _SEGMENT_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentName_vlabel,  NOQUOTE))";
11490  label Label = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentLabel_vlabel,  NOQUOTE))";
11491  _SEGMENT_= 1;
11492  Label='Cluster1';
11493  output;
11494  _SEGMENT_= 2;
11495  Label='Cluster2';
11496  output;
11497  _SEGMENT_= 3;
11498  Label='Cluster3';
11499  output;
11500  _SEGMENT_= 4;
11501  Label='Cluster4';
11502  output;
11503  run;
 
NOTE: The data set EMWS4.CLUS2_LABEL has 4 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
*------------------------------------------------------------*
* Score Log
Date:                May 09, 2018
Time:                15:09:51
*------------------------------------------------------------*
11605  proc transpose data=EMWS4.Clus2_OUTVAR out=WORK.Clus2_OUTVAR(rename=(COl2=NAME) where=(COL1='IMPUTED'));
11606  var CampaignViewedEmail0--PreviousCampaign1;
11607  where _TYPE_ in('TYPE' 'VARIABLE');
11608  run;
 
NOTE: There were 2 observations read from the data set EMWS4.CLUS2_OUTVAR.
      WHERE _TYPE_ in ('TYPE', 'VARIABLE');
NOTE: The data set WORK.CLUS2_OUTVAR has 0 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
11609  proc sort data=WORK.Clus2_OUTVAR;
11610  by NAME;
11611  run;
 
NOTE: Input data set is empty.
NOTE: The data set WORK.CLUS2_OUTVAR has 0 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
11612  proc sort data=EMWS4.Clus2_VariableSet(KEEP=NAME ROLE LEVEL) out=WORK.Clus2_SORTEDVARS;
11613  by NAME;
11614  run;
 
NOTE: There were 26 observations read from the data set EMWS4.CLUS2_VARIABLESET.
NOTE: The data set WORK.CLUS2_SORTEDVARS has 26 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
11615  data WORK.Clus2_OUTVAR;
11616  merge WORK.Clus2_OUTVAR(in=INVAR) WORK.Clus2_SORTEDVARS;
11617  by NAME;
11618  if INVAR then output;
11619  run;
 
WARNING: Multiple lengths were specified for the BY variable NAME by input data sets. This might cause unexpected results.
NOTE: There were 0 observations read from the data set WORK.CLUS2_OUTVAR.
NOTE: There were 26 observations read from the data set WORK.CLUS2_SORTEDVARS.
NOTE: The data set WORK.CLUS2_OUTVAR has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this session.
11620  filename emflow "D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus2\EMFLOWSCORE.sas";
11621  *------------------------------------------------------------*;
11622  * Clus2: Scoring DATA data;
11623  *------------------------------------------------------------*;
11624  data EMWS4.Clus2_TRAIN
11625  / view=EMWS4.Clus2_TRAIN
11626  ;
11627  set EMWS4.Filter_TRAIN
11628  ;
11629  %inc emflow;
11842  run;
 
NOTE: DATA STEP view saved on file EMWS4.CLUS2_TRAIN.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS4.FILTER_TRAIN.VIEW used (Total process time):
      real time           0.20 seconds
      cpu time            0.20 seconds
 
NOTE: DATA statement used (Total process time):
      real time           0.21 seconds
      cpu time            0.21 seconds
 
 
11843  quit;
11844  filename emflow;
NOTE: Fileref EMFLOW has been deassigned.
 
11845  *------------------------------------------------------------*;
11846  * Clus2: Computing metadata for TRAIN data;
11847  *------------------------------------------------------------*;
 
NOTE: View EMWS4.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.21 seconds
      cpu time            0.21 seconds
 
NOTE: View EMWS4.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.23 seconds
      cpu time            0.23 seconds
 
*------------------------------------------------------------*
* Report Log
Date:                May 09, 2018
Time:                15:09:52
*------------------------------------------------------------*
12257  data WORK.M2YT_5E2;
12258  set WORK.M2YT_5E2;
12259  if role eq 'REJECTED' then role = 'INPUT';
12260  run;
 
NOTE: There were 4 observations read from the data set WORK.M2YT_5E2.
NOTE: The data set WORK.M2YT_5E2 has 4 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12261  data WORK.M2YT_5E2;
12262  set WORK.M2YT_5E2 end=_eof_ nobs=_nobs_;
12263  output;
12264  if _eof_ then do;
12265  name = '_SEGMENT_';
12266  ROLE = 'TARGET';
12267  LEVEL = 'NOMINAL';
12268  LABEL = 'Segment Variable';
12269  TYPE = 'N';
12270  FORMAT = '';
12271  INFORMAT = '';
12272  USE='Y';
12273  output;
12274  end;
12275  run;
 
NOTE: There were 4 observations read from the data set WORK.M2YT_5E2.
NOTE: The data set WORK.M2YT_5E2 has 5 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12276  *------------------------------------------------------------*;
12277  * Clus2: Create decision matrix;
12278  *------------------------------------------------------------*;
12279  *------------------------------------------------------------* ;
12280  * Clus2: Tree Variables Macro ;
12281  *------------------------------------------------------------* ;
12282  %macro EM_TREEVARS;
12283      CampaignViewedEmail FacebookLike MobileApplications PreviousCampaign
12284  %mend EM_TREEVARS;
12285  *------------------------------------------------------------* ;
12286  * Clus2: Tree Targets Macro ;
12287  *------------------------------------------------------------* ;
12288  %macro EM_TREETARGETS;
12289      _SEGMENT_
12290  %mend EM_TREETARGETS;
12291  data EMWS4.EM_Clus2 / view=EMWS4.EM_Clus2;
12292  set EMWS4.Clus2_TRAIN(keep=%EM_TREEVARS %EM_TREETARGETS);
12293  run;
 
NOTE: DATA STEP view saved on file EMWS4.EM_CLUS2.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS4.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.23 seconds
      cpu time            0.23 seconds
 
NOTE: DATA statement used (Total process time):
      real time           0.25 seconds
      cpu time            0.25 seconds
 
 
12294  *------------------------------------------------------------* ;
12295  * Clus2: Interval Inputs Macro ;
12296  *------------------------------------------------------------* ;
12297  %macro INTINPUTS;
12298
12299  %mend INTINPUTS;
12300  *------------------------------------------------------------* ;
12301  * Clus2: Binary and Nominal Inputs Macro ;
12302  *------------------------------------------------------------* ;
12303  %macro NOMINPUTS;
12304      CampaignViewedEmail FacebookLike MobileApplications PreviousCampaign
12305  %mend NOMINPUTS;
12306  *------------------------------------------------------------* ;
12307  * Clus2: Ordinal Inputs Macro ;
12308  *------------------------------------------------------------* ;
12309  %macro ORDINPUTS;
12310
12311  %mend ORDINPUTS;
12312  *------------------------------------------------------------*;
12313  * Clus2: Run ARBOR procedure;
12314  *------------------------------------------------------------*;
 
12315  proc arbor data=EMWS4.EM_Clus2
12316  MAXSURRS=3
12317  ;
12318  ;
12319  input %NOMINPUTS
12320  / level=nominal;
12321  target _SEGMENT_ / level=NOMINAL
12322  Criterion=PROBCHISQ
12323  ;
12324  ;
12325  Performance DISK
12326  ;
12327  MAKEMACRO NLEAVES=nleaves;
NOTE: 1385333 kilobytes of physical memory.
NOTE: Will use 20035 out of 20035 training cases.
NOTE: Using memory pool with 137756672 bytes.
NOTE: Passed training data 12 times.
NOTE: Training used 2047848 bytes of work memory.
NOTE: The subtree sequence contains 12 subtrees. The largest has 23 nodes and 12 leaves.
NOTE: Using subtree with 23 nodes and 12 leaves.
NOTE: Created macro variable NLEAVES equal to 12.
12328  save
12329  MODEL=EMWS4.Clus2_PLOTDS
12330  SEQUENCE=EMWS4.Clus2_OUTSEQ
12331  IMPORTANCE=EMWS4.Clus2_OUTIMPORT
12332  NODESTAT=EMWS4.Clus2_OUTNODES
12333  SUMMARY=WORK.OUTSUMMARY_TREE_3GBP_KP
12334  STATSBYNODE=WORK.OUTSTATS_TREE_3GBP_KP
12335  Pathlistnonmissing = WORK.OUTPATH_TREE_3GBP_KP
12336  Rules = WORK.OUTRULES_TREE_3GBP_KP
12337  ;
NOTE: The data set EMWS4.CLUS2_OUTIMPORT has 4 observations and 5 variables.
NOTE: The data set EMWS4.CLUS2_PLOTDS has 702 observations and 4 variables.
NOTE: The data set EMWS4.CLUS2_OUTNODES has 23 observations and 24 variables.
NOTE: The data set WORK.OUTPATH_TREE_3GBP_KP has 65 observations and 7 variables.
NOTE: The data set WORK.OUTRULES_TREE_3GBP_KP has 142 observations and 6 variables.
NOTE: The data set EMWS4.CLUS2_OUTSEQ has 12 observations and 11 variables.
NOTE: The data set WORK.OUTSTATS_TREE_3GBP_KP has 138 observations and 5 variables.
NOTE: The data set WORK.OUTSUMMARY_TREE_3GBP_KP has 20 observations and 7 variables.
12338  run;
 
12339  quit;
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: View EMWS4.EM_CLUS2.VIEW used (Total process time):
      real time           1.40 seconds
      cpu time            1.39 seconds
 
NOTE: There were 20035 observations read from the data set EMWS4.CLUS2_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.EM_CLUS2.
NOTE: The data set WORK._NAMEDAT has 4 observations and 5 variables.
NOTE: PROCEDURE ARBOR used (Total process time):
      real time           1.42 seconds
      cpu time            1.40 seconds
 
 
12340  data EMWS4.Clus2_OUTIMPORT;
12341  set EMWS4.Clus2_OUTIMPORT;
12342  label NAME = "%sysfunc(sasmsg(sashelp.dmine, meta_name_vlabel, noquote))" LABEL = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel, noquote))" NRULES = "%sysfunc(sasmsg(sashelp.dmine, rpt_nrules_vlabel, noquote))" IMPORTANCE =
12343     "%sysfunc(sasmsg(sashelp.dmine, rpt_importance_vlabel, noquote))" NSURROGATES = "%sysfunc(sasmsg(sashelp.dmine, rpt_nsurrogates_vlabel, noquote))"
12344  ;
12345  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS2_OUTIMPORT.
NOTE: The data set EMWS4.CLUS2_OUTIMPORT has 4 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12346  filename x "D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus2\ENGLISHRULES.txt" encoding='utf-8' NOBOM;
 
12347  data temp;
12348  length varname $19;
12349  retain varname;
12350  set WORK.OUTPATH_TREE_3GBP_KP;
12351  if ^missing(variable) then varname=variable;
12352  else if ^missing(var_name) then varname=var_name;
12353  output;
12354  run;
 
NOTE: There were 65 observations read from the data set WORK.OUTPATH_TREE_3GBP_KP.
NOTE: The data set WORK.TEMP has 65 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12355  proc sort data=temp;
12356  by node;
12357  run;
 
NOTE: There were 65 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 65 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12358  proc sort data=EMWS4.Clus2_OUTNODES out=outnodes;
12359  by node;
12360  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_OUTNODES.
NOTE: The data set WORK.OUTNODES has 23 observations and 24 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12361  data temp;
12362  merge temp(in=_a) outnodes(keep= node
12363  NPRIORS
12364  P__SEGMENT_1
12365  P__SEGMENT_3
12366  P__SEGMENT_2
12367  P__SEGMENT_4
12368  );
12369  by node;
12370  if _a;
12371  run;
 
NOTE: There were 65 observations read from the data set WORK.TEMP.
NOTE: There were 23 observations read from the data set WORK.OUTNODES.
NOTE: The data set WORK.TEMP has 65 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12372  proc sort data=temp;
12373  by node descending varname descending numeric_value;
12374  run;
 
NOTE: There were 65 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 65 observations and 13 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12375  data _null_;
12376  file x;
12377  set temp;
12378  by node descending varname;
12379  retain origvar oldnode string;
12380  length origvar $32 oldnode 8 string $200;
12381  if _n_ = 1 then do;
12382  origvar = varname;
12383  oldnode = node;
12384  end;
12385  if first.node then do;
12386  put "&EM_CODEBAR";
12387  put " Node = " node;
12388  put "&EM_CODEBAR";
12389  end;
12390  if first.varname then do;
12391  if RELATION ^in ("=", "ISMISSING", "ISNOTMISSING") then do;
12392  if MISSING(CHARACTER_VALUE) then do;
12393  if NUMERIC_VALUE ne . then do;
12394  if ^first.node then do;
12395  string= "AND "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12396  end;
12397  else do;
12398  string= "if "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12399  end;
12400  end;
12401  end;
12402  else do;
12403  if ^first.node then do;
12404  string= "AND "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12405  end;
12406  else do;
12407  string= "if "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12408  end;
12409  end;
12410  end;
12411  else if RELATION in ("=") then do;
12412  if ^first.node then do;
12413  string = "AND "||strip(varname) ||" IS ONE OF: "||character_value;
12414  end;
12415  else do;
12416  string = "if "|| strip(varname) ||" IS ONE OF: "||character_value;
12417  end;
12418  end;
12419  else if RELATION in ("ISMISSING") then do;
12420  if ^first.node then do;
12421  string = " AND "|| strip(varname) || " equals Missing";
12422  end;
12423  else do;
12424  string = "if "|| strip(varname) ||" equals Missing";
12425  end;
12426  end;
12427  else if RELATION in ("ISNOTMISSING") then do;
12428  if ^first.node then do;
12429  string = " AND "|| strip(varname) || " equals All Values";
12430  end;
12431  else do;
12432  string = "if "|| strip(varname) ||" equals All Values";
12433  end;
12434  end;
12435  if ^missing(varname) then origvar = varname;
12436  oldnode=node;
12437  end;
12438  else do;
12439  if RELATION ^in ("=", "ISMISSING", "ISNOTMISSING") then do;
12440  if MISSING(CHARACTER_VALUE) then do;
12441  if NUMERIC_VALUE ne . then do;
12442  if ^MISSING(string) then string= strip(string)||" AND "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12443  else string= " if "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12444  end;
12445  end;
12446  else do;
12447  if ^MISSING(string) then string= strip(string)||" AND "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12448  else string= " if "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12449  end;
12450  end;
12451  else if RELATION in ("=") then do;
12452  string = strip(string)||", "||strip(character_value);
12453  end;
12454  else if RELATION in ("ISMISSING") then do;
12455  end;
12456  if ^missing(varname) then origvar = varname;
12457  oldnode=node;
12458  end;
12459  if last.varname then do;
12460  if RELATION in ("ISMISSING") then do;
12461  if ^first.varname then do;
12462  string = strip(string) || " or MISSING";
12463  end;
12464  end;
12465  put string;
12466  if ^missing(varname) then origvar = varname;
12467  oldnode=node;
12468  end;
12469  if last.node then do;
12470  put "then ";
12471  put " Tree Node Identifier   = " node;
12472  put " Number of Observations = " NPRIORS;
12473  put " Predicted: _SEGMENT_=1  = " P__SEGMENT_1;
12474  put " Predicted: _SEGMENT_=3  = " P__SEGMENT_3;
12475  put " Predicted: _SEGMENT_=2  = " P__SEGMENT_2;
12476  put " Predicted: _SEGMENT_=4  = " P__SEGMENT_4;
12477  put " ";
12478  if ^missing(varname) then origvar = varname;
12479  oldnode=node;
12480  end;
12481  run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      12395:67    12398:66    12442:108   12443:72
NOTE: The file X is:
      Filename=D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus2\ENGLISHRULES.txt,
      RECFM=V,LRECL=131068,File Size (bytes)=0,
      Last Modified=09May2018:15:09:54,
      Create Time=09May2018:15:09:54
 
NOTE: 176 records were written to the file X.
      The minimum record length was 1.
      The maximum record length was 62.
NOTE: There were 65 observations read from the data set WORK.TEMP.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12482  filename x;
NOTE: Fileref X has been deassigned.
 
12483  /* belowtext */
12484  data templabel;
12485  set WORK.OUTRULES_TREE_3GBP_KP;
12486  if ((ROLE="PRIMARY") AND (STAT ="LABEL"));
12487  rename character_value = belowtext;
12488  keep NODE character_value;
12489  run;
 
NOTE: There were 142 observations read from the data set WORK.OUTRULES_TREE_3GBP_KP.
NOTE: The data set WORK.TEMPLABEL has 0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12490  data tempvar;
12491  set WORK.OUTRULES_TREE_3GBP_KP;
12492  if ((ROLE="PRIMARY") AND (STAT="VARIABLE"));
12493  keep NODE character_value;
12494  run;
 
NOTE: There were 142 observations read from the data set WORK.OUTRULES_TREE_3GBP_KP.
NOTE: The data set WORK.TEMPVAR has 11 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12495  proc sort data=templabel;
12496  by node;
12497  run;
 
NOTE: Input data set is empty.
NOTE: The data set WORK.TEMPLABEL has 0 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12498  proc sort data=tempvar;
12499  by node;
12500  run;
 
NOTE: There were 11 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 11 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12501  data tempbelow;
12502  merge templabel tempvar;
12503  by node;
12504  if missing(belowtext) then belowtext= character_value;
12505  keep node belowtext;
12506  run;
 
NOTE: There were 0 observations read from the data set WORK.TEMPLABEL.
NOTE: There were 11 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPBELOW has 11 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12507  proc sort data=tempbelow;
12508  by node;
12509  run;
 
NOTE: There were 11 observations read from the data set WORK.TEMPBELOW.
NOTE: The data set WORK.TEMPBELOW has 11 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12510  /* abovetext */
12511  data tempoutrules;
12512  set WORK.OUTRULES_TREE_3GBP_KP;
12513  if ((ROLE='PRIMARY') AND(STAT in ("INTERVAL", "ORDINAL", "NOMINAL")));
12514  run;
 
NOTE: There were 142 observations read from the data set WORK.OUTRULES_TREE_3GBP_KP.
NOTE: The data set WORK.TEMPOUTRULES has 22 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12515  proc sort data=tempoutrules;
12516  by node numeric_value;
12517  run;
 
NOTE: There were 22 observations read from the data set WORK.TEMPOUTRULES.
NOTE: The data set WORK.TEMPOUTRULES has 22 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12518  data tempabove;
12519  set tempoutrules(rename=(node=parent));
12520  by parent numeric_value;
12521  retain abovetext tempstring flag branch origval origchar;
12522  *length abovetext tempstring origchar $45;
12523  length abovetext $256;
12524  length tempstring origchar $64;
12525  if STAT in ("INTERVAL", "ORDINAL") then do;
12526  if first.parent then do;
12527  if missing(character_value) then do;
12528  numeric_value = round(numeric_value, 0.0001);
12529  abovetext = "< "||strip(NUMERIC_VALUE);
12530  branch = 1;
12531  origval = numeric_value;
12532  output;
12533  end;
12534  else do;
12535  abovetext = "< "||strip(CHARACTER_VALUE);
12536  branch = 1;
12537  origchar = character_value;
12538  output;
12539  end;
12540  if first.parent AND last.parent then do;
12541  if missing(character_value) then do;
12542  numeric_value = round(numeric_value, 0.0001);
12543  branch = branch + 1;
12544  abovetext = ">= "||strip(NUMERIC_VALUE);
12545  output;
12546  end;
12547  else do;
12548  branch = branch + 1;
12549  abovetext = ">= "||strip(CHARACTER_VALUE);
12550  output;
12551  end;
12552  end;
12553  end;
12554  else if last.parent then do;
12555  if ( missing(character_value) AND (origval ne numeric_value)) or ( ^missing(character_value) AND (origchar ne character_value)) then do;
12556  if missing(character_value) then do;
12557  numeric_value = round(numeric_value, 0.0001);
12558  abovetext= "[ "||strip(origval)||", "|| strip(numeric_value)||" )";
12559  end;
12560  else do;
12561  abovetext= ">= "||strip(origchar)||" AND < "|| strip(character_value);
12562  end;
12563  branch = branch + 1;
12564  output;
12565  if missing(character_value) then do;
12566  numeric_value = round(numeric_value, 0.0001);
12567  abovetext = ">= "||strip(NUMERIC_VALUE);
12568  end;
12569  else do;
12570  abovetext = ">= "||strip(CHARACTER_VALUE);
12571  end;
12572  branch = branch + 1;
12573  output;
12574  end;
12575  else do;
12576  if missing(character_value) then do;
12577  numeric_value = round(numeric_value, 0.0001);
12578  abovetext = ">= "||strip(NUMERIC_VALUE);
12579  end;
12580  else do;
12581  abovetext = ">= "||strip(CHARACTER_VALUE);
12582  end;
12583  branch = branch + 1;
12584  output;
12585  end;
12586  end;
12587  else do;
12588  if ( missing(character_value) AND (origval ne numeric_value)) or ( ^missing(character_value) AND (origchar ne character_value)) then do;
12589  if missing(character_value) then do;
12590  numeric_value = round(numeric_value,0.0001);
12591  abovetext= "[ "||strip(origval)||", "|| strip(numeric_value)||" )";
12592  origval = numeric_value;
12593  end;
12594  else do;
12595  abovetext= ">= "||strip(origchar)||" AND < "|| strip(character_value);
12596  origchar = character_value;
12597  end;
12598  branch = branch + 1;
12599  output;
12600  end;
12601  else do;
12602  if missing(character_value) then do;
12603  numeric_value = round(numeric_value, 0.0001);
12604  abovetext = ">= "||strip(NUMERIC_VALUE);
12605  origval = numeric_value;
12606  end;
12607  else do;
12608  abovetext = ">= "||strip(CHARACTER_VALUE);
12609  origval = character_value;
12610  end;
12611  branch = branch + 1;
12612  output;
12613  end;
12614  end;
12615  end;
12616  else do;
12617  if first.numeric_value then do;
12618  flag = 0;
12619  abovetext = CHARACTER_VALUE;
12620  branch = numeric_value;
12621  if first.numeric_value AND last.numeric_value then do;
12622  output;
12623  end;
12624  end;
12625  else if last.numeric_value then do;
12626  if flag=0 then do;
12627  tempstring = strip(abovetext)||", "||CHARACTER_VALUE;
12628  length = length(strip(tempstring));
12629  if length < 32 then do;
12630  abovetext = strip(tempstring);
12631  end;
12632  else do;
12633  abovetext = strip(abovetext)||", ...";
12634  flag = 1;
12635  end;
12636  end;
12637  branch = numeric_value;
12638  output;
12639  end;
12640  else do;
12641  if flag=0 then do;
12642  tempstring = strip(abovetext)||", "||CHARACTER_VALUE;
12643  length = length(strip(tempstring));
12644  if length < 32 then do;
12645  abovetext = strip(tempstring);
12646  end;
12647  else do;
12648  abovetext = strip(abovetext)||", ...";
12649  flag=1;
12650  end;
12651  end;
12652  branch = numeric_value;
12653  end;
12654  end;
12655  keep parent branch abovetext;
12656  run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      12529:25   12544:26   12558:24   12558:47   12567:26   12578:26   12591:24   12591:47   12604:26
NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      12609:11
NOTE: There were 22 observations read from the data set WORK.TEMPOUTRULES.
NOTE: The data set WORK.TEMPABOVE has 22 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
 
 
12657  /* MIssing value to abovetext */
12658  data tempmissing;
12659  set WORK.OUTRULES_TREE_3GBP_KP;
12660  if ((ROLE="PRIMARY") AND (STAT in ("MISSING")));
12661  rename node=parent numeric_value=branch character_value=misschar;
12662  run;
 
NOTE: There were 142 observations read from the data set WORK.OUTRULES_TREE_3GBP_KP.
NOTE: The data set WORK.TEMPMISSING has 11 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12663  proc sort data=work.tempabove;
12664  by parent branch;
12665  run;
 
NOTE: There were 22 observations read from the data set WORK.TEMPABOVE.
NOTE: The data set WORK.TEMPABOVE has 22 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12666  proc sort data=EMWS4.Clus2_OUTNODES out=tempoutnodes;
12667  by parent branch;
12668  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_OUTNODES.
NOTE: The data set WORK.TEMPOUTNODES has 23 observations and 24 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12669  proc sort data=tempmissing;
12670  by parent branch;
12671  run;
 
NOTE: There were 11 observations read from the data set WORK.TEMPMISSING.
NOTE: The data set WORK.TEMPMISSING has 11 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12672  data WORK.Clus2_outnodes;
12673  merge work.tempabove tempoutNodes(drop=abovetext ) tempmissing(in=_a);
12674  by parent branch;
12675  length traintotal validtotal 8;
12676  retain traintotal validtotal;
12677  if _a then do;
12678  if ^MISSING(abovetext) then do;
12679  abovetext= strip(abovetext)||" %sysfunc(sasmsg(sashelp.dmine, tree_ormiss_vlabel, noquote))";
12680  end;
12681  else do;
12682  abovetext = " %sysfunc(sasmsg(sashelp.dmine, tree_missonly_vlabel, noquote))";
12683  end;
12684  end;
12685  if MISSING(abovetext) then abovetext="%sysfunc(sasmsg(sashelp.dmine, tree_nonmiss_vlabel, noquote))";
12686  if node=1 then do;
12687  traintotal = N;
12688  validtotal=VN;
12689  end;
12690  label traintotal = "%sysfunc(sasmsg(sashelp.dmine,  rpt_traintotal_vlabel, noquote))";
12691  drop role rank stat misschar belowtext;
12692  run;
 
NOTE: Variable VN is uninitialized.
NOTE: There were 22 observations read from the data set WORK.TEMPABOVE.
NOTE: There were 23 observations read from the data set WORK.TEMPOUTNODES.
NOTE: There were 11 observations read from the data set WORK.TEMPMISSING.
NOTE: The data set WORK.CLUS2_OUTNODES has 23 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.04 seconds
 
 
12693  proc sort data=WORK.Clus2_outnodes;
12694  by node;
12695  run;
 
NOTE: There were 23 observations read from the data set WORK.CLUS2_OUTNODES.
NOTE: The data set WORK.CLUS2_OUTNODES has 23 observations and 26 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12696  proc sort data=tempbelow;
12697  by node;
12698  run;
 
NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12699  data WORK.Clus2_outnodes;
12700  merge WORK.Clus2_outnodes tempbelow;
12701  by node;
12702  run;
 
NOTE: There were 23 observations read from the data set WORK.CLUS2_OUTNODES.
NOTE: There were 11 observations read from the data set WORK.TEMPBELOW.
NOTE: The data set WORK.CLUS2_OUTNODES has 23 observations and 27 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: View EMWS4.EM_CLUS2.VIEW used (Total process time):
      real time           0.51 seconds
      cpu time            0.50 seconds
 
NOTE: There were 20035 observations read from the data set EMWS4.CLUS2_TRAIN.
12703  data tempoutstats;
12704  set WORK.OUTSTATS_TREE_3GBP_KP;
12705  length tarlevel $8;
12706  tarlevel ="NOMINAL";
12707  run;
 
NOTE: There were 138 observations read from the data set WORK.OUTSTATS_TREE_3GBP_KP.
NOTE: The data set WORK.TEMPOUTSTATS has 138 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12708  data EMWS4.Clus2_TREE_PLOT;
12709  length NODETEXT TEXTALL $800 N NODECOLOR 8;
12710  set WORK.Clus2_outnodes;
12711  label parent = "%sysfunc(sasmsg(sashelp.dmine, rpt_parentID_vlabel, noquote))" depth = "%sysfunc(sasmsg(sashelp.dmine, rpt_depth_vlabel, noquote))" belowtext= "%sysfunc(sasmsg(sashelp.dmine, rpt_belowtext_vlabel, noquote))" abovetext =
12712     "%sysfunc(sasmsg(sashelp.dmine, rpt_abovetext_vlabel, noquote))" linkwidth = "%sysfunc(sasmsg(sashelp.dmine, rpt_linkwidth_vlabel, noquote))" nodetext = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodetext_vlabel, noquote))" textall =
12713     "%sysfunc(sasmsg(sashelp.dmine, rpt_textall_vlabel, noquote))" N = "%sysfunc(sasmsg(sashelp.dmine, rpt_trainn_vlabel, noquote))" nodecolor = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodecolor_vlabel, noquote))" node =
12714     "%sysfunc(sasmsg(sashelp.dmine, rpt_node_vlabel, noquote))";
12715  keep NODE PARENT DEPTH BELOWTEXT ABOVETEXT LINKWIDTH NODETEXT TEXTALL N NODECOLOR;
12716  run;
 
NOTE: Variable TEXTALL is uninitialized.
NOTE: Variable NODECOLOR is uninitialized.
NOTE: There were 23 observations read from the data set WORK.CLUS2_OUTNODES.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12717  proc sort data=EMWS4.Clus2_TREE_PLOT;
12718  by node;
12719  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_TREE_PLOT.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12720  proc sort data=tempoutstats;
12721  by node;
12722  run;
 
NOTE: There were 138 observations read from the data set WORK.TEMPOUTSTATS.
NOTE: The data set WORK.TEMPOUTSTATS has 138 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12723  data EMWS4.Clus2_TREE_PLOT;
12724  merge EMWS4.Clus2_TREE_PLOT tempoutstats;
12725  length text $800 _RASE_ P__SEGMENT_1 8;
12726  retain P__SEGMENT_1 eventlevel;
12727  by node;
12728  if statname='N' then N=statvalue;
12729  if statname='NPRIORS' then N=statvalue;
12730  if statname='PREDICTION' then eventlevel=category;
12731  _RASE_ = .;
12732  if tarlevel ^= 'INTERVAL' then do;
12733  if STATNAME = 'PROBABILITY' then do;
12734  if CATEGORY=EVENTLEVEL then do;
12735  nodetext = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12736  text = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12737  P__SEGMENT_1 = round(STATVALUE, .01);
12738  end;
12739  else do;
12740  text = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12741  end;
12742  textall = strip(textall)||'0A'x||strip( text);
12743  end;
12744  if last.node then do;
12745  nodetext = trim(nodetext)||'0A'x||" %sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12746  textall = trim(textall)||'0A'x||" %sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12747  output EMWS4.Clus2_TREE_PLOT;
12748  end;
12749  end;
12750  else do;
12751  if statname='RASE' then _RASE_=statvalue;
12752  label _RASE_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_trase_vlabel, noquote))";
12753  if STATNAME = 'PREDICTION' then do;
12754  nodetext= "%sysfunc(sasmsg(sashelp.dmine, rpt_average_vlabel, noquote))"|| put(STATVALUE, 13.4)||'0A'x|| "%sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12755  textall = nodetext;
12756  P__SEGMENT_1 = STATVALUE;
12757  ;
12758  ;
12759  end;
12760  if last.node then do;
12761  output EMWS4.Clus2_TREE_PLOT;
12762  end;
12763  ;
12764  end;
12765  label P__SEGMENT_1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_predictedvar_vlabel, noquote))";
12766  keep NODE PARENT DEPTH BELOWTEXT ABOVETEXT LINKWIDTH NODETEXT TEXTALL N NODECOLOR _RASE_ P__SEGMENT_1;
12767  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_TREE_PLOT.
NOTE: There were 138 observations read from the data set WORK.TEMPOUTSTATS.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
 
 
12768  data tempcolor;
12769  set WORK.OUTSTATS_TREE_3GBP_KP;
12770  retain eventlevel;
12771  if STATNAME='PREDICTION' then eventlevel=CATEGORY;
12772  run;
 
NOTE: There were 138 observations read from the data set WORK.OUTSTATS_TREE_3GBP_KP.
NOTE: The data set WORK.TEMPCOLOR has 138 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12773  data tempcolor;
12774  set tempcolor;
12775  if 'NOMINAL' ne 'INTERVAL' then do;
12776  if CATEGORY=EVENTLEVEL AND STATNAME="PROBABILITY";
12777  end;
12778  else do;
12779  if STATNAME="PREDICTION";
12780  end;
12781  run;
 
NOTE: There were 138 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 23 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12782  data tempcolor;
12783  set tempcolor;
12784  length nodecolor 8;
12785  if 'NOMINAL' ne 'INTERVAL' then do;
12786  nodecolor = round(100*(STATVALUE), .01);
12787  end;
12788  else do;
12789  nodecolor=round(statvalue, .01);
12790  end;
12791  keep node nodecolor;
12792  run;
 
NOTE: There were 23 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 23 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12793  proc sort data=EMWS4.Clus2_TREE_PLOT;
12794  by node;
12795  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_TREE_PLOT.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12796  proc sort data=tempcolor;
12797  by node;
12798  run;
 
NOTE: There were 23 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 23 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12799  data EMWS4.Clus2_TREE_PLOT;
12800  merge EMWS4.Clus2_TREE_PLOT tempcolor;
12801  by node;
12802  length traintotal 8;
12803  retain traintotal;
12804  label traintotal = "%sysfunc(sasmsg(sashelp.dmine,  rpt_traintotal_vlabel, noquote))";
12805  if node=1 then do;
12806  traintotal = N;
12807  end;
12808  if NODE eq . then delete;
12809  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_TREE_PLOT.
NOTE: There were 23 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12810  data EMWS4.Clus2_TREE_PLOT;
12811  set EMWS4.Clus2_TREE_PLOT;
12812  textall = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodeId_vlabel, noquote, )):"|| put(Node, 13.)||'0A'x||trim(textall);
12813  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_TREE_PLOT.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12814  data tempout;
12815  set WORK.Clus2_outnodes;
12816  run;
 
NOTE: There were 23 observations read from the data set WORK.CLUS2_OUTNODES.
NOTE: The data set WORK.TEMPOUT has 23 observations and 27 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12817  proc sort data=tempout;
12818  by descending P__SEGMENT_1;
12819  run;
 
NOTE: There were 23 observations read from the data set WORK.TEMPOUT.
NOTE: The data set WORK.TEMPOUT has 23 observations and 27 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12820  data tree_temp;
12821  set tempout;
12822  if LEAF ne .;
12823  label index="%sysfunc(sasmsg(sashelp.dmine, rpt_leafindex_vlabel  , NOQUOTE))";
12824  label percevent_train = "%sysfunc(sasmsg(sashelp.dmine, rpt_perc_train_vlabel  , NOQUOTE))";
12825  label perc_train = "%sysfunc(sasmsg(sashelp.dmine, rpt_percevent_train_vlabel  , NOQUOTE))";
12826  label tprob="%sysfunc(sasmsg(sashelp.dmine, rpt_prob_vlabel  , NOQUOTE, %nrbquote()))";
12827  tprob = round(P__SEGMENT_1, .01);
12828  percevent_train = round ( tprob*100, .01);
12829  *perc_train =round( ( N / traintotal)*100, .001);
12830  perc_train =round( ( N / traintotal), .01);
12831  if missing(perc_train) then perc_train = round( linkwidth*100, .001);
12832  index = _n_;
12833  keep NODE index tprob perc_train percevent_train
12834  ;
12835  run;
 
NOTE: There were 23 observations read from the data set WORK.TEMPOUT.
NOTE: The data set WORK.TREE_TEMP has 12 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12836  proc sort data=tree_temp;
12837  by NODE;
12838  run;
 
NOTE: There were 12 observations read from the data set WORK.TREE_TEMP.
NOTE: The data set WORK.TREE_TEMP has 12 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12839  proc sort data=EMWS4.Clus2_TREE_PLOT;
12840  by NODE;
12841  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_TREE_PLOT.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 13 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.00 seconds
 
 
12842  data EMWS4.Clus2_TREE_PLOT;
12843  merge EMWS4.Clus2_TREE_PLOT tree_temp;
12844  by NODE;
12845  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_TREE_PLOT.
NOTE: There were 12 observations read from the data set WORK.TREE_TEMP.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 17 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12846  proc sort data=EMWS4.Clus2_TREE_PLOT;
12847  by node index;
12848  run;
 
NOTE: There were 23 observations read from the data set EMWS4.CLUS2_TREE_PLOT.
NOTE: The data set EMWS4.CLUS2_TREE_PLOT has 23 observations and 17 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12849  title9 ' ';
12850  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_VariableImportance_title, NOQUOTE))";
12851  proc print data=EMWS4.Clus2_OUTIMPORT(where=(IMPORTANCE>0)) noobs label;
12852  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS2_OUTIMPORT.
      WHERE IMPORTANCE>0;
NOTE: The PROCEDURE PRINT printed page 2.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12853  title10;
 
12854  data WORK.M1RH5DB8;
12855  set WORK.M1RH5DB8;
12856  if role eq 'REJECTED' then role = 'INPUT';
12857  run;
 
NOTE: There were 26 observations read from the data set WORK.M1RH5DB8.
NOTE: The data set WORK.M1RH5DB8 has 26 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12858  proc sort data=EMWS4.Clus2_OUTIMPORT out=WORK.Clus2_GRAPHVARS(keep=NAME);
12859  where IMPORTANCE>0;
12860  by NAME;
12861  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS2_OUTIMPORT.
      WHERE IMPORTANCE>0;
NOTE: The data set WORK.CLUS2_GRAPHVARS has 4 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
 
 
12862  proc sort data = WORK.M1RH5DB8;
12863  by NAME;
12864  run;
 
NOTE: There were 26 observations read from the data set WORK.M1RH5DB8.
NOTE: The data set WORK.M1RH5DB8 has 26 observations and 21 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12865  data WORK.M1RH5DB8;
12866  merge WORK.M1RH5DB8 WORK.Clus2_GRAPHVARS(in=_b_);
12867  by NAME;
12868  if _b_ or ROLE = "FREQ" or REPORT="Y" then output;
12869  run;
 
NOTE: There were 26 observations read from the data set WORK.M1RH5DB8.
NOTE: There were 4 observations read from the data set WORK.CLUS2_GRAPHVARS.
NOTE: The data set WORK.M1RH5DB8 has 4 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12870  data WORK.M1RH5DB8;
12871  set WORK.M1RH5DB8 end=_eof_ nobs=_nobs_;
12872  output;
12873  if _eof_ then do;
12874  name = '_SEGMENT_';
12875  ROLE = 'BY';
12876  LEVEL = 'NOMINAL';
12877  LABEL = 'Segment Variable';
12878  TYPE = 'N';
12879  FORMAT = '';
12880  INFORMAT = '';
12881  output;
12882  end;
12883  run;
 
NOTE: There were 4 observations read from the data set WORK.M1RH5DB8.
NOTE: The data set WORK.M1RH5DB8 has 5 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12886  ods listing close;
12887  ods output crosstabfreqs=WORK.TEMPFREQ;
12888  proc freq data = EMWS4.Clus2_TRAIN order=formatted addnames;
12889  table CampaignViewedEmail * _SEGMENT_ / missing;
12890  table FacebookLike * _SEGMENT_ / missing;
12891  table MobileApplications * _SEGMENT_ / missing;
12892  table PreviousCampaign * _SEGMENT_ / missing;
12893  run;
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: View EMWS4.CLUS2_TRAIN.VIEW used (Total process time):
      real time           0.39 seconds
      cpu time            0.39 seconds
 
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: The data set WORK.TEMPFREQ has 60 observations and 15 variables.
NOTE: There were 20035 observations read from the data set EMWS4.CLUS2_TRAIN.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.43 seconds
      cpu time            0.43 seconds
 
 
12894  quit;
12895  ods listing;
12896  data EMWS4.Clus2_PROFILE(keep=_VARIABLE_ _SEGMENT_ TYPE COUNT PERCENT _X_ _XLABEL_);
12897  label _VARIABLE_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel, NOQUOTE))" _SEGMENT_ = "Segment Variable" Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_type_vlabel,         NOQUOTE))" _X_ =
12898     "%sysfunc(sasmsg(sashelp.dmine, rpt_numValue_vlabel, NOQUOTE))" _XLABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_fmtValue_vlabel ,    NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel,        NOQUOTE))" PERCENT =
12899     "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel,      NOQUOTE))";
12900  dsid = open("WORK.TEMPFREQ");
12901  varnum = varnum(dsid, 'ROWVARIABLE');
12902  freqnum = varnum(dsid, 'FREQUENCY');
12903  pvarnum = varnum(dsid, 'PERCENT');
12904  typenum = varnum(dsid, '_TYPE_');
12905  bynum = varnum(dsid, "_SEGMENT_");
12906  length varformat _VARIABLE_ $32 _XLABEL_ $32 TYPE $1;
12907  do while(^fetch(dsid));
12908  count = getvarn(dsid, freqnum);
12909  percent = getvarn(dsid, pvarnum);
12910  _VARIABLE_ = strip(getvarc(dsid, varnum));
12911  varblnum = varnum(dsid, _VARIABLE_);
12912  _SEGMENT_ = getvarn(dsid, bynum);
12913  type = vartype(dsid, varblnum);
12914  varformat = varfmt(dsid, varblnum);
12915  if varformat eq '' then varformat = 'best12.';
12916  _X_=.;
12917  if type = 'N' then do;
12918  _X_ = getvarn(dsid, varblnum);
12919  _XLABEL_ = left(putn(_X_, varformat));
12920  end;
12921  else _XLABEL_ = getvarc(dsid, varblnum);
12922  if getvarc(dsid, typenum) = '11' then output;
12923  end;
12924  dsid = close(dsid);
12925  run;
 
NOTE: The data set EMWS4.CLUS2_PROFILE has 32 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
12926  proc sort data=EMWS4.Clus2_PROFILE NOTHREADS;
12927  by _VARIABLE_ _SEGMENT_;
12928  run;
 
NOTE: There were 32 observations read from the data set EMWS4.CLUS2_PROFILE.
NOTE: The data set EMWS4.CLUS2_PROFILE has 32 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12929  proc means data=EMWS4.Clus2_PROFILE noprint missing NWAY;
12930  class _VARIABLE_ _SEGMENT_;
12931  var COUNT;
12932  output out=WORK.Clus2_STATCOUNT(keep=_SEGMENT_ _VARIABLE_ SUM) SUM=SUM;
12933  run;
 
NOTE: There were 32 observations read from the data set EMWS4.CLUS2_PROFILE.
NOTE: The data set WORK.CLUS2_STATCOUNT has 16 observations and 3 variables.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12934  proc sort data=WORK.Clus2_STATCOUNT NOTHREADS;
12935  by _VARIABLE_ _SEGMENT_;
12936  run;
 
NOTE: There were 16 observations read from the data set WORK.CLUS2_STATCOUNT.
NOTE: The data set WORK.CLUS2_STATCOUNT has 16 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12937  data EMWS4.Clus2_PROFILE(drop=SUM);
12938  label BYPERCENT= "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel, NOQUOTE, _SEGMENT_))";
12939  merge EMWS4.Clus2_PROFILE WORK.Clus2_STATCOUNT;
12940  by _VARIABLE_ _SEGMENT_;
12941  if SUM ne . then BYPERCENT = 100*COUNT/SUM;
12942  run;
 
NOTE: There were 32 observations read from the data set EMWS4.CLUS2_PROFILE.
NOTE: There were 16 observations read from the data set WORK.CLUS2_STATCOUNT.
NOTE: The data set EMWS4.CLUS2_PROFILE has 32 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12943  proc sort data=EMWS4.Clus2_PROFILE NOTHREADS;
12944  by _VARIABLE_;
12945  run;
 
NOTE: There were 32 observations read from the data set EMWS4.CLUS2_PROFILE.
NOTE: The data set EMWS4.CLUS2_PROFILE has 32 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12946  proc sort data=WORK.M1RH5DB8;
12947  by Name;
12948  run;
 
NOTE: There were 5 observations read from the data set WORK.M1RH5DB8.
NOTE: The data set WORK.M1RH5DB8 has 5 observations and 21 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12949  data EMWS4.Clus2_PROFILE;
12950  merge EMWS4.Clus2_PROFILE(in=_a) WORK.M1RH5DB8(keep=Name Label Role rename=(Name=_Variable_ Label=_Label_));
12951  by _Variable_;
12952  label Role = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel ,  NOQUOTE))";
12953  label Label = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel , NOQUOTE))";
12954  if _a then output;
12955  run;
 
NOTE: Variable Label is uninitialized.
WARNING: Multiple lengths were specified for the BY variable _VARIABLE_ by input data sets. This might cause unexpected results.
NOTE: There were 32 observations read from the data set EMWS4.CLUS2_PROFILE.
NOTE: There were 5 observations read from the data set WORK.M1RH5DB8.
NOTE: The data set EMWS4.CLUS2_PROFILE has 32 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12956  proc sort data=EMWS4.Clus2_PROFILE;
12957  by _SEGMENT_ _VARIABLE_ _X_;
12958  run;
 
NOTE: There were 32 observations read from the data set EMWS4.CLUS2_PROFILE.
NOTE: The data set EMWS4.CLUS2_PROFILE has 32 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12959  data EMWS4.Clus2_PROFILE(rename=(_VARIABLE_=Variable _X_=NumericValue _XLABEL_=FmtValue));
12960  set EMWS4.Clus2_PROFILE;
12961  retain orderedValue 0;
12962  label OrderedValue = "%sysfunc(sasmsg(sashelp.dmine, rpt_OrderedValue_vlabel, NOQUOTE))";
12963  by _SEGMENT_ _VARIABLE_;
12964  if first._variable_ then orderedValue=1;
12965  else orderedValue+1;
12966  run;
 
NOTE: There were 32 observations read from the data set EMWS4.CLUS2_PROFILE.
NOTE: The data set EMWS4.CLUS2_PROFILE has 32 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12967  proc transpose data=EMWS4.Clus2_OUTVAR out=WORK.Clus2_OUTVAR(where=(COL1 ^in('IMPUTED','OMITTED')));
12968  var CampaignViewedEmail0--PreviousCampaign1;
12969  where _TYPE_ in('TYPE' 'VARIABLE');
12970  run;
 
NOTE: There were 2 observations read from the data set EMWS4.CLUS2_OUTVAR.
      WHERE _TYPE_ in ('TYPE', 'VARIABLE');
NOTE: The data set WORK.CLUS2_OUTVAR has 8 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12971  *------------------------------------------------------------* ;
12972  * Clus2: DMVQ Variables;
12973  *------------------------------------------------------------* ;
12974  %macro dmvqvars;
12975      CampaignViewedEmail0 CampaignViewedEmail1 FacebookLike0 FacebookLike1
12976     MobileApplications0 MobileApplications1 PreviousCampaign0 PreviousCampaign1
12977  %mend ;
12978
12979
 
12980  data WORK.Clus2_temp;
12981  set EMWS4.Clus2_OUTMEAN;
12982  _idvar_=left(put(_SEGMENT_,4.));
12983  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS2_OUTMEAN.
NOTE: The data set WORK.CLUS2_TEMP has 4 observations and 18 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12984  proc distance data=WORK.Clus2_temp out=EMWS4.Clus2_DISTANCE method=l(2) shape=square;
12985  id _idvar_;
12986  var interval(%dmvqvars);
12987  run;
 
NOTE: The data set EMWS4.CLUS2_DISTANCE has 4 observations and 5 variables.
NOTE: PROCEDURE DISTANCE used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
12988  proc mds data=EMWS4.Clus2_DISTANCE out=WORK.Clus2_mds level=absolute nohist shape=square dim=3;
12989  object _idvar_;
12990  run;
 
NOTE: Convergence assumed because the badness-of-fit criterion 5.911442E-17 is less than or equal to MINCRIT=1E-6.
NOTE: The data set WORK.CLUS2_MDS has 5 observations and 8 variables.
NOTE: PROCEDURE MDS used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12991  quit;
12992  data WORK.Clus2_mds;
12993  set WORK.Clus2_mds;
12994  if _type_ ne 'CONFIG' then delete;
12995  run;
 
NOTE: There were 5 observations read from the data set WORK.CLUS2_MDS.
NOTE: The data set WORK.CLUS2_MDS has 4 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12996  data WORK.Clus2_mds(label="&label" keep=_idvar_ _radius_ dim1 dim2 dim3);
WARNING: Apparent symbolic reference LABEL not resolved.
12997  merge WORK.Clus2_temp WORK.Clus2_mds;
12998  run;
 
NOTE: There were 4 observations read from the data set WORK.CLUS2_TEMP.
NOTE: There were 4 observations read from the data set WORK.CLUS2_MDS.
NOTE: The data set WORK.CLUS2_MDS has 4 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
 
 
12999  options nodate;
13000  title1 "%sysfunc(sasmsg(sashelp.dmine, rpt_ClusterDistance_title, NOQUOTE))";
13001  %plotit(data=WORK.Clus2_mds, datatype=mds, radii=_radius_, labelvar=_idvar_, symtype=circle, symbols='*', gout=WORK.Clus2, gname=DISTANCE, gopts2=nodisplay, gopts=device=GIF, gopplot=cback=white, titlecol=black, labelcol=black, tickcol=black,
13002     framecol=black, post=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD10428_DESKTOP-MVTLU7L_\plotit.ps);
 
                                                                                                                    Types Legend  | CONFIG
                                                                                                                    --------------+---------
                                                                                                                    Symbol Types  | circle
                                                                                                                    Symbols       | *
                                                                                                                    Symbol Colors | cx000000
                                                                                                                    Label  Colors | cx000000
                                                                                                                    Symbol Sizes  | 1
                                                                                                                    Label  Sizes  | 1
                                                                                                                    Symbol Fonts  | none
                                                                                                                    Label  Fonts  | none
                                                                                                                    ------------------------
 
                                                                                                         Iterative Scatter Plot of Labeled Points Macro
 
                                                                                                    Iteration    Place    Line Size    Page Size    Penalty
                                                                                                    -------------------------------------------------------
                                                                                                        1          2         65           45            0
 
The following code will create the printer plot on which the graphical plot is based:
 
options nonumber ls=65 ps=45;
proc plot nolegend formchar='|----|+|---' data=preproc vtoh=2;
   plot Dim2 * Dim1 $ _idvar_ = _symbol_ /
        haxis=by 0.5 vaxis=by 0.5 box list=1
        placement=((h=2 -2 : s=right left) (v=1 -1 * h=0 -1 to -5 by alt));
   label Dim2 = 'Dimension 2' Dim1 = 'Dimension 1';
   label Dim2 = '#' Dim1 = '#';
   run; quit;
 
The plot was created with the following goptions:
 
goptions nodisplay hpos=102 vpos=38 hsize=8.33in vsize=6.24in cback=white device=GIF;
 
The OUT=anno Annotate data set has 185 observations.
The PLOTIT macro used 1.5 seconds to create OUT=anno.
13003  goptions display;
13004  title;
 
13005  filename gsasfile "D:\Nida\Data
13005! mining\datamining\BOGO\Workspaces\EMWS4\Clus2\GRAPH\Distance.gif";
13006  goptions reset=all device=PNG display gaccess= gsasfile gsfmode= replace cback= white;
13007  proc greplay igout=WORK.Clus2 nofs;
NOTE: Building list of graphs from the catalog.
 
NOTE: Enter greplay commands or statements.
13008  replay DISTANCE;
NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this
      session.
NOTE: 28345 bytes written to D:\Nida\Data
      mining\datamining\BOGO\Workspaces\EMWS4\Clus2\GRAPH\Distance.gif.
13009  quit;
 
NOTE: PROCEDURE GREPLAY used (Total process time):
      real time           0.34 seconds
      cpu time            0.34 seconds
 
 
13010  goptions reset=all;
13011  filename gsasfile;
NOTE: Fileref GSASFILE has been deassigned.
 
13012  proc datasets lib=EMWS4 nolist;
13013  modify Clus2_DISTANCE;
13014  rename _idvar_=_SEGMENT_;
NOTE: Renaming variable _idvar_ to _SEGMENT_.
13015  run;
 
NOTE: MODIFY was successful for EMWS4.CLUS2_DISTANCE.DATA.
13016  quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
13017  *------------------------------------------------------------*;
13018  * Clus2: Creating data set for Input Mean report;
13019  *------------------------------------------------------------*;
13020  data temp(drop=_type_ over_all);
13021  set EMWS4.Clus2_OUTSTAT;
13022  where _type_ in('DMDB_MEAN', 'CLUS_MEAN');
13023  run;
 
NOTE: There were 5 observations read from the data set EMWS4.CLUS2_OUTSTAT.
      WHERE _type_ in ('CLUS_MEAN', 'DMDB_MEAN');
NOTE: The data set WORK.TEMP has 5 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13024  proc sort data=temp;
13025  by _SEGMENT_;
13026  run;
 
NOTE: There were 5 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 5 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13027  proc stdize data=temp out=stdtemp pctlpts=0 100 outstat=stat;
13028  var CampaignViewedEmail0--PreviousCampaign1;
13029  run;
 
NOTE: There were 5 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.STDTEMP has 5 observations and 9 variables.
NOTE: The data set WORK.STAT has 10 observations and 9 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13030  proc transpose data=stat out=tstat(rename=(COL1=MEAN COL2=STD COL3=MIN COL4=MAX));
13031  where _type_ in ('LOCATION', 'SCALE','P0', 'P100');
13032  run;
 
NOTE: There were 4 observations read from the data set WORK.STAT.
      WHERE _type_ in ('LOCATION', 'P0', 'P100', 'SCALE');
NOTE: The data set WORK.TSTAT has 8 observations and 6 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13033  data tstat( rename=(_NAME_=NAME) keep=_NAME_ cv stdmin stdmax);
13034  set tstat;
13035  if std ^in (0, .) then do;
13036  stdmin = abs((min-mean)/std);
13037  stdmax = abs((max-mean)/std);
13038  end;
13039  if mean ^in(0, .) then cv = std/mean;
13040  run;
 
NOTE: There were 8 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTAT has 8 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
13041  proc sort data=tstat;
13042  by NAME;
13043  run;
 
NOTE: There were 8 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTAT has 8 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13044  proc transpose data=stdtemp out=tstdtemp(rename=(_NAME_=NAME _LABEL_=LABEL COL1=MEAN));
13045  by _SEGMENT_;
13046  run;
 
NOTE: There were 5 observations read from the data set WORK.STDTEMP.
NOTE: The data set WORK.TSTDTEMP has 40 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13047  proc sort data=tstdtemp;
13048  by NAME;
13049  run;
 
NOTE: There were 40 observations read from the data set WORK.TSTDTEMP.
NOTE: The data set WORK.TSTDTEMP has 40 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13050  data tstdtemp;
13051  merge tstdtemp tstat;
13052  by NAME;
13053  STDMEAN = (MEAN + stdmin)/(stdmin + stdmax);
13054  drop stdmin stdmax mean;
13055  run;
 
NOTE: There were 40 observations read from the data set WORK.TSTDTEMP.
NOTE: There were 8 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTDTEMP has 40 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13056  proc transpose data=EMWS4.Clus2_OUTVAR out=tempVar(drop=_LABEL_ rename=( _NAME_=NAME
13056! VARIABLE=INPUT));
13057  var CampaignViewedEmail0--PreviousCampaign1;
13058  id _type_;
13059  where _type_ = 'VARIABLE';
13060  run;
 
NOTE: There were 1 observations read from the data set EMWS4.CLUS2_OUTVAR.
      WHERE _type_='VARIABLE';
NOTE: The data set WORK.TEMPVAR has 8 observations and 2 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13061  proc sort data=tempVar;
13062  by NAME;
13063  run;
 
NOTE: There were 8 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 8 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13064  data EMWS4.Clus2_INPUTMEAN(rename=(NAME=VARIABLE));
13065  Length _SEGMENT_CHAR_ $7;
13066  label _SEGMENT_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentName_vlabel,  NOQUOTE))"
13066! _SEGMENT_CHAR_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentId_vlabel,    NOQUOTE))" NAME =
13066! "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel,     NOQUOTE))" INPUT =
13067     "%sysfunc(sasmsg(sashelp.dmine, rpt_input_vlabel,        NOQUOTE))" LABEL =
13067! "%sysfunc(sasmsg(sashelp.dmine, rpt_label_vlabel,        NOQUOTE))" CV =
13067! "%sysfunc(sasmsg(sashelp.dmine, rpt_cv_vlabel,           NOQUOTE))" STDMEAN =
13068     "%sysfunc(sasmsg(sashelp.dmine, rpt_normmean_vlabel,     NOQUOTE))";
13069  merge tempvar tstdtemp;
13070  by NAME;
13071  if LABEL='' then LABEL=NAME;
13072  _SEGMENT_CHAR_ = strip(put(_SEGMENT_, best.));
13073  if _SEGMENT_ = . then _SEGMENT_CHAR_='Overall';
13074  run;
 
NOTE: There were 8 observations read from the data set WORK.TEMPVAR.
NOTE: There were 40 observations read from the data set WORK.TSTDTEMP.
NOTE: The data set EMWS4.CLUS2_INPUTMEAN has 40 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
 
 
13075  proc sort data=EMWS4.Clus2_INPUTMEAN;
13076  by descending cv;
13077  run;
 
NOTE: There were 40 observations read from the data set EMWS4.CLUS2_INPUTMEAN.
NOTE: The data set EMWS4.CLUS2_INPUTMEAN has 40 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
13078  *------------------------------------------------------------*;
13079  * Clus2: Determining the important variables;
13080  *------------------------------------------------------------*;
 
13081  %let _nobs = 0;
13082  data keepvars(rename=(NAME=INPUT));
13083  set EMWS4.Clus2_OUTIMPORT(where=(IMPORTANCE>0.5)) end=eof;
13084  if eof then call symput('_nobs', strip(put(_N_, best.)));
13085  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS2_OUTIMPORT.
      WHERE IMPORTANCE>0.5;
NOTE: The data set WORK.KEEPVARS has 4 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13086  proc transpose data=EMWS4.Clus2_OUTVAR out=tempVar(drop=_LABEL_ rename=( _NAME_=NAME
13086! VARIABLE=INPUT));
13087  var CampaignViewedEmail0--PreviousCampaign1;
13088  id _type_;
13089  where _type_ = 'VARIABLE';
13090  run;
 
NOTE: There were 1 observations read from the data set EMWS4.CLUS2_OUTVAR.
      WHERE _type_='VARIABLE';
NOTE: The data set WORK.TEMPVAR has 8 observations and 2 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13091  proc sort data=keepvars;
13092  by INPUT;
13093  run;
 
NOTE: There were 4 observations read from the data set WORK.KEEPVARS.
NOTE: The data set WORK.KEEPVARS has 4 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13094  proc sort data=tempvar;
13095  by INPUT;
13096  run;
 
NOTE: There were 8 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 8 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13097  data vars;
13098  merge tempvar keepvars(in=b);
13099  by INPUT;
13100  if b then output;
13101  run;
 
WARNING: Multiple lengths were specified for the BY variable INPUT by input data sets. This might
         cause unexpected results.
NOTE: There were 8 observations read from the data set WORK.TEMPVAR.
NOTE: There were 4 observations read from the data set WORK.KEEPVARS.
NOTE: The data set WORK.VARS has 8 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13102  proc sort data=vars;
13103  by descending importance;
13104  run;
 
NOTE: There were 8 observations read from the data set WORK.VARS.
NOTE: The data set WORK.VARS has 8 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
13105  data _null_;
13106  set vars;
13107  if _N_=1 then call symput('CLUS_PROFVARS', strip(NAME));
13108  else call symput('CLUS_PROFVARS',symget('CLUS_PROFVARS')!!' '!!strip(NAME));
13109  run;
 
NOTE: There were 8 observations read from the data set WORK.VARS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13110  *------------------------------------------------------------*;
13111  * mergeVarMeansandClusLabel;
13112  *------------------------------------------------------------*;
13113  data temp(keep=_SEGMENT_ &CLUS_PROFVARS);
13114  length _SEGMENT_ &CLUS_PROFVARS 8;
13115  set EMWS4.Clus2_OUTSTAT;
13116  where _type_ ='CLUS_MEAN';
13117  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS2_OUTSTAT.
      WHERE _type_='CLUS_MEAN';
NOTE: The data set WORK.TEMP has 4 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13118  proc sort data=temp;
13119  by _SEGMENT_;
13120  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 4 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13121  data EMWS4.Clus2_LABEL;
13122  merge EMWS4.Clus2_LABEL(keep=_SEGMENT_ LABEL) temp;
13123  by _SEGMENT_;
13124  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS2_LABEL.
NOTE: There were 4 observations read from the data set WORK.TEMP.
NOTE: The data set EMWS4.CLUS2_LABEL has 4 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
