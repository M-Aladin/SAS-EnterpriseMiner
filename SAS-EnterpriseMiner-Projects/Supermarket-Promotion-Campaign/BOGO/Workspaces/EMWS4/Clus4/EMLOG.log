*------------------------------------------------------------*
User:                Mohamed
Date:                May 09, 2018
Time:                15:58:43
Site:                12400032
Platform:            X64_10HOME
Maintenance Release: 9.04.01M4P110916
EM Version:          14.2
* 
*------------------------------------------------------------*
* Training Log
Date:                May 09, 2018
Time:                15:58:31
*------------------------------------------------------------*
11405  proc freq data=EMWS4.Clus4_VariableSet noprint;
11406  table ROLE*LEVEL/out=WORK.Clus4META;
11407  run;
 
NOTE: There were 26 observations read from the data set EMWS4.CLUS4_VARIABLESET.
NOTE: The data set WORK.CLUS4META has 6 observations and 4 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
11408  proc print data=WORK.Clus4META label noobs;
11409  var ROLE LEVEL COUNT;
11410  label ROLE = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel, NOQUOTE))" LEVEL = "%sysfunc(sasmsg(sashelp.dmine, meta_level_vlabel, NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel, NOQUOTE))";
11411  title9 ' ';
11412  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_varSummary_title  , NOQUOTE))";
11413  run;
 
NOTE: There were 6 observations read from the data set WORK.CLUS4META.
NOTE: The PROCEDURE PRINT printed page 1.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
11414  title10;
 
11415  data WORK.M07DGR3T;
11416  set WORK.M07DGR3T;
11417  if role eq 'REJECTED' then role = 'INPUT';
11418  run;
 
NOTE: There were 6 observations read from the data set WORK.M07DGR3T.
NOTE: The data set WORK.M07DGR3T has 6 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
11427  *------------------------------------------------------------*;
11428  * Clus4: Training;
11429  *------------------------------------------------------------*;
11430  *------------------------------------------------------------* ;
11431  * Clus4: DMDBClass Macro ;
11432  *------------------------------------------------------------* ;
11433  %macro DMDBClass;
11434      LoyaltyClass(ASC) REP_Gender(ASC)
11435  %mend DMDBClass;
11436  *------------------------------------------------------------* ;
11437  * Clus4: DMDBVar Macro ;
11438  *------------------------------------------------------------* ;
11439  %macro DMDBVar;
11440      AffluenceGrade DayCareProducts NightRepairProducts TimeSinceLastPurchase
11441  %mend DMDBVar;
11442  *------------------------------------------------------------*;
11443  * Clus4: Create DMDB;
11444  *------------------------------------------------------------*;
11445  proc dmdb batch data=EMWS4.Filter_TRAIN
11446  dmdbcat=WORK.Clus4_DMDB
11447  maxlevel = 513
11448  out=WORK.Clus4_DMDB
11449  ;
11450  class %DMDBClass;
11451  var %DMDBVar;
11452  run;
 
NOTE: Records processed = 20035   Memory used = 511K.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: View EMWS4.FILTER_TRAIN.VIEW used (Total process time):
      real time           0.28 seconds
      cpu time            0.26 seconds
 
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: The data set WORK.CLUS4_DMDB has 20035 observations and 6 variables.
NOTE: PROCEDURE DMDB used (Total process time):
      real time           0.32 seconds
      cpu time            0.31 seconds
 
 
11453  quit;
11454  *--- end code ---*;
 
11455  *------------------------------------------------------------* ;
11456  * Clus4: Interval Inputs Macro ;
11457  *------------------------------------------------------------* ;
11458  %macro DMVQINTERVAL;
11459      AffluenceGrade DayCareProducts NightRepairProducts TimeSinceLastPurchase
11460  %mend DMVQINTERVAL;
11461  *------------------------------------------------------------* ;
11462  * Clus4: Nominal Inputs Macro ;
11463  *------------------------------------------------------------* ;
11464  %macro DMVQNOMINAL;
11465      LoyaltyClass REP_Gender
11466  %mend DMVQNOMINAL;
11467  *------------------------------------------------------------*;
11468  * Clus4: Run DMVQ procedure;
11469  *------------------------------------------------------------*;
11470  title;
11471  options nodate;
11472  proc dmvq data=WORK.Clus4_DMDB dmdbcat=WORK.Clus4_DMDB std=STD nominal=GLM ordinal=RANK
11473  ;
NOTE: The training set WORK.CLUS4_DMDB.DATA has 6 variable(s).
NOTE: The DMVQ statement has finished with return code=0 and status=begin.
11474  input %DMVQINTERVAL / level=interval;
NOTE: 4 input variable(s) defined for ID=I1.
NOTE: The INPUT statement has finished with return code=0 and status=variables.
11475  input %DMVQNOMINAL / level=nominal;
NOTE: 2 input variable(s) defined for ID=I2.
NOTE: The INPUT statement has finished with return code=0 and status=variables.
11476  VQ maxc = 4 clusname=_SEGMENT_ CLUSLABEL="Segment Id" DISTLABEL="Distance";
NOTE: A maximum of 4 clusters have been requested.
NOTE: The VQ statement has finished with return code=0 and status=architecture.
11477  MAKE outvar=EMWS4.Clus4_OUTVAR;
 
NOTE: 6 input variable(s).
NOTE: Number of cases=20035
NOTE: Sum of frequencies=20035
NOTE: Sum of weights=20035
NOTE: VARDEF=DF
NOTE: Maximum number of categories=4
NOTE: The total number of variables is 6 with dimensionality 11.
NOTE: 6 variables will be used for clustering.
NOTE: Open output data set EMWS4.CLUS4_OUTVAR.DATA with 12 variables.
NOTE: The data set EMWS4.CLUS4_OUTVAR has 4 observations and 12 variables.
NOTE: The MAKE statement has finished with return code=0 and status=made.
11478  INITIAL radius=0
11479  ;
NOTE: 4 seeds were selected from data set WORK.CLUS4_DMDB.DATA using the SEPARATE algorithm.
NOTE: The INITIAL statement has finished with return code=0 and status=initialized.
11480  TRAIN tech=FORGY
11481  ;
NOTE: F-Convergence criterion is satisfied.
NOTE: The TRAIN statement has finished with return code=0 and status=trained.
11482  SAVE outstat=EMWS4.Clus4_OUTSTAT outmean=EMWS4.Clus4_OUTMEAN;
NOTE: The data set EMWS4.CLUS4_OUTSTAT has 40 observations and 14 variables.
NOTE: The data set EMWS4.CLUS4_OUTMEAN has 4 observations and 20 variables.
NOTE: The SAVE statement has finished with return code=0 and status=statistics.
11483  code file="D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus4\DMVQSCORECODE.sas"
11484  group=Clus4
11485  ;
NOTE: External file D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus4\DMVQSCORECODE.sas opened.
NOTE: The CODE statement has finished with return code=0 and status=statistics.
11486  run;
 
11487  quit;
 
NOTE: There were 20035 observations read from the data set WORK.CLUS4_DMDB.
NOTE: PROCEDURE DMVQ used (Total process time):
      real time           0.12 seconds
      cpu time            0.11 seconds
 
 
11488  libname _spdslib;
WARNING: Libref _SPDSLIB is not assigned.
 
11489  *------------------------------------------------------------*;
11490  * Clus4: Cluster Label;
11491  *------------------------------------------------------------*;
11492  data EMWS4.Clus4_LABEL;
11493  length _SEGMENT_ 8 Label $80;
11494  format _SEGMENT_ 4.;
11495  label _SEGMENT_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentName_vlabel,  NOQUOTE))";
11496  label Label = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentLabel_vlabel,  NOQUOTE))";
11497  _SEGMENT_= 1;
11498  Label='Cluster1';
11499  output;
11500  _SEGMENT_= 2;
11501  Label='Cluster2';
11502  output;
11503  _SEGMENT_= 3;
11504  Label='Cluster3';
11505  output;
11506  _SEGMENT_= 4;
11507  Label='Cluster4';
11508  output;
11509  run;
 
NOTE: The data set EMWS4.CLUS4_LABEL has 4 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
*------------------------------------------------------------*
* Score Log
Date:                May 09, 2018
Time:                15:58:33
*------------------------------------------------------------*
11611  proc transpose data=EMWS4.Clus4_OUTVAR out=WORK.Clus4_OUTVAR(rename=(COl2=NAME) where=(COL1='IMPUTED'));
11612  var AffluenceGrade--REP_GenderU;
11613  where _TYPE_ in('TYPE' 'VARIABLE');
11614  run;
 
NOTE: There were 2 observations read from the data set EMWS4.CLUS4_OUTVAR.
      WHERE _TYPE_ in ('TYPE', 'VARIABLE');
NOTE: The data set WORK.CLUS4_OUTVAR has 0 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
11615  proc sort data=WORK.Clus4_OUTVAR;
11616  by NAME;
11617  run;
 
NOTE: Input data set is empty.
NOTE: The data set WORK.CLUS4_OUTVAR has 0 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
11618  proc sort data=EMWS4.Clus4_VariableSet(KEEP=NAME ROLE LEVEL) out=WORK.Clus4_SORTEDVARS;
11619  by NAME;
11620  run;
 
NOTE: There were 26 observations read from the data set EMWS4.CLUS4_VARIABLESET.
NOTE: The data set WORK.CLUS4_SORTEDVARS has 26 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
11621  data WORK.Clus4_OUTVAR;
11622  merge WORK.Clus4_OUTVAR(in=INVAR) WORK.Clus4_SORTEDVARS;
11623  by NAME;
11624  if INVAR then output;
11625  run;
 
WARNING: Multiple lengths were specified for the BY variable NAME by input data sets. This might cause unexpected results.
NOTE: There were 0 observations read from the data set WORK.CLUS4_OUTVAR.
NOTE: There were 26 observations read from the data set WORK.CLUS4_SORTEDVARS.
NOTE: The data set WORK.CLUS4_OUTVAR has 0 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this session.
11626  filename emflow "D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus4\EMFLOWSCORE.sas";
11627  *------------------------------------------------------------*;
11628  * Clus4: Scoring DATA data;
11629  *------------------------------------------------------------*;
11630  data EMWS4.Clus4_TRAIN
11631  / view=EMWS4.Clus4_TRAIN
11632  ;
11633  set EMWS4.Filter_TRAIN
11634  ;
11635  %inc emflow;
11872  run;
 
NOTE: DATA STEP view saved on file EMWS4.CLUS4_TRAIN.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS4.FILTER_TRAIN.VIEW used (Total process time):
      real time           0.25 seconds
      cpu time            0.23 seconds
 
NOTE: DATA statement used (Total process time):
      real time           0.26 seconds
      cpu time            0.25 seconds
 
 
11873  quit;
11874  filename emflow;
NOTE: Fileref EMFLOW has been deassigned.
 
11875  *------------------------------------------------------------*;
11876  * Clus4: Computing metadata for TRAIN data;
11877  *------------------------------------------------------------*;
 
NOTE: View EMWS4.CLUS4_TRAIN.VIEW used (Total process time):
      real time           0.20 seconds
      cpu time            0.20 seconds
 
NOTE: View EMWS4.CLUS4_TRAIN.VIEW used (Total process time):
      real time           0.21 seconds
      cpu time            0.21 seconds
 
*------------------------------------------------------------*
* Report Log
Date:                May 09, 2018
Time:                15:58:34
*------------------------------------------------------------*
12287  data WORK.M2_Q9PVF;
12288  set WORK.M2_Q9PVF;
12289  if role eq 'REJECTED' then role = 'INPUT';
12290  run;
 
NOTE: There were 6 observations read from the data set WORK.M2_Q9PVF.
NOTE: The data set WORK.M2_Q9PVF has 6 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12291  data WORK.M2_Q9PVF;
12292  set WORK.M2_Q9PVF end=_eof_ nobs=_nobs_;
12293  output;
12294  if _eof_ then do;
12295  name = '_SEGMENT_';
12296  ROLE = 'TARGET';
12297  LEVEL = 'NOMINAL';
12298  LABEL = 'Segment Variable';
12299  TYPE = 'N';
12300  FORMAT = '';
12301  INFORMAT = '';
12302  USE='Y';
12303  output;
12304  end;
12305  run;
 
NOTE: There were 6 observations read from the data set WORK.M2_Q9PVF.
NOTE: The data set WORK.M2_Q9PVF has 7 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12306  *------------------------------------------------------------*;
12307  * Clus4: Create decision matrix;
12308  *------------------------------------------------------------*;
12309  *------------------------------------------------------------* ;
12310  * Clus4: Tree Variables Macro ;
12311  *------------------------------------------------------------* ;
12312  %macro EM_TREEVARS;
12313      AffluenceGrade DayCareProducts LoyaltyClass NightRepairProducts REP_Gender
12314     TimeSinceLastPurchase
12315  %mend EM_TREEVARS;
12316  *------------------------------------------------------------* ;
12317  * Clus4: Tree Targets Macro ;
12318  *------------------------------------------------------------* ;
12319  %macro EM_TREETARGETS;
12320      _SEGMENT_
12321  %mend EM_TREETARGETS;
12322  data EMWS4.EM_Clus4 / view=EMWS4.EM_Clus4;
12323  set EMWS4.Clus4_TRAIN(keep=%EM_TREEVARS %EM_TREETARGETS);
12324  run;
 
NOTE: DATA STEP view saved on file EMWS4.EM_CLUS4.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: View EMWS4.CLUS4_TRAIN.VIEW used (Total process time):
      real time           0.18 seconds
      cpu time            0.17 seconds
 
NOTE: DATA statement used (Total process time):
      real time           0.20 seconds
      cpu time            0.18 seconds
 
 
12325  *------------------------------------------------------------* ;
12326  * Clus4: Interval Inputs Macro ;
12327  *------------------------------------------------------------* ;
12328  %macro INTINPUTS;
12329      AffluenceGrade DayCareProducts NightRepairProducts TimeSinceLastPurchase
12330  %mend INTINPUTS;
12331  *------------------------------------------------------------* ;
12332  * Clus4: Binary and Nominal Inputs Macro ;
12333  *------------------------------------------------------------* ;
12334  %macro NOMINPUTS;
12335      LoyaltyClass REP_Gender
12336  %mend NOMINPUTS;
12337  *------------------------------------------------------------* ;
12338  * Clus4: Ordinal Inputs Macro ;
12339  *------------------------------------------------------------* ;
12340  %macro ORDINPUTS;
12341
12342  %mend ORDINPUTS;
12343  *------------------------------------------------------------*;
12344  * Clus4: Run ARBOR procedure;
12345  *------------------------------------------------------------*;
 
12346  proc arbor data=EMWS4.EM_Clus4
12347  MAXSURRS=5
12348  ;
12349  ;
12350  input %INTINPUTS
12351  / level = interval;
12352  input %NOMINPUTS
12353  / level=nominal;
12354  target _SEGMENT_ / level=NOMINAL
12355  Criterion=PROBCHISQ
12356  ;
12357  ;
12358  Performance DISK
12359  ;
12360  MAKEMACRO NLEAVES=nleaves;
NOTE: 1385333 kilobytes of physical memory.
NOTE: Will use 20035 out of 20035 training cases.
NOTE: Using memory pool with 183419904 bytes.
NOTE: Passed training data 18 times.
NOTE: Training used 2728520 bytes of work memory.
NOTE: The subtree sequence contains 29 subtrees. The largest has 57 nodes and 29 leaves.
NOTE: Using subtree with 47 nodes and 24 leaves.
NOTE: Created macro variable NLEAVES equal to 24.
12361  save
12362  MODEL=EMWS4.Clus4_PLOTDS
12363  SEQUENCE=EMWS4.Clus4_OUTSEQ
12364  IMPORTANCE=EMWS4.Clus4_OUTIMPORT
12365  NODESTAT=EMWS4.Clus4_OUTNODES
12366  SUMMARY=WORK.OUTSUMMARY_TREE_183W0CK
12367  STATSBYNODE=WORK.OUTSTATS_TREE_183W0CK
12368  Pathlistnonmissing = WORK.OUTPATH_TREE_183W0CK
12369  Rules = WORK.OUTRULES_TREE_183W0CK
12370  ;
NOTE: The data set EMWS4.CLUS4_OUTIMPORT has 6 observations and 5 variables.
NOTE: The data set EMWS4.CLUS4_PLOTDS has 1945 observations and 4 variables.
NOTE: The data set EMWS4.CLUS4_OUTNODES has 47 observations and 24 variables.
NOTE: The data set WORK.OUTPATH_TREE_183W0CK has 214 observations and 7 variables.
NOTE: The data set WORK.OUTRULES_TREE_183W0CK has 526 observations and 6 variables.
NOTE: The data set EMWS4.CLUS4_OUTSEQ has 29 observations and 11 variables.
NOTE: The data set WORK.OUTSTATS_TREE_183W0CK has 282 observations and 5 variables.
NOTE: The data set WORK.OUTSUMMARY_TREE_183W0CK has 20 observations and 7 variables.
12371  run;
 
12372  quit;
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: View EMWS4.EM_CLUS4.VIEW used (Total process time):
      real time           1.84 seconds
      cpu time            1.84 seconds
 
NOTE: There were 20035 observations read from the data set EMWS4.CLUS4_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.EM_CLUS4.
NOTE: The data set WORK._NAMEDAT has 4 observations and 5 variables.
NOTE: PROCEDURE ARBOR used (Total process time):
      real time           1.85 seconds
      cpu time            1.85 seconds
 
 
12373  data EMWS4.Clus4_OUTIMPORT;
12374  set EMWS4.Clus4_OUTIMPORT;
12375  label NAME = "%sysfunc(sasmsg(sashelp.dmine, meta_name_vlabel, noquote))" LABEL = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel, noquote))" NRULES = "%sysfunc(sasmsg(sashelp.dmine, rpt_nrules_vlabel, noquote))" IMPORTANCE =
12376     "%sysfunc(sasmsg(sashelp.dmine, rpt_importance_vlabel, noquote))" NSURROGATES = "%sysfunc(sasmsg(sashelp.dmine, rpt_nsurrogates_vlabel, noquote))"
12377  ;
12378  run;
 
NOTE: There were 6 observations read from the data set EMWS4.CLUS4_OUTIMPORT.
NOTE: The data set EMWS4.CLUS4_OUTIMPORT has 6 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12379  filename x "D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus4\ENGLISHRULES.txt" encoding='utf-8' NOBOM;
 
12380  data temp;
12381  length varname $21;
12382  retain varname;
12383  set WORK.OUTPATH_TREE_183W0CK;
12384  if ^missing(variable) then varname=variable;
12385  else if ^missing(var_name) then varname=var_name;
12386  output;
12387  run;
 
NOTE: There were 214 observations read from the data set WORK.OUTPATH_TREE_183W0CK.
NOTE: The data set WORK.TEMP has 214 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12388  proc sort data=temp;
12389  by node;
12390  run;
 
NOTE: There were 214 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 214 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12391  proc sort data=EMWS4.Clus4_OUTNODES out=outnodes;
12392  by node;
12393  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_OUTNODES.
NOTE: The data set WORK.OUTNODES has 47 observations and 24 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12394  data temp;
12395  merge temp(in=_a) outnodes(keep= node
12396  NPRIORS
12397  P__SEGMENT_3
12398  P__SEGMENT_4
12399  P__SEGMENT_2
12400  P__SEGMENT_1
12401  );
12402  by node;
12403  if _a;
12404  run;
 
NOTE: There were 214 observations read from the data set WORK.TEMP.
NOTE: There were 47 observations read from the data set WORK.OUTNODES.
NOTE: The data set WORK.TEMP has 214 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12405  proc sort data=temp;
12406  by node descending varname descending numeric_value;
12407  run;
 
NOTE: There were 214 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 214 observations and 13 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12408  data _null_;
12409  file x;
12410  set temp;
12411  by node descending varname;
12412  retain origvar oldnode string;
12413  length origvar $32 oldnode 8 string $200;
12414  if _n_ = 1 then do;
12415  origvar = varname;
12416  oldnode = node;
12417  end;
12418  if first.node then do;
12419  put "&EM_CODEBAR";
12420  put " Node = " node;
12421  put "&EM_CODEBAR";
12422  end;
12423  if first.varname then do;
12424  if RELATION ^in ("=", "ISMISSING", "ISNOTMISSING") then do;
12425  if MISSING(CHARACTER_VALUE) then do;
12426  if NUMERIC_VALUE ne . then do;
12427  if ^first.node then do;
12428  string= "AND "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12429  end;
12430  else do;
12431  string= "if "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12432  end;
12433  end;
12434  end;
12435  else do;
12436  if ^first.node then do;
12437  string= "AND "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12438  end;
12439  else do;
12440  string= "if "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12441  end;
12442  end;
12443  end;
12444  else if RELATION in ("=") then do;
12445  if ^first.node then do;
12446  string = "AND "||strip(varname) ||" IS ONE OF: "||character_value;
12447  end;
12448  else do;
12449  string = "if "|| strip(varname) ||" IS ONE OF: "||character_value;
12450  end;
12451  end;
12452  else if RELATION in ("ISMISSING") then do;
12453  if ^first.node then do;
12454  string = " AND "|| strip(varname) || " equals Missing";
12455  end;
12456  else do;
12457  string = "if "|| strip(varname) ||" equals Missing";
12458  end;
12459  end;
12460  else if RELATION in ("ISNOTMISSING") then do;
12461  if ^first.node then do;
12462  string = " AND "|| strip(varname) || " equals All Values";
12463  end;
12464  else do;
12465  string = "if "|| strip(varname) ||" equals All Values";
12466  end;
12467  end;
12468  if ^missing(varname) then origvar = varname;
12469  oldnode=node;
12470  end;
12471  else do;
12472  if RELATION ^in ("=", "ISMISSING", "ISNOTMISSING") then do;
12473  if MISSING(CHARACTER_VALUE) then do;
12474  if NUMERIC_VALUE ne . then do;
12475  if ^MISSING(string) then string= strip(string)||" AND "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12476  else string= " if "|| strip(varname)||" "||strip(relation)||" "||strip(numeric_value);
12477  end;
12478  end;
12479  else do;
12480  if ^MISSING(string) then string= strip(string)||" AND "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12481  else string= " if "|| strip(varname)||" "||strip(relation)||" "||strip(character_value);
12482  end;
12483  end;
12484  else if RELATION in ("=") then do;
12485  string = strip(string)||", "||strip(character_value);
12486  end;
12487  else if RELATION in ("ISMISSING") then do;
12488  end;
12489  if ^missing(varname) then origvar = varname;
12490  oldnode=node;
12491  end;
12492  if last.varname then do;
12493  if RELATION in ("ISMISSING") then do;
12494  if ^first.varname then do;
12495  string = strip(string) || " or MISSING";
12496  end;
12497  end;
12498  put string;
12499  if ^missing(varname) then origvar = varname;
12500  oldnode=node;
12501  end;
12502  if last.node then do;
12503  put "then ";
12504  put " Tree Node Identifier   = " node;
12505  put " Number of Observations = " NPRIORS;
12506  put " Predicted: _SEGMENT_=3  = " P__SEGMENT_3;
12507  put " Predicted: _SEGMENT_=4  = " P__SEGMENT_4;
12508  put " Predicted: _SEGMENT_=2  = " P__SEGMENT_2;
12509  put " Predicted: _SEGMENT_=1  = " P__SEGMENT_1;
12510  put " ";
12511  if ^missing(varname) then origvar = varname;
12512  oldnode=node;
12513  end;
12514  run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      12428:67    12431:66    12475:108   12476:72
NOTE: The file X is:
      Filename=D:\Nida\Data mining\datamining\BOGO\Workspaces\EMWS4\Clus4\ENGLISHRULES.txt,
      RECFM=V,LRECL=131068,File Size (bytes)=0,
      Last Modified=09May2018:15:58:37,
      Create Time=09May2018:15:58:37
 
NOTE: 347 records were written to the file X.
      The minimum record length was 1.
      The maximum record length was 71.
NOTE: There were 214 observations read from the data set WORK.TEMP.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12515  filename x;
NOTE: Fileref X has been deassigned.
 
12516  /* belowtext */
12517  data templabel;
12518  set WORK.OUTRULES_TREE_183W0CK;
12519  if ((ROLE="PRIMARY") AND (STAT ="LABEL"));
12520  rename character_value = belowtext;
12521  keep NODE character_value;
12522  run;
 
NOTE: There were 526 observations read from the data set WORK.OUTRULES_TREE_183W0CK.
NOTE: The data set WORK.TEMPLABEL has 0 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12523  data tempvar;
12524  set WORK.OUTRULES_TREE_183W0CK;
12525  if ((ROLE="PRIMARY") AND (STAT="VARIABLE"));
12526  keep NODE character_value;
12527  run;
 
NOTE: There were 526 observations read from the data set WORK.OUTRULES_TREE_183W0CK.
NOTE: The data set WORK.TEMPVAR has 23 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12528  proc sort data=templabel;
12529  by node;
12530  run;
 
NOTE: Input data set is empty.
NOTE: The data set WORK.TEMPLABEL has 0 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12531  proc sort data=tempvar;
12532  by node;
12533  run;
 
NOTE: There were 23 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 23 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12534  data tempbelow;
12535  merge templabel tempvar;
12536  by node;
12537  if missing(belowtext) then belowtext= character_value;
12538  keep node belowtext;
12539  run;
 
NOTE: There were 0 observations read from the data set WORK.TEMPLABEL.
NOTE: There were 23 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPBELOW has 23 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12540  proc sort data=tempbelow;
12541  by node;
12542  run;
 
NOTE: There were 23 observations read from the data set WORK.TEMPBELOW.
NOTE: The data set WORK.TEMPBELOW has 23 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12543  /* abovetext */
12544  data tempoutrules;
12545  set WORK.OUTRULES_TREE_183W0CK;
12546  if ((ROLE='PRIMARY') AND(STAT in ("INTERVAL", "ORDINAL", "NOMINAL")));
12547  run;
 
NOTE: There were 526 observations read from the data set WORK.OUTRULES_TREE_183W0CK.
NOTE: The data set WORK.TEMPOUTRULES has 23 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12548  proc sort data=tempoutrules;
12549  by node numeric_value;
12550  run;
 
NOTE: There were 23 observations read from the data set WORK.TEMPOUTRULES.
NOTE: The data set WORK.TEMPOUTRULES has 23 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12551  data tempabove;
12552  set tempoutrules(rename=(node=parent));
12553  by parent numeric_value;
12554  retain abovetext tempstring flag branch origval origchar;
12555  *length abovetext tempstring origchar $45;
12556  length abovetext $256;
12557  length tempstring origchar $64;
12558  if STAT in ("INTERVAL", "ORDINAL") then do;
12559  if first.parent then do;
12560  if missing(character_value) then do;
12561  numeric_value = round(numeric_value, 0.0001);
12562  abovetext = "< "||strip(NUMERIC_VALUE);
12563  branch = 1;
12564  origval = numeric_value;
12565  output;
12566  end;
12567  else do;
12568  abovetext = "< "||strip(CHARACTER_VALUE);
12569  branch = 1;
12570  origchar = character_value;
12571  output;
12572  end;
12573  if first.parent AND last.parent then do;
12574  if missing(character_value) then do;
12575  numeric_value = round(numeric_value, 0.0001);
12576  branch = branch + 1;
12577  abovetext = ">= "||strip(NUMERIC_VALUE);
12578  output;
12579  end;
12580  else do;
12581  branch = branch + 1;
12582  abovetext = ">= "||strip(CHARACTER_VALUE);
12583  output;
12584  end;
12585  end;
12586  end;
12587  else if last.parent then do;
12588  if ( missing(character_value) AND (origval ne numeric_value)) or ( ^missing(character_value) AND (origchar ne character_value)) then do;
12589  if missing(character_value) then do;
12590  numeric_value = round(numeric_value, 0.0001);
12591  abovetext= "[ "||strip(origval)||", "|| strip(numeric_value)||" )";
12592  end;
12593  else do;
12594  abovetext= ">= "||strip(origchar)||" AND < "|| strip(character_value);
12595  end;
12596  branch = branch + 1;
12597  output;
12598  if missing(character_value) then do;
12599  numeric_value = round(numeric_value, 0.0001);
12600  abovetext = ">= "||strip(NUMERIC_VALUE);
12601  end;
12602  else do;
12603  abovetext = ">= "||strip(CHARACTER_VALUE);
12604  end;
12605  branch = branch + 1;
12606  output;
12607  end;
12608  else do;
12609  if missing(character_value) then do;
12610  numeric_value = round(numeric_value, 0.0001);
12611  abovetext = ">= "||strip(NUMERIC_VALUE);
12612  end;
12613  else do;
12614  abovetext = ">= "||strip(CHARACTER_VALUE);
12615  end;
12616  branch = branch + 1;
12617  output;
12618  end;
12619  end;
12620  else do;
12621  if ( missing(character_value) AND (origval ne numeric_value)) or ( ^missing(character_value) AND (origchar ne character_value)) then do;
12622  if missing(character_value) then do;
12623  numeric_value = round(numeric_value,0.0001);
12624  abovetext= "[ "||strip(origval)||", "|| strip(numeric_value)||" )";
12625  origval = numeric_value;
12626  end;
12627  else do;
12628  abovetext= ">= "||strip(origchar)||" AND < "|| strip(character_value);
12629  origchar = character_value;
12630  end;
12631  branch = branch + 1;
12632  output;
12633  end;
12634  else do;
12635  if missing(character_value) then do;
12636  numeric_value = round(numeric_value, 0.0001);
12637  abovetext = ">= "||strip(NUMERIC_VALUE);
12638  origval = numeric_value;
12639  end;
12640  else do;
12641  abovetext = ">= "||strip(CHARACTER_VALUE);
12642  origval = character_value;
12643  end;
12644  branch = branch + 1;
12645  output;
12646  end;
12647  end;
12648  end;
12649  else do;
12650  if first.numeric_value then do;
12651  flag = 0;
12652  abovetext = CHARACTER_VALUE;
12653  branch = numeric_value;
12654  if first.numeric_value AND last.numeric_value then do;
12655  output;
12656  end;
12657  end;
12658  else if last.numeric_value then do;
12659  if flag=0 then do;
12660  tempstring = strip(abovetext)||", "||CHARACTER_VALUE;
12661  length = length(strip(tempstring));
12662  if length < 32 then do;
12663  abovetext = strip(tempstring);
12664  end;
12665  else do;
12666  abovetext = strip(abovetext)||", ...";
12667  flag = 1;
12668  end;
12669  end;
12670  branch = numeric_value;
12671  output;
12672  end;
12673  else do;
12674  if flag=0 then do;
12675  tempstring = strip(abovetext)||", "||CHARACTER_VALUE;
12676  length = length(strip(tempstring));
12677  if length < 32 then do;
12678  abovetext = strip(tempstring);
12679  end;
12680  else do;
12681  abovetext = strip(abovetext)||", ...";
12682  flag=1;
12683  end;
12684  end;
12685  branch = numeric_value;
12686  end;
12687  end;
12688  keep parent branch abovetext;
12689  run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      12562:25   12577:26   12591:24   12591:47   12600:26   12611:26   12624:24   12624:47   12637:26
NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      12642:11
NOTE: There were 23 observations read from the data set WORK.TEMPOUTRULES.
NOTE: The data set WORK.TEMPABOVE has 46 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
 
 
12690  /* MIssing value to abovetext */
12691  data tempmissing;
12692  set WORK.OUTRULES_TREE_183W0CK;
12693  if ((ROLE="PRIMARY") AND (STAT in ("MISSING")));
12694  rename node=parent numeric_value=branch character_value=misschar;
12695  run;
 
NOTE: There were 526 observations read from the data set WORK.OUTRULES_TREE_183W0CK.
NOTE: The data set WORK.TEMPMISSING has 23 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12696  proc sort data=work.tempabove;
12697  by parent branch;
12698  run;
 
NOTE: There were 46 observations read from the data set WORK.TEMPABOVE.
NOTE: The data set WORK.TEMPABOVE has 46 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12699  proc sort data=EMWS4.Clus4_OUTNODES out=tempoutnodes;
12700  by parent branch;
12701  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_OUTNODES.
NOTE: The data set WORK.TEMPOUTNODES has 47 observations and 24 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12702  proc sort data=tempmissing;
12703  by parent branch;
12704  run;
 
NOTE: There were 23 observations read from the data set WORK.TEMPMISSING.
NOTE: The data set WORK.TEMPMISSING has 23 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12705  data WORK.Clus4_outnodes;
12706  merge work.tempabove tempoutNodes(drop=abovetext ) tempmissing(in=_a);
12707  by parent branch;
12708  length traintotal validtotal 8;
12709  retain traintotal validtotal;
12710  if _a then do;
12711  if ^MISSING(abovetext) then do;
12712  abovetext= strip(abovetext)||" %sysfunc(sasmsg(sashelp.dmine, tree_ormiss_vlabel, noquote))";
12713  end;
12714  else do;
12715  abovetext = " %sysfunc(sasmsg(sashelp.dmine, tree_missonly_vlabel, noquote))";
12716  end;
12717  end;
12718  if MISSING(abovetext) then abovetext="%sysfunc(sasmsg(sashelp.dmine, tree_nonmiss_vlabel, noquote))";
12719  if node=1 then do;
12720  traintotal = N;
12721  validtotal=VN;
12722  end;
12723  label traintotal = "%sysfunc(sasmsg(sashelp.dmine,  rpt_traintotal_vlabel, noquote))";
12724  drop role rank stat misschar belowtext;
12725  run;
 
NOTE: Variable VN is uninitialized.
NOTE: There were 46 observations read from the data set WORK.TEMPABOVE.
NOTE: There were 47 observations read from the data set WORK.TEMPOUTNODES.
NOTE: There were 23 observations read from the data set WORK.TEMPMISSING.
NOTE: The data set WORK.CLUS4_OUTNODES has 47 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           0.06 seconds
      cpu time            0.06 seconds
 
 
12726  proc sort data=WORK.Clus4_outnodes;
12727  by node;
12728  run;
 
NOTE: There were 47 observations read from the data set WORK.CLUS4_OUTNODES.
NOTE: The data set WORK.CLUS4_OUTNODES has 47 observations and 26 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12729  proc sort data=tempbelow;
12730  by node;
12731  run;
 
NOTE: Input data set is already sorted, no sorting done.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12732  data WORK.Clus4_outnodes;
12733  merge WORK.Clus4_outnodes tempbelow;
12734  by node;
12735  run;
 
NOTE: There were 47 observations read from the data set WORK.CLUS4_OUTNODES.
NOTE: There were 23 observations read from the data set WORK.TEMPBELOW.
NOTE: The data set WORK.CLUS4_OUTNODES has 47 observations and 27 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: View EMWS4.EM_CLUS4.VIEW used (Total process time):
      real time           0.48 seconds
      cpu time            0.48 seconds
 
NOTE: There were 20035 observations read from the data set EMWS4.CLUS4_TRAIN.
12736  data tempoutstats;
12737  set WORK.OUTSTATS_TREE_183W0CK;
12738  length tarlevel $8;
12739  tarlevel ="NOMINAL";
12740  run;
 
NOTE: There were 282 observations read from the data set WORK.OUTSTATS_TREE_183W0CK.
NOTE: The data set WORK.TEMPOUTSTATS has 282 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12741  data EMWS4.Clus4_TREE_PLOT;
12742  length NODETEXT TEXTALL $800 N NODECOLOR 8;
12743  set WORK.Clus4_outnodes;
12744  label parent = "%sysfunc(sasmsg(sashelp.dmine, rpt_parentID_vlabel, noquote))" depth = "%sysfunc(sasmsg(sashelp.dmine, rpt_depth_vlabel, noquote))" belowtext= "%sysfunc(sasmsg(sashelp.dmine, rpt_belowtext_vlabel, noquote))" abovetext =
12745     "%sysfunc(sasmsg(sashelp.dmine, rpt_abovetext_vlabel, noquote))" linkwidth = "%sysfunc(sasmsg(sashelp.dmine, rpt_linkwidth_vlabel, noquote))" nodetext = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodetext_vlabel, noquote))" textall =
12746     "%sysfunc(sasmsg(sashelp.dmine, rpt_textall_vlabel, noquote))" N = "%sysfunc(sasmsg(sashelp.dmine, rpt_trainn_vlabel, noquote))" nodecolor = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodecolor_vlabel, noquote))" node =
12747     "%sysfunc(sasmsg(sashelp.dmine, rpt_node_vlabel, noquote))";
12748  keep NODE PARENT DEPTH BELOWTEXT ABOVETEXT LINKWIDTH NODETEXT TEXTALL N NODECOLOR;
12749  run;
 
NOTE: Variable TEXTALL is uninitialized.
NOTE: Variable NODECOLOR is uninitialized.
NOTE: There were 47 observations read from the data set WORK.CLUS4_OUTNODES.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
12750  proc sort data=EMWS4.Clus4_TREE_PLOT;
12751  by node;
12752  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_TREE_PLOT.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12753  proc sort data=tempoutstats;
12754  by node;
12755  run;
 
NOTE: There were 282 observations read from the data set WORK.TEMPOUTSTATS.
NOTE: The data set WORK.TEMPOUTSTATS has 282 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12756  data EMWS4.Clus4_TREE_PLOT;
12757  merge EMWS4.Clus4_TREE_PLOT tempoutstats;
12758  length text $800 _RASE_ P__SEGMENT_3 8;
12759  retain P__SEGMENT_3 eventlevel;
12760  by node;
12761  if statname='N' then N=statvalue;
12762  if statname='NPRIORS' then N=statvalue;
12763  if statname='PREDICTION' then eventlevel=category;
12764  _RASE_ = .;
12765  if tarlevel ^= 'INTERVAL' then do;
12766  if STATNAME = 'PROBABILITY' then do;
12767  if CATEGORY=EVENTLEVEL then do;
12768  nodetext = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12769  text = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12770  P__SEGMENT_3 = round(STATVALUE, .01);
12771  end;
12772  else do;
12773  text = right(put(strip(CATEGORY)||':', $12.))|| right(put(STATVALUE, percent13.1));
12774  end;
12775  textall = strip(textall)||'0A'x||strip( text);
12776  end;
12777  if last.node then do;
12778  nodetext = trim(nodetext)||'0A'x||" %sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12779  textall = trim(textall)||'0A'x||" %sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12780  output EMWS4.Clus4_TREE_PLOT;
12781  end;
12782  end;
12783  else do;
12784  if statname='RASE' then _RASE_=statvalue;
12785  label _RASE_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_trase_vlabel, noquote))";
12786  if STATNAME = 'PREDICTION' then do;
12787  nodetext= "%sysfunc(sasmsg(sashelp.dmine, rpt_average_vlabel, noquote))"|| put(STATVALUE, 13.4)||'0A'x|| "%sysfunc(sasmsg(sashelp.dmine, rpt_rptcount_vlabel, noquote )):"|| put(N, 13.);
12788  textall = nodetext;
12789  P__SEGMENT_3 = STATVALUE;
12790  ;
12791  ;
12792  end;
12793  if last.node then do;
12794  output EMWS4.Clus4_TREE_PLOT;
12795  end;
12796  ;
12797  end;
12798  label P__SEGMENT_3 = "%sysfunc(sasmsg(sashelp.dmine, rpt_predictedvar_vlabel, noquote))";
12799  keep NODE PARENT DEPTH BELOWTEXT ABOVETEXT LINKWIDTH NODETEXT TEXTALL N NODECOLOR _RASE_ P__SEGMENT_3;
12800  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_TREE_PLOT.
NOTE: There were 282 observations read from the data set WORK.TEMPOUTSTATS.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12801  data tempcolor;
12802  set WORK.OUTSTATS_TREE_183W0CK;
12803  retain eventlevel;
12804  if STATNAME='PREDICTION' then eventlevel=CATEGORY;
12805  run;
 
NOTE: There were 282 observations read from the data set WORK.OUTSTATS_TREE_183W0CK.
NOTE: The data set WORK.TEMPCOLOR has 282 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12806  data tempcolor;
12807  set tempcolor;
12808  if 'NOMINAL' ne 'INTERVAL' then do;
12809  if CATEGORY=EVENTLEVEL AND STATNAME="PROBABILITY";
12810  end;
12811  else do;
12812  if STATNAME="PREDICTION";
12813  end;
12814  run;
 
NOTE: There were 282 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 47 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12815  data tempcolor;
12816  set tempcolor;
12817  length nodecolor 8;
12818  if 'NOMINAL' ne 'INTERVAL' then do;
12819  nodecolor = round(100*(STATVALUE), .01);
12820  end;
12821  else do;
12822  nodecolor=round(statvalue, .01);
12823  end;
12824  keep node nodecolor;
12825  run;
 
NOTE: There were 47 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 47 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12826  proc sort data=EMWS4.Clus4_TREE_PLOT;
12827  by node;
12828  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_TREE_PLOT.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12829  proc sort data=tempcolor;
12830  by node;
12831  run;
 
NOTE: There were 47 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set WORK.TEMPCOLOR has 47 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
12832  data EMWS4.Clus4_TREE_PLOT;
12833  merge EMWS4.Clus4_TREE_PLOT tempcolor;
12834  by node;
12835  length traintotal 8;
12836  retain traintotal;
12837  label traintotal = "%sysfunc(sasmsg(sashelp.dmine,  rpt_traintotal_vlabel, noquote))";
12838  if node=1 then do;
12839  traintotal = N;
12840  end;
12841  if NODE eq . then delete;
12842  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_TREE_PLOT.
NOTE: There were 47 observations read from the data set WORK.TEMPCOLOR.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12843  data EMWS4.Clus4_TREE_PLOT;
12844  set EMWS4.Clus4_TREE_PLOT;
12845  textall = "%sysfunc(sasmsg(sashelp.dmine, rpt_nodeId_vlabel, noquote, )):"|| put(Node, 13.)||'0A'x||trim(textall);
12846  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_TREE_PLOT.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 13 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12847  data tempout;
12848  set WORK.Clus4_outnodes;
12849  run;
 
NOTE: There were 47 observations read from the data set WORK.CLUS4_OUTNODES.
NOTE: The data set WORK.TEMPOUT has 47 observations and 27 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12850  proc sort data=tempout;
12851  by descending P__SEGMENT_3;
12852  run;
 
NOTE: There were 47 observations read from the data set WORK.TEMPOUT.
NOTE: The data set WORK.TEMPOUT has 47 observations and 27 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12853  data tree_temp;
12854  set tempout;
12855  if LEAF ne .;
12856  label index="%sysfunc(sasmsg(sashelp.dmine, rpt_leafindex_vlabel  , NOQUOTE))";
12857  label percevent_train = "%sysfunc(sasmsg(sashelp.dmine, rpt_perc_train_vlabel  , NOQUOTE))";
12858  label perc_train = "%sysfunc(sasmsg(sashelp.dmine, rpt_percevent_train_vlabel  , NOQUOTE))";
12859  label tprob="%sysfunc(sasmsg(sashelp.dmine, rpt_prob_vlabel  , NOQUOTE, %nrbquote()))";
12860  tprob = round(P__SEGMENT_3, .01);
12861  percevent_train = round ( tprob*100, .01);
12862  *perc_train =round( ( N / traintotal)*100, .001);
12863  perc_train =round( ( N / traintotal), .01);
12864  if missing(perc_train) then perc_train = round( linkwidth*100, .001);
12865  index = _n_;
12866  keep NODE index tprob perc_train percevent_train
12867  ;
12868  run;
 
NOTE: There were 47 observations read from the data set WORK.TEMPOUT.
NOTE: The data set WORK.TREE_TEMP has 24 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12869  proc sort data=tree_temp;
12870  by NODE;
12871  run;
 
NOTE: There were 24 observations read from the data set WORK.TREE_TEMP.
NOTE: The data set WORK.TREE_TEMP has 24 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12872  proc sort data=EMWS4.Clus4_TREE_PLOT;
12873  by NODE;
12874  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_TREE_PLOT.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 13 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
12875  data EMWS4.Clus4_TREE_PLOT;
12876  merge EMWS4.Clus4_TREE_PLOT tree_temp;
12877  by NODE;
12878  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_TREE_PLOT.
NOTE: There were 24 observations read from the data set WORK.TREE_TEMP.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 17 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12879  proc sort data=EMWS4.Clus4_TREE_PLOT;
12880  by node index;
12881  run;
 
NOTE: There were 47 observations read from the data set EMWS4.CLUS4_TREE_PLOT.
NOTE: The data set EMWS4.CLUS4_TREE_PLOT has 47 observations and 17 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12882  title9 ' ';
12883  title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_VariableImportance_title, NOQUOTE))";
12884  proc print data=EMWS4.Clus4_OUTIMPORT(where=(IMPORTANCE>0)) noobs label;
12885  run;
 
NOTE: There were 6 observations read from the data set EMWS4.CLUS4_OUTIMPORT.
      WHERE IMPORTANCE>0;
NOTE: The PROCEDURE PRINT printed page 2.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12886  title10;
 
12887  data WORK.M2CDT54C;
12888  set WORK.M2CDT54C;
12889  if role eq 'REJECTED' then role = 'INPUT';
12890  run;
 
NOTE: There were 26 observations read from the data set WORK.M2CDT54C.
NOTE: The data set WORK.M2CDT54C has 26 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12891  proc sort data=EMWS4.Clus4_OUTIMPORT out=WORK.Clus4_GRAPHVARS(keep=NAME);
12892  where IMPORTANCE>0;
12893  by NAME;
12894  run;
 
NOTE: There were 6 observations read from the data set EMWS4.CLUS4_OUTIMPORT.
      WHERE IMPORTANCE>0;
NOTE: The data set WORK.CLUS4_GRAPHVARS has 6 observations and 1 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12895  proc sort data = WORK.M2CDT54C;
12896  by NAME;
12897  run;
 
NOTE: There were 26 observations read from the data set WORK.M2CDT54C.
NOTE: The data set WORK.M2CDT54C has 26 observations and 21 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
12898  data WORK.M2CDT54C;
12899  merge WORK.M2CDT54C WORK.Clus4_GRAPHVARS(in=_b_);
12900  by NAME;
12901  if _b_ or ROLE = "FREQ" or REPORT="Y" then output;
12902  run;
 
NOTE: There were 26 observations read from the data set WORK.M2CDT54C.
NOTE: There were 6 observations read from the data set WORK.CLUS4_GRAPHVARS.
NOTE: The data set WORK.M2CDT54C has 6 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12903  data WORK.M2CDT54C;
12904  set WORK.M2CDT54C end=_eof_ nobs=_nobs_;
12905  output;
12906  if _eof_ then do;
12907  name = '_SEGMENT_';
12908  ROLE = 'BY';
12909  LEVEL = 'NOMINAL';
12910  LABEL = 'Segment Variable';
12911  TYPE = 'N';
12912  FORMAT = '';
12913  INFORMAT = '';
12914  output;
12915  end;
12916  run;
 
NOTE: There were 6 observations read from the data set WORK.M2CDT54C.
NOTE: The data set WORK.M2CDT54C has 7 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12917  *------------------------------------------------------------* ;
12918  * Clus4: STDIZE Variables Macro ;
12919  *------------------------------------------------------------* ;
12920  %macro stdizevar;
12921      AffluenceGrade DayCareProducts NightRepairProducts TimeSinceLastPurchase
12922  %mend stdizevar;
12923  *------------------------------------------------------------*;
12924  * Clus4: Computing Summary Statistics;
12925  *------------------------------------------------------------*;
12926  proc stdize
12927  data = EMWS4.Clus4_TRAIN
12928  out=_null_
12929  outstat=WORK.Clus4_STAT
12930  add=0 fuzz=1E-14 initial=MAD
12931  vardef=df
12932  method=STD
12933  mult=1
12934  pctlmtd=ORD_STAT pctldef=2
12935  pctlpts=(
12936  0
12937  100
12938  )
12939  ;
12940  var %stdizevar;
12941  run;
 
NOTE: INITIAL= will be ignored.
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: View EMWS4.CLUS4_TRAIN.VIEW used (Total process time):
      real time           0.48 seconds
      cpu time            0.48 seconds
 
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: There were 20035 observations read from the data set EMWS4.CLUS4_TRAIN.
NOTE: The data set WORK.CLUS4_STAT has 10 observations and 5 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.51 seconds
      cpu time            0.50 seconds
 
 
12942  quit;
 
12943  data WORK.Clus4_MINMAX;
12944  set WORK.Clus4_STAT;
12945  where _TYPE_ in('P0','P100');
12946  if _TYPE_='P0' then _TYPE_='MIN';
12947  else if _TYPE_='P100' then _TYPE_='MAX';
12948  run;
 
NOTE: There were 2 observations read from the data set WORK.CLUS4_STAT.
      WHERE _TYPE_ in ('P0', 'P100');
NOTE: The data set WORK.CLUS4_MINMAX has 2 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12949  proc transpose data=WORK.Clus4_MINMAX out=WORK.Clus4_MINMAX(drop=_LABEL_ rename=(_NAME_=_VARIABLE_));
12950  id _TYPE_;
12951  run;
 
WARNING: The variable _LABEL_ in the DROP, KEEP, or RENAME list has never been referenced.
NOTE: There were 2 observations read from the data set WORK.CLUS4_MINMAX.
NOTE: The data set WORK.CLUS4_MINMAX has 4 observations and 3 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12952  data WORK.Clus4_UGRID;
12953  set WORK.Clus4_MINMAX;
12954  B1 = MIN + (1-1)*(MAX-MIN)/8;
12955  B2 = MIN + (2-1)*(MAX-MIN)/8;
12956  B3 = MIN + (3-1)*(MAX-MIN)/8;
12957  B4 = MIN + (4-1)*(MAX-MIN)/8;
12958  B5 = MIN + (5-1)*(MAX-MIN)/8;
12959  B6 = MIN + (6-1)*(MAX-MIN)/8;
12960  B7 = MIN + (7-1)*(MAX-MIN)/8;
12961  B8 = MIN + (8-1)*(MAX-MIN)/8;
12962  B9 = MIN + (9-1)*(MAX-MIN)/8;
12963  drop MIN MAX;
12964  run;
 
NOTE: There were 4 observations read from the data set WORK.CLUS4_MINMAX.
NOTE: The data set WORK.CLUS4_UGRID has 4 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
12965  *------------------------------------------------------------*;
12966  * Clus4: Creating formats for binning interval variables;
12967  *------------------------------------------------------------*;
12968  proc format;
12969  value F1_
12970  1-4.625 = "1:4.625"
12971  4.625-8.25 = "4.625:8.25"
12972  8.25-11.875 = "8.25:11.875"
12973  11.875-15.5 = "11.875:15.5"
12974  15.5-19.125 = "15.5:19.125"
12975  19.125-22.75 = "19.125:22.75"
12976  22.75-26.375 = "22.75:26.375"
12977  26.375-30 = "26.375:30"
12978  ;
NOTE: Format F1_ has been output.
12979  value F2_
12980  0-0.375 = "0:0.375"
12981  0.375-0.75 = "0.375:0.75"
12982  0.75-1.125 = "0.75:1.125"
12983  1.125-1.5 = "1.125:1.5"
12984  1.5-1.875 = "1.5:1.875"
12985  1.875-2.25 = "1.875:2.25"
12986  2.25-2.625 = "2.25:2.625"
12987  2.625-3 = "2.625:3"
12988  ;
NOTE: Format F2_ has been output.
12989  value F3_
12990  0-0.25 = "0:0.25"
12991  0.25-0.5 = "0.25:0.5"
12992  0.5-0.75 = "0.5:0.75"
12993  0.75-1 = "0.75:1"
12994  1-1.25 = "1:1.25"
12995  1.25-1.5 = "1.25:1.5"
12996  1.5-1.75 = "1.5:1.75"
12997  1.75-2 = "1.75:2"
12998  ;
NOTE: Format F3_ has been output.
12999  value F4_
13000  1-5.125 = "1:5.125"
13001  5.125-9.25 = "5.125:9.25"
13002  9.25-13.375 = "9.25:13.375"
13003  13.375-17.5 = "13.375:17.5"
13004  17.5-21.625 = "17.5:21.625"
13005  21.625-25.75 = "21.625:25.75"
13006  25.75-29.875 = "25.75:29.875"
13007  29.875-34 = "29.875:34"
13008  ;
NOTE: Format F4_ has been output.
13009  run;
 
NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13010  ods listing close;
13011  ods output crosstabfreqs=WORK.TEMPFREQ;
13012  proc freq data = EMWS4.Clus4_TRAIN order=formatted addnames;
13013  table AffluenceGrade * _SEGMENT_ / missing;
13014  table DayCareProducts * _SEGMENT_ / missing;
13015  table LoyaltyClass * _SEGMENT_ / missing;
13016  table NightRepairProducts * _SEGMENT_ / missing;
13017  table REP_Gender * _SEGMENT_ / missing;
13018  table TimeSinceLastPurchase * _SEGMENT_ / missing;
13019  format AFFLUENCEGRADE F1_.;
13020  format DAYCAREPRODUCTS F2_.;
13021  format NIGHTREPAIRPRODUCTS F3_.;
13022  format TIMESINCELASTPURCHASE F4_.;
13023  run;
 
NOTE: There were 23000 observations read from the data set SUPERMKT.SUPERMARKETCAMPAIGN.
NOTE: There were 23000 observations read from the data set EMWS4.IDS_DATA.
NOTE: There were 23000 observations read from the data set EMWS4.REPL_TRAIN.
NOTE: View EMWS4.CLUS4_TRAIN.VIEW used (Total process time):
      real time           0.46 seconds
      cpu time            0.45 seconds
 
NOTE: There were 20035 observations read from the data set EMWS4.FILTER_TRAIN.
NOTE: The data set WORK.TEMPFREQ has 180 observations and 17 variables.
NOTE: There were 20035 observations read from the data set EMWS4.CLUS4_TRAIN.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.50 seconds
      cpu time            0.48 seconds
 
 
13024  quit;
13025  ods listing;
13026  data EMWS4.Clus4_PROFILE(keep=_VARIABLE_ _SEGMENT_ TYPE COUNT PERCENT _X_ _XLABEL_);
13027  label _VARIABLE_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel, NOQUOTE))" _SEGMENT_ = "Segment Variable" Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_type_vlabel,         NOQUOTE))" _X_ =
13028     "%sysfunc(sasmsg(sashelp.dmine, rpt_numValue_vlabel, NOQUOTE))" _XLABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_fmtValue_vlabel ,    NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel,        NOQUOTE))" PERCENT =
13029     "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel,      NOQUOTE))";
13030  dsid = open("WORK.TEMPFREQ");
13031  varnum = varnum(dsid, 'ROWVARIABLE');
13032  freqnum = varnum(dsid, 'FREQUENCY');
13033  pvarnum = varnum(dsid, 'PERCENT');
13034  typenum = varnum(dsid, '_TYPE_');
13035  bynum = varnum(dsid, "_SEGMENT_");
13036  length varformat _VARIABLE_ $32 _XLABEL_ $32 TYPE $1;
13037  do while(^fetch(dsid));
13038  count = getvarn(dsid, freqnum);
13039  percent = getvarn(dsid, pvarnum);
13040  _VARIABLE_ = strip(getvarc(dsid, varnum));
13041  varblnum = varnum(dsid, _VARIABLE_);
13042  _SEGMENT_ = getvarn(dsid, bynum);
13043  type = vartype(dsid, varblnum);
13044  varformat = varfmt(dsid, varblnum);
13045  if varformat eq '' then varformat = 'best12.';
13046  _X_=.;
13047  if type = 'N' then do;
13048  _X_ = getvarn(dsid, varblnum);
13049  _XLABEL_ = left(putn(_X_, varformat));
13050  end;
13051  else _XLABEL_ = getvarc(dsid, varblnum);
13052  if getvarc(dsid, typenum) = '11' then output;
13053  end;
13054  dsid = close(dsid);
13055  run;
 
NOTE: The data set EMWS4.CLUS4_PROFILE has 120 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
 
 
13056  proc sort data=EMWS4.Clus4_PROFILE NOTHREADS;
13057  by _VARIABLE_ _SEGMENT_;
13058  run;
 
NOTE: There were 120 observations read from the data set EMWS4.CLUS4_PROFILE.
NOTE: The data set EMWS4.CLUS4_PROFILE has 120 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13059  proc means data=EMWS4.Clus4_PROFILE noprint missing NWAY;
13060  class _VARIABLE_ _SEGMENT_;
13061  var COUNT;
13062  output out=WORK.Clus4_STATCOUNT(keep=_SEGMENT_ _VARIABLE_ SUM) SUM=SUM;
13063  run;
 
NOTE: There were 120 observations read from the data set EMWS4.CLUS4_PROFILE.
NOTE: The data set WORK.CLUS4_STATCOUNT has 24 observations and 3 variables.
NOTE: PROCEDURE MEANS used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13064  proc sort data=WORK.Clus4_STATCOUNT NOTHREADS;
13065  by _VARIABLE_ _SEGMENT_;
13066  run;
 
NOTE: There were 24 observations read from the data set WORK.CLUS4_STATCOUNT.
NOTE: The data set WORK.CLUS4_STATCOUNT has 24 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13067  data EMWS4.Clus4_PROFILE(drop=SUM);
13068  label BYPERCENT= "%sysfunc(sasmsg(sashelp.dmine, rpt_percent_vlabel, NOQUOTE, _SEGMENT_))";
13069  merge EMWS4.Clus4_PROFILE WORK.Clus4_STATCOUNT;
13070  by _VARIABLE_ _SEGMENT_;
13071  if SUM ne . then BYPERCENT = 100*COUNT/SUM;
13072  run;
 
NOTE: There were 120 observations read from the data set EMWS4.CLUS4_PROFILE.
NOTE: There were 24 observations read from the data set WORK.CLUS4_STATCOUNT.
NOTE: The data set EMWS4.CLUS4_PROFILE has 120 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.01 seconds
 
 
13073  proc sort data=EMWS4.Clus4_PROFILE NOTHREADS;
13074  by _VARIABLE_;
13075  run;
 
NOTE: There were 120 observations read from the data set EMWS4.CLUS4_PROFILE.
NOTE: The data set EMWS4.CLUS4_PROFILE has 120 observations and 8 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
13076  proc sort data=WORK.M2CDT54C;
13077  by Name;
13078  run;
 
NOTE: There were 7 observations read from the data set WORK.M2CDT54C.
NOTE: The data set WORK.M2CDT54C has 7 observations and 21 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13079  data EMWS4.Clus4_PROFILE;
13080  merge EMWS4.Clus4_PROFILE(in=_a) WORK.M2CDT54C(keep=Name Label Role rename=(Name=_Variable_ Label=_Label_));
13081  by _Variable_;
13082  label Role = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel ,  NOQUOTE))";
13083  label Label = "%sysfunc(sasmsg(sashelp.dmine, meta_label_vlabel , NOQUOTE))";
13084  if _a then output;
13085  run;
 
NOTE: Variable Label is uninitialized.
WARNING: Multiple lengths were specified for the BY variable _VARIABLE_ by input data sets. This might cause unexpected results.
NOTE: There were 120 observations read from the data set EMWS4.CLUS4_PROFILE.
NOTE: There were 7 observations read from the data set WORK.M2CDT54C.
NOTE: The data set EMWS4.CLUS4_PROFILE has 120 observations and 10 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13086  proc sort data=EMWS4.Clus4_PROFILE;
13087  by _SEGMENT_ _VARIABLE_ _X_;
13088  run;
 
NOTE: There were 120 observations read from the data set EMWS4.CLUS4_PROFILE.
NOTE: The data set EMWS4.CLUS4_PROFILE has 120 observations and 10 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13089  data EMWS4.Clus4_PROFILE(rename=(_VARIABLE_=Variable _X_=NumericValue _XLABEL_=FmtValue));
13090  set EMWS4.Clus4_PROFILE;
13091  retain orderedValue 0;
13092  label OrderedValue = "%sysfunc(sasmsg(sashelp.dmine, rpt_OrderedValue_vlabel, NOQUOTE))";
13093  by _SEGMENT_ _VARIABLE_;
13094  if first._variable_ then orderedValue=1;
13095  else orderedValue+1;
13096  run;
 
NOTE: There were 120 observations read from the data set EMWS4.CLUS4_PROFILE.
NOTE: The data set EMWS4.CLUS4_PROFILE has 120 observations and 11 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13097  proc transpose data=EMWS4.Clus4_OUTVAR out=WORK.Clus4_OUTVAR(where=(COL1 ^in('IMPUTED','OMITTED')));
13098  var AffluenceGrade--REP_GenderU;
13099  where _TYPE_ in('TYPE' 'VARIABLE');
13100  run;
 
NOTE: There were 2 observations read from the data set EMWS4.CLUS4_OUTVAR.
      WHERE _TYPE_ in ('TYPE', 'VARIABLE');
NOTE: The data set WORK.CLUS4_OUTVAR has 11 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
13101  *------------------------------------------------------------* ;
13102  * Clus4: DMVQ Variables;
13103  *------------------------------------------------------------* ;
13104  %macro dmvqvars;
13105      AffluenceGrade DayCareProducts NightRepairProducts TimeSinceLastPurchase
13106     LoyaltyClassDiamond LoyaltyClassGold LoyaltyClassPlatinum LoyaltyClassSilver
13107     REP_GenderF REP_GenderM REP_GenderU
13108  %mend ;
13109
13110
 
13111  data WORK.Clus4_temp;
13112  set EMWS4.Clus4_OUTMEAN;
13113  _idvar_=left(put(_SEGMENT_,4.));
13114  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS4_OUTMEAN.
NOTE: The data set WORK.CLUS4_TEMP has 4 observations and 21 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13115  proc distance data=WORK.Clus4_temp out=EMWS4.Clus4_DISTANCE method=l(2) shape=square;
13116  id _idvar_;
13117  var interval(%dmvqvars);
13118  run;
 
NOTE: The data set EMWS4.CLUS4_DISTANCE has 4 observations and 5 variables.
NOTE: PROCEDURE DISTANCE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13119  proc mds data=EMWS4.Clus4_DISTANCE out=WORK.Clus4_mds level=absolute nohist shape=square dim=3;
13120  object _idvar_;
13121  run;
 
NOTE: Convergence assumed because the badness-of-fit criterion 2.833322E-15 is less than or equal to MINCRIT=1E-6.
NOTE: The data set WORK.CLUS4_MDS has 5 observations and 8 variables.
NOTE: PROCEDURE MDS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13122  quit;
13123  data WORK.Clus4_mds;
13124  set WORK.Clus4_mds;
13125  if _type_ ne 'CONFIG' then delete;
13126  run;
 
NOTE: There were 5 observations read from the data set WORK.CLUS4_MDS.
NOTE: The data set WORK.CLUS4_MDS has 4 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13127  data WORK.Clus4_mds(label="&label" keep=_idvar_ _radius_ dim1 dim2 dim3);
WARNING: Apparent symbolic reference LABEL not resolved.
13128  merge WORK.Clus4_temp WORK.Clus4_mds;
13129  run;
 
NOTE: There were 4 observations read from the data set WORK.CLUS4_TEMP.
NOTE: There were 4 observations read from the data set WORK.CLUS4_MDS.
NOTE: The data set WORK.CLUS4_MDS has 4 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13130  options nodate;
13131  title1 "%sysfunc(sasmsg(sashelp.dmine, rpt_ClusterDistance_title, NOQUOTE))";
13132  %plotit(data=WORK.Clus4_mds, datatype=mds, radii=_radius_, labelvar=_idvar_, symtype=circle, symbols='*', gout=WORK.Clus4, gname=DISTANCE, gopts2=nodisplay, gopts=device=GIF, gopplot=cback=white, titlecol=black, labelcol=black, tickcol=black,
13133     framecol=black, post=C:\Users\Mohamed\AppData\Local\Temp\SAS Temporary Files\_TD5504_DESKTOP-MVTLU7L_\plotit.ps);
 
                                                                                                                    Types Legend  | CONFIG
                                                                                                                    --------------+---------
                                                                                                                    Symbol Types  | circle
                                                                                                                    Symbols       | *
                                                                                                                    Symbol Colors | cx000000
                                                                                                                    Label  Colors | cx000000
                                                                                                                    Symbol Sizes  | 1
                                                                                                                    Label  Sizes  | 1
                                                                                                                    Symbol Fonts  | none
                                                                                                                    Label  Fonts  | none
                                                                                                                    ------------------------
 
                                                                                                         Iterative Scatter Plot of Labeled Points Macro
 
                                                                                                    Iteration    Place    Line Size    Page Size    Penalty
                                                                                                    -------------------------------------------------------
                                                                                                        1          2         65           45            0
 
The following code will create the printer plot on which the graphical plot is based:
 
options nonumber ls=65 ps=45;
proc plot nolegend formchar='|----|+|---' data=preproc vtoh=2;
   plot Dim2 * Dim1 $ _idvar_ = _symbol_ /
        haxis=by 5 vaxis=by 5 box list=1
        placement=((h=2 -2 : s=right left) (v=1 -1 * h=0 -1 to -5 by alt));
   label Dim2 = 'Dimension 2' Dim1 = 'Dimension 1';
   label Dim2 = '#' Dim1 = '#';
   run; quit;
 
The plot was created with the following goptions:
 
goptions nodisplay hpos=74 vpos=28 hsize=8.33in vsize=6.24in cback=white device=GIF;
 
The OUT=anno Annotate data set has 214 observations.
The PLOTIT macro used 1.5 seconds to create OUT=anno.
13134  goptions display;
13135  title;
 
13136  filename gsasfile "D:\Nida\Data
13136! mining\datamining\BOGO\Workspaces\EMWS4\Clus4\GRAPH\Distance.gif";
13137  goptions reset=all device=PNG display gaccess= gsasfile gsfmode= replace cback= white;
13138  proc greplay igout=WORK.Clus4 nofs;
NOTE: Building list of graphs from the catalog.
 
NOTE: Enter greplay commands or statements.
13139  replay DISTANCE;
NOTE: This SAS session is using a registry in WORK.  All changes will be lost at the end of this
      session.
NOTE: 29275 bytes written to D:\Nida\Data
      mining\datamining\BOGO\Workspaces\EMWS4\Clus4\GRAPH\Distance.gif.
13140  quit;
 
NOTE: PROCEDURE GREPLAY used (Total process time):
      real time           0.32 seconds
      cpu time            0.32 seconds
 
 
13141  goptions reset=all;
13142  filename gsasfile;
NOTE: Fileref GSASFILE has been deassigned.
 
13143  proc datasets lib=EMWS4 nolist;
13144  modify Clus4_DISTANCE;
13145  rename _idvar_=_SEGMENT_;
NOTE: Renaming variable _idvar_ to _SEGMENT_.
13146  run;
 
NOTE: MODIFY was successful for EMWS4.CLUS4_DISTANCE.DATA.
13147  quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
13148  *------------------------------------------------------------*;
13149  * Clus4: Creating data set for Input Mean report;
13150  *------------------------------------------------------------*;
13151  data temp(drop=_type_ over_all);
13152  set EMWS4.Clus4_OUTSTAT;
13153  where _type_ in('DMDB_MEAN', 'CLUS_MEAN');
13154  run;
 
NOTE: There were 5 observations read from the data set EMWS4.CLUS4_OUTSTAT.
      WHERE _type_ in ('CLUS_MEAN', 'DMDB_MEAN');
NOTE: The data set WORK.TEMP has 5 observations and 12 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13155  proc sort data=temp;
13156  by _SEGMENT_;
13157  run;
 
NOTE: There were 5 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 5 observations and 12 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13158  proc stdize data=temp out=stdtemp pctlpts=0 100 outstat=stat;
13159  var AffluenceGrade--REP_GenderU;
13160  run;
 
NOTE: There were 5 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.STDTEMP has 5 observations and 12 variables.
NOTE: The data set WORK.STAT has 10 observations and 12 variables.
NOTE: PROCEDURE STDIZE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13161  proc transpose data=stat out=tstat(rename=(COL1=MEAN COL2=STD COL3=MIN COL4=MAX));
13162  where _type_ in ('LOCATION', 'SCALE','P0', 'P100');
13163  run;
 
NOTE: There were 4 observations read from the data set WORK.STAT.
      WHERE _type_ in ('LOCATION', 'P0', 'P100', 'SCALE');
NOTE: The data set WORK.TSTAT has 11 observations and 6 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13164  data tstat( rename=(_NAME_=NAME) keep=_NAME_ cv stdmin stdmax);
13165  set tstat;
13166  if std ^in (0, .) then do;
13167  stdmin = abs((min-mean)/std);
13168  stdmax = abs((max-mean)/std);
13169  end;
13170  if mean ^in(0, .) then cv = std/mean;
13171  run;
 
NOTE: There were 11 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTAT has 11 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13172  proc sort data=tstat;
13173  by NAME;
13174  run;
 
NOTE: There were 11 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTAT has 11 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13175  proc transpose data=stdtemp out=tstdtemp(rename=(_NAME_=NAME _LABEL_=LABEL COL1=MEAN));
13176  by _SEGMENT_;
13177  run;
 
NOTE: There were 5 observations read from the data set WORK.STDTEMP.
NOTE: The data set WORK.TSTDTEMP has 55 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13178  proc sort data=tstdtemp;
13179  by NAME;
13180  run;
 
NOTE: There were 55 observations read from the data set WORK.TSTDTEMP.
NOTE: The data set WORK.TSTDTEMP has 55 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13181  data tstdtemp;
13182  merge tstdtemp tstat;
13183  by NAME;
13184  STDMEAN = (MEAN + stdmin)/(stdmin + stdmax);
13185  drop stdmin stdmax mean;
13186  run;
 
NOTE: There were 55 observations read from the data set WORK.TSTDTEMP.
NOTE: There were 11 observations read from the data set WORK.TSTAT.
NOTE: The data set WORK.TSTDTEMP has 55 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13187  proc transpose data=EMWS4.Clus4_OUTVAR out=tempVar(drop=_LABEL_ rename=( _NAME_=NAME
13187! VARIABLE=INPUT));
13188  var AffluenceGrade--REP_GenderU;
13189  id _type_;
13190  where _type_ = 'VARIABLE';
13191  run;
 
NOTE: There were 1 observations read from the data set EMWS4.CLUS4_OUTVAR.
      WHERE _type_='VARIABLE';
NOTE: The data set WORK.TEMPVAR has 11 observations and 2 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
13192  proc sort data=tempVar;
13193  by NAME;
13194  run;
 
NOTE: There were 11 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 11 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13195  data EMWS4.Clus4_INPUTMEAN(rename=(NAME=VARIABLE));
13196  Length _SEGMENT_CHAR_ $7;
13197  label _SEGMENT_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentName_vlabel,  NOQUOTE))"
13197! _SEGMENT_CHAR_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_segmentId_vlabel,    NOQUOTE))" NAME =
13197! "%sysfunc(sasmsg(sashelp.dmine, rpt_variable_vlabel,     NOQUOTE))" INPUT =
13198     "%sysfunc(sasmsg(sashelp.dmine, rpt_input_vlabel,        NOQUOTE))" LABEL =
13198! "%sysfunc(sasmsg(sashelp.dmine, rpt_label_vlabel,        NOQUOTE))" CV =
13198! "%sysfunc(sasmsg(sashelp.dmine, rpt_cv_vlabel,           NOQUOTE))" STDMEAN =
13199     "%sysfunc(sasmsg(sashelp.dmine, rpt_normmean_vlabel,     NOQUOTE))";
13200  merge tempvar tstdtemp;
13201  by NAME;
13202  if LABEL='' then LABEL=NAME;
13203  _SEGMENT_CHAR_ = strip(put(_SEGMENT_, best.));
13204  if _SEGMENT_ = . then _SEGMENT_CHAR_='Overall';
13205  run;
 
NOTE: There were 11 observations read from the data set WORK.TEMPVAR.
NOTE: There were 55 observations read from the data set WORK.TSTDTEMP.
NOTE: The data set EMWS4.CLUS4_INPUTMEAN has 55 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
13206  proc sort data=EMWS4.Clus4_INPUTMEAN;
13207  by descending cv;
13208  run;
 
NOTE: There were 55 observations read from the data set EMWS4.CLUS4_INPUTMEAN.
NOTE: The data set EMWS4.CLUS4_INPUTMEAN has 55 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13209  *------------------------------------------------------------*;
13210  * Clus4: Determining the important variables;
13211  *------------------------------------------------------------*;
 
13212  %let _nobs = 0;
13213  data keepvars(rename=(NAME=INPUT));
13214  set EMWS4.Clus4_OUTIMPORT(where=(IMPORTANCE>0.5)) end=eof;
13215  if eof then call symput('_nobs', strip(put(_N_, best.)));
13216  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS4_OUTIMPORT.
      WHERE IMPORTANCE>0.5;
NOTE: The data set WORK.KEEPVARS has 4 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13217  proc transpose data=EMWS4.Clus4_OUTVAR out=tempVar(drop=_LABEL_ rename=( _NAME_=NAME
13217! VARIABLE=INPUT));
13218  var AffluenceGrade--REP_GenderU;
13219  id _type_;
13220  where _type_ = 'VARIABLE';
13221  run;
 
NOTE: There were 1 observations read from the data set EMWS4.CLUS4_OUTVAR.
      WHERE _type_='VARIABLE';
NOTE: The data set WORK.TEMPVAR has 11 observations and 2 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
13222  proc sort data=keepvars;
13223  by INPUT;
13224  run;
 
NOTE: There were 4 observations read from the data set WORK.KEEPVARS.
NOTE: The data set WORK.KEEPVARS has 4 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13225  proc sort data=tempvar;
13226  by INPUT;
13227  run;
 
NOTE: There were 11 observations read from the data set WORK.TEMPVAR.
NOTE: The data set WORK.TEMPVAR has 11 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13228  data vars;
13229  merge tempvar keepvars(in=b);
13230  by INPUT;
13231  if b then output;
13232  run;
 
WARNING: Multiple lengths were specified for the BY variable INPUT by input data sets. This might
         cause unexpected results.
NOTE: There were 11 observations read from the data set WORK.TEMPVAR.
NOTE: There were 4 observations read from the data set WORK.KEEPVARS.
NOTE: The data set WORK.VARS has 4 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13233  proc sort data=vars;
13234  by descending importance;
13235  run;
 
NOTE: There were 4 observations read from the data set WORK.VARS.
NOTE: The data set WORK.VARS has 4 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13236  data _null_;
13237  set vars;
13238  if _N_=1 then call symput('CLUS_PROFVARS', strip(NAME));
13239  else call symput('CLUS_PROFVARS',symget('CLUS_PROFVARS')!!' '!!strip(NAME));
13240  run;
 
NOTE: There were 4 observations read from the data set WORK.VARS.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
13241  *------------------------------------------------------------*;
13242  * mergeVarMeansandClusLabel;
13243  *------------------------------------------------------------*;
13244  data temp(keep=_SEGMENT_ &CLUS_PROFVARS);
13245  length _SEGMENT_ &CLUS_PROFVARS 8;
13246  set EMWS4.Clus4_OUTSTAT;
13247  where _type_ ='CLUS_MEAN';
13248  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS4_OUTSTAT.
      WHERE _type_='CLUS_MEAN';
NOTE: The data set WORK.TEMP has 4 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
 
 
13249  proc sort data=temp;
13250  by _SEGMENT_;
13251  run;
 
NOTE: There were 4 observations read from the data set WORK.TEMP.
NOTE: The data set WORK.TEMP has 4 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
13252  data EMWS4.Clus4_LABEL;
13253  merge EMWS4.Clus4_LABEL(keep=_SEGMENT_ LABEL) temp;
13254  by _SEGMENT_;
13255  run;
 
NOTE: There were 4 observations read from the data set EMWS4.CLUS4_LABEL.
NOTE: There were 4 observations read from the data set WORK.TEMP.
NOTE: The data set EMWS4.CLUS4_LABEL has 4 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
